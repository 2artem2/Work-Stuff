---
layout: default
title:  Threats
parent: Plan & Develop
---

# Угрозы
{: .no_toc }


## Оглавление
{: .no_toc .text-delta }

1. TOC
{:toc}

---




## Моделирование угроз




Моделирование угроз - это процесс, который помогает определить и расставить приоритеты потенциальных угроз безопасности системы или приложения. Цель моделирования угроз - выявить риски безопасности на ранних этапах разработки и проактивно устранить их, а не ждать, пока уязвимости будут обнаружены после развертывания.

![stride](../../../assets/images/stride.png)


Один из популярных методов моделирования угроз называется STRIDE, что расшифровывается как Spoofing, Tampering, Repudiation, Information disclosure, Denial of service и Elevation of privilege. Это шесть типов угроз безопасности, которые могут воздействовать на систему, и, рассматривая каждую из них по очереди, модель угроз может помочь выявить потенциальные уязвимости и атаки.

Методология STRIDE часто используется в сочетании с инструментом для создания диаграмм, таким как Microsoft's Threat Modeling Tool или OWASP Threat Dragon с открытым исходным кодом. Эти инструменты позволяют создать визуальное представление анализируемой системы или приложения, а также наметить потенциальные угрозы и векторы атак.



<span class="d-inline-block p-2 mr-1 v-align-middle bg-green-000"></span>Объясняет шесть типов угроз безопасности в методологии STRIDE:


| STRIDE Угроза    | Описание   | 
|:---------------|:---------------------|
| `Подмена` | Выдача себя за пользователя, устройство или систему с целью получения несанкционированного доступа или выполнения вредоносных действий. В качестве примера можно привести фишинговые атаки или использование поддельного сертификата SSL для перехвата данных.	 | 
| `Вскрытие` | Модификация данных или кода в пути или в состоянии покоя с целью внесения ошибок, получения несанкционированного доступа или выполнения других вредоносных действий. В качестве примера можно привести модификацию исходного кода приложения или изменение данных в базе данных.	 | 
| `Отказ` | Отрицание или отказ от действий или событий с целью уйти от ответственности или подотчетности. Например, отрицание факта совершения действия или доступа к данным.	 | 
| `Раскрытие информации` | Раскрытие конфиденциальной или чувствительной информации неавторизованным лицам, намеренно или случайно. В качестве примера можно привести раскрытие паролей или пользовательских данных, а также обнародование закрытых ключей.	 | 
| `Отказ в обслуживании` | Нарушение или снижение доступности или функциональности системы или приложения с помощью сетевых атак, исчерпания ресурсов или других средств. В качестве примера можно привести распределенные атаки типа "отказ в обслуживании" (DDoS) или наводнение сервера запросами.	 | 
| `Повышение привилегий` | Получение дополнительного доступа или привилегий, выходящих за рамки изначально предоставленных, для выполнения несанкционированных действий или эскалации атаки. В качестве примера можно привести использование уязвимости в программном обеспечении для получения административного доступа или применение методов социальной инженерии для получения конфиденциальной информации.	 | 


### Реализация

Шаг 1: Define the Scope

Определите приложение или систему в рамках конвейера DevSecOps, для которой вы хотите провести моделирование угроз. Например, рассмотрим приложение на базе микросервисов, развернутое с помощью контейнеризации и управляемое Kubernetes.

Шаг 2: Сбор информации

Соберите информацию об архитектуре, дизайне и развертывании приложения. Это включает в себя понимание компонентов, их взаимодействия, потоков данных и внешних зависимостей.

Шаг 3: Определите угрозы и активы

Определите критические активы и конфиденциальные данные, задействованные в приложении. Рассмотрите внутренние и внешние угрозы, которые могут поставить под угрозу безопасность этих активов. Например:
несанкционированный доступ к данным клиентов, хранящимся в базе данных.
Инъекционные атаки на API или контейнеры
Неправильная конфигурация ресурсов Kubernetes, приводящая к несанкционированному доступу или повышению привилегий.

Шаг 4: Оценка уязвимостей и рисков

Оцените архитектуру и дизайн, чтобы выявить потенциальные уязвимости и риски, связанные с идентифицированными угрозами. Рассмотрите последствия для безопасности на каждом этапе конвейера DevSecOps, включая разработку, тестирование, развертывание и эксплуатацию. Например:
Небезопасные образы контейнеров, содержащие известные уязвимости
Отсутствие надлежащего контроля доступа к ресурсам Kubernetes
Слабые или устаревшие механизмы аутентификации

Шаг 5: Приоритезация и снижение рисков

Определите приоритеты рисков на основе их потенциального воздействия и вероятности возникновения. Разработайте стратегии и рекомендации по снижению каждого выявленного риска. Рассмотрите возможность интеграции средств контроля безопасности и лучших практик в конвейер DevSecOps. Например:
Внедрение автоматизированного сканирования уязвимостей и управления исправлениями для образов контейнеров
Применение методов безопасной конфигурации для ресурсов Kubernetes
Обеспечение строгой аутентификации и контроля доступа на всех этапах конвейера.

Шаг 6: Постоянный мониторинг и совершенствование

Включите моделирование угроз в жизненный цикл DevSecOps в качестве итеративного процесса. Регулярно пересматривайте и обновляйте модель угроз по мере развития приложения или появления новых рисков. Постоянно отслеживайте систему на предмет потенциальных угроз и уязвимостей.

Пример из реальной практики:

В контексте DevSecOps рассмотрим сценарий, в котором команда разработчиков создает облачное нативное приложение с использованием архитектуры микросервисов и развертывает его на контейнерной платформе. Процесс моделирования угроз может включать выявление таких рисков, как:

* небезопасные образы контейнеров с уязвимостями
* Слабые механизмы аутентификации и авторизации
* Неадекватное протоколирование и мониторинг для контейнерных приложений
* Неправильная конфигурация облачных ресурсов и контроля доступа
* Небезопасное взаимодействие между микросервисами
* Инъекционные атаки на конечные точки API

Исходя из выявленных рисков, стратегии их снижения могут включать:

* Внедрение автоматизированного сканирования уязвимостей и усиление образа для контейнеров
* Применение надежных механизмов аутентификации и авторизации, таких как токены OAuth или JWT
* Внедрение решений для централизованного протоколирования и мониторинга контейнерных приложений
* Создание надлежащих политик управления облачными ресурсами и контроля доступа
* Шифрование каналов связи между микросервисами
* Внедрение проверки ввода и средств контроля безопасности для предотвращения инъекционных атак




### Матрица угроз


Эта матрица служит отправной точкой для определения потенциальных угроз и соответствующих мер по их снижению на основе различных категорий.



| Категория угрозы | Описание угрозы | Потенциальное смягчение |
|:---------------|:---------------------|:---------------------|
| `Аутентификация` | Слабые или украденные учетные данные | Внедрите политику надежных паролей, многофакторную аутентификацию и алгоритмы хэширования паролей. |
| `Аутентификация` | Небезопасные протоколы аутентификации | Используйте безопасные протоколы аутентификации (например, TLS) и не передавайте учетные данные в открытом виде. |
| `Авторизация` | Недостаточный контроль доступа | Внедрите RBAC (Role-Based Access Control) и применяйте принцип наименьших привилегий. |
| `Авторизация` | Неправильная эскалация привилегий | Ограничьте возможности эскалации привилегий и регулярно проверяйте разрешения пользователей. |
| `Защита данных` | Утечка данных или несанкционированный доступ | Шифрование конфиденциальных данных в состоянии покоя и при транспортировке, а также внедрение надлежащего контроля доступа. |
| ``Защита данных`` | Небезопасное хранение данных | Применяйте безопасные методы кодирования для хранения данных, включая шифрование и безопасное управление ключами. |
| `Сетевая безопасность` | Неадекватная сегментация сети | Внедрите правильную сегментацию сети с помощью брандмауэров или сетевых политик. |
| ``Сетевая безопасность`` | Атаки типа "человек посередине" | Используйте шифрование и аутентификацию на основе сертификатов для безопасной связи. |
| ``Отказ в обслуживании (DoS)`` | Истощение ресурсов | Внедрите ограничение скорости, проверку запросов и мониторинг аномального поведения. |
| ``Отказ в обслуживании (DoS)`` | Распределенные DoS-атаки (DDoS) | Используйте методы борьбы с DDoS, такие как фильтрация трафика и балансировка нагрузки. |
| `Конфигурация системы` | Неправильно настроенные параметры безопасности | Примените рекомендации по безопасной конфигурации для всех компонентов системы. |
| `Конфигурация системы` | Небезопасные конфигурации по умолчанию | Измените настройки по умолчанию, удалите или отключите ненужные службы. |
| `Управление уязвимостями` | Задержка исправления программного обеспечения | Установите программу управления уязвимостями с регулярным исправлением и обновлением. |
| `Управление уязвимостями` | Отсутствие сканирования уязвимостей | Регулярно проводите сканирование уязвимостей и определяйте приоритеты их устранения. |
| `Инсайдерские угрозы` | Вредоносные или халатные инсайдеры | Внедрите надлежащий контроль доступа, мониторинг и программы обучения сотрудников. |
| `Инсайдерские угрозы` | Несанкционированный доступ к данным или их кража | Мониторинг и регистрация действий пользователей и внедрение механизмов предотвращения потери данных. |
| `Физическая безопасность` | Несанкционированный физический доступ | Защищенный физический доступ к центрам обработки данных, серверным комнатам и аппаратным компонентам. |
| `Физическая безопасность` | Кража или уничтожение оборудования | Внедрите средства физической безопасности, такие как замки, системы наблюдения и резервного копирования. |
| `Зависимости от сторонних производителей` | Уязвимости в компонентах сторонних производителей	 | Проводите тщательную проверку компонентов сторонних производителей, применяйте исправления и отслеживайте рекомендации по безопасности. |
| `Зависимости от сторонних производителей` | Отсутствие надзора за деятельностью третьих лиц	 | Установите эффективные методы управления поставщиками, включая аудит и оценку безопасности. |




### Инструменты




| Категория угрозы | Описание угрозы |
|:---------------|:---------------------|
| `Microsoft Threat Modeling Tool` | Бесплатный инструмент от Microsoft, который помогает создавать модели угроз для программных систем. Он обеспечивает структурированный подход к выявлению, анализу и смягчению потенциальных угроз.	 | 
| `OWASP Threat Dragon` | Инструмент моделирования угроз с открытым исходным кодом, позволяющий создавать модели угроз по методологии STRIDE. Он имеет интуитивно понятный интерфейс и поддерживает совместную работу членов команды.	 | 
| `PyTM` |Инструмент моделирования угроз с открытым исходным кодом, специально разработанный для веб-приложений. Он позволяет моделировать различные аспекты архитектуры приложения и помогает выявлять потенциальные угрозы.	 |
| `ThreatModeler` | Коммерческий инструмент, предлагающий комплексную платформу для моделирования угроз. Он обеспечивает визуальный интерфейс моделирования, автоматизированный анализ угроз и интеграцию с другими инструментами и фреймворками безопасности.	 | 
| `IriusRisK` | Коммерческий инструмент, объединяющий моделирование угроз и управление рисками. Он поддерживает несколько методологий моделирования угроз, предоставляет возможности оценки рисков и предлагает интеграцию с другими инструментами и платформами.	 | 
| `TMT (Threat Modeling Tool)` | Инструмент командной строки с открытым исходным кодом, разработанный OWASP для моделирования угроз. Он поддерживает методологию STRIDE и позволяет автоматизировать процессы моделирования угроз.	 | 
| `Secure Code Warrior` | Хотя это не традиционный инструмент моделирования угроз, он предлагает интерактивные учебные модули и задачи, которые могут помочь разработчикам понять и выявить потенциальные угрозы в процессе разработки.	 | 


## Угрозы 




### Слабые или украденные учетные данные

#### **PyTM**
Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Слабые или украденные учетные данные". Она включает в себя таких участников, как "Злоумышленник" и "Инсайдер", сервер, представляющий сервер приложений, и хранилище данных, представляющее данные пользователя.

Модель угроз определяет угрозу "Слабые или украденные учетные данные" и включает такие пути атаки, как "Угадывание пароля / грубая атака", "Кража учетных данных" и "Инсайдерская угроза". Также определяются последствия этих угроз, такие как несанкционированный доступ к пользовательским данным и утечка данных.

Код генерирует диаграмму модели угроз в формате PNG под названием "weak_or_stolen_credentials_threat_model.png".

```
from pytm import TM, Server, Datastore, Actor

# Создайте новую модель угрозы
tm = TM("Weak or Stolen Credentials Threat Model")

# Создать актеров
attacker = Actor("Attacker")
insider = Actor("Insider")

# Создайте сервер и хранилище данных
server = Server("Application Server")
datastore = Datastore("User Datastore")

# Определите угрозу слабых или украденных учетных данных
tm.add_threat()
tm.threat.name("Weak or Stolen Credentials")
tm.threat.description("Threat of weak or stolen user credentials")

# Определите пути атаки
tm.attack_path(attacker, server, "Password Guessing/Brute Force Attack")
tm.attack_path(attacker, server, "Credential Theft")
tm.attack_path(insider, server, "Insider Threat")

# Определить влияние
tm.data_flow(server, datastore, "Unauthorized Access to User Data")
tm.data_flow(server, datastore, "Data Breach and Exposure of Sensitive Information")

# Создайте диаграмму модели угроз
tm.generate_diagram("weak_or_stolen_credentials_threat_model.png")
```



#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для слабых или украденных учетных данных:

Концепции:
- Учетные данные: Имена пользователей и пароли или другие маркеры аутентификации, используемые для аутентификации пользователей.
- Слабые учетные данные: Легко угадываемые или часто используемые учетные данные, которые можно легко использовать.
- Украденные учетные данные: Учетные данные, полученные неавторизованными лицами с помощью различных средств, таких как фишинг или утечка данных.
- Механизмы аутентификации: Методы, используемые для проверки личности пользователя и предоставления доступа.
- Несанкционированный доступ: Получение доступа к системе или приложению без соответствующей авторизации.

Пользователи:
1. Злоумышленники:
   - Угроза: Эксплуатация слабых или украденных учетных данных
   - Попытки получить несанкционированный доступ к системе с помощью слабых или украденных учетных данных.

2. Системный администратор:
   - Угроза: Слабое управление учетными данными
   - Не применяет строгие политики паролей или использует слабые механизмы аутентификации.

3. Пользователь:
   - Угроза: Кража или компрометация учетных данных
   - Становится жертвой фишинговых атак или неосознанно использует слабые или легко угадываемые учетные данные.

Компоненты:
1. Система аутентификации:
   - Управляет аутентификацией пользователей и контролем доступа.
   - Поток данных: запросы и проверка подлинности пользователей.

2. Хранение учетных данных:
   - Безопасное хранение учетных данных пользователей.
   - Поток данных: хранение и извлечение учетных данных пользователя.

3. Пользовательский интерфейс:
   - Предоставляет платформу для взаимодействия с пользователем и входа в систему.
   - Поток данных: ввод пользователем учетных данных и ответы на аутентификацию.

Взаимодействия:
1. Злоумышленники:
   - Используют методы грубой силы или используют украденные учетные данные для получения несанкционированного доступа к системе.
   - Попытки получить доступ к ограниченным ресурсам или выполнить вредоносные действия.

2. Системный администратор:
   - Внедряет слабые политики паролей или механизмы аутентификации, которые могут быть легко использованы.
   - Не обеспечивает многофакторную аутентификацию или регулярное обновление паролей.

3. Пользователь:
   - Вводит учетные данные в процессе входа в систему, которые отправляются в систему аутентификации для проверки.
   - Может стать жертвой фишинговых атак, что приведет к раскрытию его учетных данных.

4. Система аутентификации:
   - Проверяет учетные данные пользователя по хранимым значениям и предоставляет доступ на основе политик аутентификации.
   - Надежно хранит и извлекает учетные данные пользователей.

5. Хранение учетных данных:
   - Безопасное хранение учетных данных пользователя с использованием соответствующих методов шифрования и хэширования.
   - Защита учетных данных от несанкционированного доступа или раскрытия.

```


### Небезопасные протоколы аутентификации

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Ненадежные протоколы аутентификации". Она включает в себя таких участников, как "Злоумышленник" и "Пользователь", сервер, представляющий сервер приложений, и хранилище данных, представляющее данные пользователя.

Модель угроз определяет угрозу "Ненадежные протоколы аутентификации" и включает такие пути атаки, как "Подслушивание" и "Атака "человек посередине"". Она также определяет последствия этих угроз, такие как несанкционированный доступ к данным пользователей и утечка данных.

Код генерирует диаграмму модели угроз в формате PNG под названием "insecure_authentication_protocols_threat_model.png".

```
from pytm import TM, Server, Datastore, Actor

# Создайте новую модель угрозы
tm = TM("Insecure Authentication Protocols Threat Model")

# Создать актеров
attacker = Actor("Attacker")
user = Actor("User")

# Создайте сервер и хранилище данных
server = Server("Application Server")
datastore = Datastore("User Datastore")

# Определение угрозы небезопасных протоколов аутентификации
tm.add_threat()
tm.threat.name("Insecure Authentication Protocols")
tm.threat.description("Threat of using insecure authentication protocols")

# Определите пути атаки
tm.attack_path(attacker, server, "Eavesdropping")
tm.attack_path(attacker, server, "Man-in-the-Middle Attack")

# Определить влияние
tm.data_flow(server, datastore, "Unauthorized Access to User Data")
tm.data_flow(server, datastore, "Data Breach and Exposure of Sensitive Information")

# Создайте диаграмму модели угроз
tm.generate_diagram("insecure_authentication_protocols_threat_model.png")
```


#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для небезопасных протоколов аутентификации:

Концепции:
- Протоколы аутентификации: Стандарты или механизмы, используемые для проверки личности пользователя в процессе аутентификации.
- Ненадежные протоколы аутентификации: Протоколы, которые подвержены уязвимостям безопасности или могут быть легко использованы.
- Атаки "человек посередине" (MitM): Атаки, при которых злоумышленник перехватывает и изменяет обмен данными между двумя сторонами.
- Несанкционированный доступ: Получение доступа к системе или приложению без соответствующей авторизации.

Пользователи:
1. Злоумышленники:
   - Угроза: Эксплуатация небезопасных протоколов аутентификации
   - Попытки перехвата или манипулирования трафиком аутентификации для получения несанкционированного доступа.

2. Системный администратор:
   - Угроза: Конфигурация небезопасных протоколов аутентификации
   - Неправильно настраивает протоколы аутентификации или не применяет безопасные альтернативы.

3. Пользователь:
   - Угроза: Раскрытие учетных данных
   - Общается с системой, используя небезопасные протоколы аутентификации, что может привести к раскрытию учетных данных.

Компоненты:
1. Система аутентификации:
   - Управляет аутентификацией пользователей и контролем доступа.
   - Поток данных: запросы и проверка подлинности пользователей.

2. Протокол аутентификации:
   - Определяет правила и процедуры аутентификации пользователей.
   - Поток данных: обмен сообщениями аутентификации между пользователем и системой аутентификации.

3. Система злоумышленника:
   - Представляет собой систему, используемую злоумышленниками для перехвата или манипулирования трафиком аутентификации.
   - Поток данных: перехват и модификация сообщений аутентификации.

Взаимодействия:
1. Злоумышленники:
   - Используют уязвимости в небезопасных протоколах аутентификации для перехвата или модификации сообщений аутентификации.
   - Попытки получить учетные данные пользователя или несанкционированный доступ к системе.

2. Системный администратор:
   - Неправильно настраивает протоколы аутентификации, например, использует слабое шифрование или устаревшие протоколы.
   - Не применяет безопасные альтернативы, такие как использование сильных криптографических алгоритмов или многофакторная аутентификация.

3. Пользователь:
   - Инициирует процесс аутентификации, отправляя системе запросы на аутентификацию.
   - Общается с системой, используя небезопасные протоколы аутентификации, которые могут быть перехвачены злоумышленниками.

4. Система аутентификации:
   - Проверяет учетные данные пользователя и предоставляет доступ на основе используемого протокола аутентификации.
   - Может быть уязвима для атак, если используются небезопасные протоколы аутентификации или они неправильно сконфигурированы.

5. Протокол аутентификации:
   - Обеспечивает обмен сообщениями аутентификации между пользователем и системой аутентификации.
   - Может быть скомпрометирован, если он небезопасен или подвержен атакам типа Man-in-the-Middle.

```


### Ненадлежащий контроль доступа	

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Недостаточный контроль доступа". Она включает в себя таких участников, как "Злоумышленник" и "Пользователь", сервер, представляющий сервер приложений, и хранилище данных, представляющее конфиденциальные данные.

Модель угроз определяет угрозу "Недостаточный контроль доступа" и включает такие пути атаки, как "Несанкционированный доступ" со стороны злоумышленника и "Повышение привилегий" со стороны пользователя. Также определяются последствия этих угроз, такие как несанкционированный доступ к конфиденциальным данным и утечка данных.

Код генерирует диаграмму модели угроз в формате PNG под названием "insufficient_access_controls_threat_model.png".


```
from pytm import TM, Actor, Server, Datastore

# Создайте новую модель угрозы
tm = TM("Insufficient Access Controls Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
user = Actor("User")

# Создайте сервер и хранилище данных
server = Server("Application Server")
datastore = Datastore("Sensitive Datastore")

# Определите угрозу недостаточного контроля доступа
tm.add_threat()
tm.threat.name("Insufficient Access Controls")
tm.threat.description("Threat of insufficient access controls on sensitive data")

# Определите пути атаки
tm.attack_path(attacker, server, "Unauthorized Access")
tm.attack_path(user, server, "Privilege Escalation")

# Определить влияние
tm.data_flow(server, datastore, "Unauthorized Access to Sensitive Data")
tm.data_flow(server, datastore, "Data Leakage")

# Создайте диаграмму модели угроз
tm.generate_diagram("insufficient_access_controls_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз при недостаточном контроле доступа:

Концепции:
- Контроль доступа: Механизмы, используемые для обеспечения авторизованного доступа к ресурсам.
- Недостаточный контроль доступа: Неадекватные или неправильно настроенные средства контроля доступа, позволяющие получить несанкционированный доступ к ресурсам.
- Несанкционированный доступ: Получение доступа к ресурсу без надлежащей авторизации.
- Повышение привилегий: Использование уязвимостей для получения более высоких уровней привилегий доступа.

Пользователи:
1. Злоумышленники:
   - Угроза: Несанкционированный доступ или повышение привилегий
   - Попытки обойти или использовать недостаточные средства контроля доступа для получения несанкционированного доступа к ресурсам или повышения привилегий.

2. Системный администратор:
   - Угроза: Неправильная конфигурация средств контроля доступа
   - Неправильная настройка параметров контроля доступа, позволяющая получить несанкционированный доступ или предоставляющая чрезмерные привилегии.

3. Пользователь:
   - Угроза: Несанкционированный доступ к ограниченным ресурсам
   - Попытки получить доступ к ресурсам, к которым они не имеют права доступа из-за недостаточного контроля доступа.

Компоненты:
1. Ресурс:
   - Представляет собой систему или данные, которые необходимо защитить.
   - Поток данных: запросы и ответы на доступ.

2. Механизмы контроля доступа:
   - Контролируют доступ к ресурсам на основе определенных политик.
   - Поток данных: проверка авторизации и предоставление или отказ в доступе.

Взаимодействия:
1. Злоумышленники:
   - Используют уязвимости или неправильную конфигурацию в механизмах контроля доступа для получения несанкционированного доступа.
   - Могут пытаться повысить привилегии, чтобы получить более высокий уровень доступа.

2. Системный администратор:
   - Неправильно настраивает параметры управления доступом, например назначает неверные разрешения или неправильно разделяет доступ.
   - Не проводит регулярный обзор и обновление политик и конфигураций контроля доступа.

3. Пользователь:
   - Запрашивает доступ к ресурсам через систему.
   - Может пытаться получить доступ к ресурсам с ограниченным доступом в обход контроля доступа.

4. Ресурс:
   - Содержит конфиденциальные данные или функциональные возможности, которые необходимо защитить.
   - Применяет политики контроля доступа, чтобы определить, следует ли предоставлять пользователю доступ.

5. Механизмы контроля доступа:
   - Обеспечивают соблюдение политик контроля доступа и определяют, обладает ли пользователь достаточными привилегиями для доступа к ресурсу.
   - Могут быть неправильно сконфигурированы или содержать уязвимости, которые могут быть использованы злоумышленниками.

```

### Неправильная эскалация привилегий	

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Неправильное повышение привилегий". Она включает таких участников, как "Злоумышленник" и "Пользователь", а также сервер, представляющий сервер приложений.

Модель угроз определяет угрозу "Неправильное повышение привилегий" и включает такие пути атаки, как "Эксплуатация уязвимости" злоумышленником и "Злоупотребление привилегиями пользователя" пользователем.

Код генерирует диаграмму модели угрозы в формате PNG под названием "improper_privilege_escalation_threat_model.png".



```
from pytm import TM, Actor, Server

# Создайте новую модель угрозы
tm = TM("Improper Privilege Escalation Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
user = Actor("User")

# Создать сервер
server = Server("Application Server")

# Определение угрозы неправомерной эскалации привилегий
tm.add_threat()
tm.threat.name("Improper Privilege Escalation")
tm.threat.description("Threat of improper privilege escalation in the application")

# Определите пути атаки
tm.attack_path(attacker, server, "Exploiting Vulnerability")
tm.attack_path(user, server, "Abusing User Privileges")

# Создайте диаграмму модели угроз
tm.generate_diagram("improper_privilege_escalation_threat_model.png")
```


#### **Модель угроз Microsoft**

```
Диаграмма модели угроз при неправильной эскалации привилегий:

Концепции:
- Повышение привилегий: Несанкционированное повышение привилегий доступа для выполнения действий, выходящих за рамки разрешенных.
- Уровни авторизации: Различные уровни привилегий доступа, предоставляемые пользователям или ролям.
- Недостаточные проверки привилегий: Недостаточная проверка прав пользователя при выполнении привилегированных действий.
- Несанкционированные действия: Выполнение несанкционированных действий или превышение предоставленных привилегий.

Пользователи:
1. Злоумышленники:
   - Угроза: Несанкционированное повышение привилегий
   - Попытки использования уязвимостей для получения более высоких уровней привилегий доступа и выполнения несанкционированных действий.

2. Системный администратор:
   - Угроза: Неправильная конфигурация уровней привилегий
   - Неправильно настраивает средства контроля доступа или не может должным образом назначить и управлять уровнями привилегий.

3. Пользователь:
   - Угроза: Несанкционированный доступ к привилегированным действиям
   - Попытки выполнить действия, выходящие за рамки разрешенных, путем использования уязвимостей повышения привилегий.

Компоненты:
1. Роли пользователей:
   - Представляют собой различные роли или группы пользователей с различными уровнями привилегий.
   - Поток данных: назначение ролей и связанных с ними разрешений.

2. Проверка привилегий:
   - Проверяет права пользователя перед выполнением привилегированных действий.
   - Поток данных: проверка прав пользователя и принятие решения об авторизации.

Взаимодействия:
1. Злоумышленники:
   - Используют уязвимости или слабые места для получения более высоких уровней привилегий доступа.
   - Выполняют несанкционированные действия, обходя или манипулируя механизмами проверки привилегий.

2. Системный администратор:
   - Неправильно настраивает уровни привилегий, предоставляя чрезмерные полномочия или неспособный правильно назначить роли.
   - Не внедряет надлежащие механизмы проверки привилегий или пренебрегает их регулярным пересмотром и обновлением.

3. Пользователь:
   - Просит выполнить действия в рамках разрешенных привилегий.
   - Может пытаться повысить привилегии, используя уязвимости в системе.

4. Роли пользователей:
   - Определяют привилегии доступа, связанные с различными группами пользователей или ролями.
   - Назначение и управление ролями на основе обязанностей пользователей и организационных политик.

5. Проверка привилегий:
   - Проверяет разрешения пользователей перед тем, как разрешить выполнение привилегированных действий.
   - Может иметь уязвимости или не иметь надлежащих проверок, что позволяет несанкционированно повышать привилегии.

```


### Утечка данных или несанкционированный доступ

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Утечка данных или несанкционированный доступ". В нее входят такие действующие лица, как "Злоумышленник" и "Пользователь", а также хранилище данных, представляющее конфиденциальные данные.

Модель угроз определяет угрозу "Утечка данных или несанкционированный доступ" и включает такие пути атаки, как "Эксплуатация уязвимости" злоумышленником и "Несанкционированный доступ" пользователем.

Код генерирует диаграмму модели угроз в формате PNG под названием "data_leakage_unauthorized_access_threat_model.png".

```
from pytm import TM, Actor, Datastore

# Создайте новую модель угрозы
tm = TM("Data Leakage or Unauthorized Access Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
user = Actor("User")

# Создание хранилища данных
datastore = Datastore("Sensitive Data")

# Определение угрозы утечки данных или несанкционированного доступа
tm.add_threat()
tm.threat.name("Data Leakage or Unauthorized Access")
tm.threat.description("Threat of unauthorized access or leakage of sensitive data")

# Определите пути атаки
tm.attack_path(attacker, datastore, "Exploiting Vulnerability")
tm.attack_path(user, datastore, "Unauthorized Access")

# Создайте диаграмму модели угроз
tm.generate_diagram("data_leakage_unauthorized_access_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для утечки данных или несанкционированного доступа:

Концепции:
- Утечка данных: Непреднамеренное или несанкционированное раскрытие конфиденциальных данных неавторизованным лицам.
- Несанкционированный доступ: Получение доступа к данным или системам без соответствующей авторизации.
- Шифрование данных: Процесс преобразования конфиденциальных данных в формат, который невозможно прочитать без соответствующего ключа дешифрования.
- Предотвращение потери данных (DLP): Методы и средства контроля, применяемые для предотвращения утечки конфиденциальных данных.

Пользователи:
1. Злоумышленники:
   - Угроза: Несанкционированный доступ или утечка данных
   - Попытки получить несанкционированный доступ к конфиденциальным данным или использовать уязвимости для утечки данных.

2. Системный администратор:
   - Угроза: Неправильная конфигурация средств контроля доступа или шифрования
   - Неправильно настраивает средства контроля доступа, в результате чего данные становятся уязвимыми для несанкционированного доступа.
   - Не удается внедрить или правильно настроить механизмы шифрования данных.

3. Пользователь:
   - Угроза: Случайная утечка данных
   - Непреднамеренное раскрытие конфиденциальных данных с помощью небезопасных методов или неправильной конфигурации.

Компоненты:
1. Хранилище данных:
   - Представляет собой системы хранения или базы данных, содержащие конфиденциальные данные.
   - Поток данных: хранение и получение конфиденциальных данных.

2. Контроль доступа:
   - Механизмы контроля и обеспечения санкционированного доступа к данным.
   - Поток данных: проверка подлинности и авторизация.

3. Шифрование данных:
   - Техники и алгоритмы, используемые для защиты конфиденциальных данных путем их шифрования.
   - Поток данных: процессы шифрования и дешифрования.

4. Предотвращение потери данных (DLP):
   - Методы и средства контроля для предотвращения несанкционированной утечки данных.
   - Поток данных: меры по предотвращению утечки данных и их мониторинг.

Взаимодействие:
1. Злоумышленники:
   - Используют уязвимости для получения несанкционированного доступа к конфиденциальным данным.
   - Могут использовать различные техники для извлечения и утечки данных без обнаружения.

2. Системный администратор:
   - Неправильно настраивает средства контроля доступа, предоставляя неавторизованным пользователям доступ к конфиденциальным данным.
   - Не применяет или не настраивает должным образом шифрование данных, что делает их уязвимыми для несанкционированного доступа.

3. Пользователь:
   - Может случайно раскрыть конфиденциальные данные в результате небезопасных действий, таких как обмен информацией или неправильное обращение с ней.

4. Хранилище данных:
   - Хранит конфиденциальные данные и требует надежного контроля доступа и шифрования для их защиты.
   - Может быть уязвимо для несанкционированного доступа при неправильной конфигурации или отсутствии надлежащих мер безопасности.

5. Контроль доступа:
   - Обеспечивает авторизованный доступ к данным на основе проверок аутентификации и авторизации.
   - Неправильная конфигурация или уязвимости в средствах контроля доступа могут привести к несанкционированному доступу.

6. Шифрование данных:
   - Защищает конфиденциальные данные, преобразуя их в нечитаемый формат без ключа дешифрования.
   - Правильная реализация и настройка алгоритмов шифрования необходимы для защиты данных.

7. Предотвращение потери данных (DLP):
   - Внедряет методы и средства контроля для предотвращения несанкционированной утечки данных.
   - Мониторинг потоков данных и применение политик для обнаружения и предотвращения потенциальных инцидентов утечки данных.
```


### Небезопасное хранение данных

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Небезопасное хранилище данных". Она включает таких агентов, как "Злоумышленник" и "Пользователь", а также хранилище данных, представляющее конфиденциальные данные.

Модель угроз определяет угрозу "Небезопасное хранилище данных" и включает такие пути атаки, как "Эксплуатация уязвимости хранилища" злоумышленником и "Несанкционированный доступ к хранимым данным" пользователем.

Код генерирует диаграмму модели угроз в формате PNG с именем "insecure_data_storage_threat_model.png".

```
from pytm import TM, Actor, Datastore

# Создайте новую модель угрозы
tm = TM("Insecure Data Storage Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
user = Actor("User")

# Создание хранилища данных
datastore = Datastore("Sensitive Data")

# Определение угрозы небезопасного хранения данных
tm.add_threat()
tm.threat.name("Insecure Data Storage")
tm.threat.description("Threat of insecure storage of sensitive data")

# Определите пути атаки
tm.attack_path(attacker, datastore, "Exploiting Storage Vulnerability")
tm.attack_path(user, datastore, "Unauthorized Access to Stored Data")

# Создайте диаграмму модели угроз
tm.generate_diagram("insecure_data_storage_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для небезопасного хранения данных:

Концепции:
- Небезопасное хранение данных: Хранение конфиденциальных данных незащищенным или уязвимым способом.
- Шифрование данных: Процесс преобразования конфиденциальных данных в формат, который невозможно прочитать без соответствующего ключа дешифрования.
- Утечка данных: Непреднамеренное или несанкционированное раскрытие конфиденциальных данных.
- Контроль доступа к данным: Механизмы, используемые для контроля и обеспечения авторизованного доступа к данным.

Пользователи:
1. Злоумышленники:
   - Угроза: Несанкционированный доступ к данным или утечка данных
   - Попытки получить несанкционированный доступ к конфиденциальным данным или использовать уязвимости для утечки данных.

2. Системный администратор:
   - Угроза: Неправильная настройка безопасности хранилища данных
   - Неправильно настраивает параметры хранения данных, в результате чего конфиденциальные данные становятся уязвимыми для несанкционированного доступа.
   - Не удается внедрить или правильно настроить механизмы шифрования данных.

3. Пользователь:
   - Угроза: Случайная утечка данных
   - Непреднамеренное раскрытие конфиденциальных данных с помощью небезопасных методов или неправильной конфигурации.

Компоненты:
1. Хранилище данных:
   - Представляет собой системы хранения или базы данных, в которых хранятся конфиденциальные данные.
   - Поток данных: хранение и получение конфиденциальных данных.

2. Шифрование данных:
   - Техники и алгоритмы, используемые для защиты конфиденциальных данных путем их шифрования.
   - Поток данных: процессы шифрования и дешифрования.

3. Контроль доступа к данным:
   - Механизмы, используемые для контроля и обеспечения санкционированного доступа к данным.
   - Поток данных: проверки аутентификации и авторизации.

Взаимодействия:
1. Злоумышленники:
   - Используют уязвимости для получения несанкционированного доступа к конфиденциальным данным.
   - Могут использовать различные техники для извлечения и утечки данных без обнаружения.

2. Системный администратор:
   - Неправильно настраивает параметры безопасности хранения данных, предоставляя неавторизованным пользователям доступ к конфиденциальным данным.
   - Не внедряет или не настраивает должным образом механизмы шифрования данных, что делает их уязвимыми для несанкционированного доступа.

3. Пользователь:
   - Может случайно раскрыть конфиденциальные данные в результате небезопасных действий, таких как обмен информацией или неправильное обращение с ней.

4. Хранилище данных:
   - Хранит конфиденциальные данные и требует надежных мер безопасности для их защиты.
   - Может быть уязвимо для несанкционированного доступа при неправильной конфигурации или отсутствии надлежащих средств контроля безопасности.

5. Шифрование данных:
   - Защищает конфиденциальные данные, преобразуя их в нечитаемый формат без ключа дешифрования.
   - Для защиты данных необходима правильная реализация и настройка алгоритмов шифрования.

6. Контроль доступа к данным:
   - Обеспечивает санкционированный доступ к данным на основе проверок аутентификации и авторизации.
   - Неправильная конфигурация или уязвимости в средствах контроля доступа могут привести к несанкционированному доступу.
```


### Неадекватная сегментация сети

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Неадекватное сегментирование сети". Она включает такие действующие лица, как "Злоумышленник", "Внутренний пользователь" и "Внешний пользователь", и определяет границы для внутренней и внешней сетей.

Модель угроз определяет угрозу "Неадекватное сегментирование сети" и включает потоки данных, представляющие поток конфиденциальных данных, несанкционированный доступ, утечку конфиденциальных данных, а также командование и контроль.

Код генерирует диаграмму модели угрозы в формате PNG под названием "inadequate_network_segmentation_threat_model.png".


```
from pytm import TM, Actor, Dataflow, Boundary

# Создайте новую модель угрозы
tm = TM("Inadequate Network Segmentation Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
internalUser = Actor("Internal User")
externalUser = Actor("External User")

# Создайте границы
internalNetwork = Boundary("Internal Network")
externalNetwork = Boundary("External Network")

# Определите потоки данных
dataflow1 = Dataflow(internalUser, internalNetwork, "Sensitive Data Flow")
dataflow2 = Dataflow(externalUser, internalNetwork, "Unauthorized Access")
dataflow3 = Dataflow(internalNetwork, externalNetwork, "Exfiltration of Sensitive Data")
dataflow4 = Dataflow(internalNetwork, externalNetwork, "Command and Control")

# Определите угрозу неадекватной сегментации сети
tm.add_threat()
tm.threat.name("Inadequate Network Segmentation")
tm.threat.description("Threat of inadequate segmentation between internal and external networks")

# Определите пути атаки
tm.attack_path(attacker, dataflow2, "Exploiting Insufficient Segmentation")
tm.attack_path(attacker, dataflow3, "Exfiltration of Sensitive Data")
tm.attack_path(attacker, dataflow4, "Command and Control")

# Создайте диаграмму модели угроз
tm.generate_diagram("inadequate_network_segmentation_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз при неадекватном сегментировании сети:

Концепции:
- Сегментация сети: Разделение сети на более мелкие, изолированные сегменты для повышения безопасности и контроля доступа.
- Неадекватное сегментирование сети: Недостаточное или неправильное разделение сегментов сети, позволяющее несанкционированный доступ или боковое перемещение.
- Сетевой брандмауэр: Устройство безопасности, которое контролирует и фильтрует сетевой трафик на основе заранее установленных правил безопасности.
- Поток данных: перемещение данных между различными сегментами сети.

Пользователи:
1. Злоумышленники:
   - Угроза: Несанкционированный доступ или латеральное перемещение
   - Попытка получить несанкционированный доступ к конфиденциальным данным или системам в различных сегментах сети.
   - Использует слабые места в сегментации сети для перемещения вбок и повышения привилегий.

2. Системный администратор:
   - Угроза: Неправильная конфигурация сегментации сети
   - Неправильно настраивает правила сегментации сети, позволяя несанкционированный доступ между сегментами сети.
   - Невозможность применения надлежащих правил брандмауэра для ограничения сетевого трафика.

Компоненты:
1. Сегменты сети:
   - Представляют собой изолированные сегменты сети в инфраструктуре.
   - Поток данных: контролируемый обмен данными между сегментами.

2. Сетевой брандмауэр:
   - Устройство безопасности, размещенное на границах между сегментами сети.
   - Контролирует входящий и исходящий сетевой трафик на основе заранее установленных правил.
   - Поток данных: фильтрация и маршрутизация сетевого трафика.

Взаимодействие:
1. Злоумышленники:
   - Используют слабые места в сегментации сети для получения несанкционированного доступа к конфиденциальным данным или системам.
   - Могут пытаться латерально перемещаться по сети, используя неадекватную сегментацию.

2. Системный администратор:
   - Неправильно настраивает правила сегментации сети, позволяя несанкционированный доступ между сегментами сети.
   - Неправильно настраивает правила брандмауэра, что приводит к неэффективной фильтрации трафика и сегментации.

3. Сегменты сети:
   - Представляют собой изолированные сегменты в сетевой инфраструктуре.
   - Требуют правильной конфигурации и правил сегментации для обеспечения авторизованного доступа и предотвращения несанкционированного перемещения.

4. Сетевой брандмауэр:
   - Контролирует поток сетевого трафика между сегментами на основе заранее определенных правил безопасности.
   - Неправильная конфигурация или неадекватный набор правил могут привести к несанкционированному доступу или боковому перемещению.

```

### Атаки типа "человек посередине

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Man-in-the-Middle (MitM) Attacks". Она включает такие субъекты, как "Злоумышленник", "Клиент" и "Сервер", и определяет границы для клиентских и серверных компонентов.

Модель угроз определяет угрозу "Атаки человека посередине" и включает поток данных, представляющий поток конфиденциальных данных между клиентом и сервером.

Код генерирует диаграмму модели угроз в формате PNG с именем "man_in_the_middle_attacks_threat_model.png".



```
from pytm import TM, Actor, Dataflow, Boundary

# Создайте новую модель угрозы
tm = TM("Man-in-the-Middle Attacks Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
client = Actor("Client")
server = Actor("Server")

# Создайте границы
clientBoundary = Boundary("Client Boundary")
serverBoundary = Boundary("Server Boundary")

# Определите потоки данных
dataflow1 = Dataflow(client, server, "Sensitive Data Flow")

# Определение угрозы атаки "человек посередине
tm.add_threat()
tm.threat.name("Man-in-the-Middle (MitM) Attacks")
tm.threat.description("Threat of an attacker intercepting and tampering with communication between client and server")

# Определите пути атаки
tm.attack_path(attacker, dataflow1, "Intercepting and Tampering with Communication")

# Создайте диаграмму модели угроз
tm.generate_diagram("man_in_the_middle_attacks_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для атак типа "человек посередине" (MitM):

Концепции:
- Атака "человек посередине" (MitM): Тип атаки, при которой злоумышленник перехватывает связь между двумя сторонами, чтобы подслушать, изменить или внедрить вредоносное содержимое.
- Шифрование сетевого трафика: Процесс шифрования сетевого трафика для защиты его от несанкционированного перехвата или фальсификации.
- Протоколы безопасной связи: Протоколы, обеспечивающие безопасные и аутентифицированные каналы связи.
- Поток данных: обмен данными между взаимодействующими сторонами.

Пользователи:
1. Злоумышленники:
   - Угроза: перехват и манипулирование коммуникациями
   - Попытка перехватить сетевой трафик между двумя сторонами и манипулировать передаваемыми данными.
   - Использует различные техники, такие как ARP-спуфинг или DNS-спуфинг, чтобы позиционировать себя как "человека посередине".

2. Системный администратор:
   - Угроза: Неправильная настройка средств контроля безопасности
   - Не настраивает должным образом средства контроля безопасности сети, что позволяет злоумышленникам использовать уязвимости и осуществлять MitM-атаки.
   - Не следит за использованием безопасных протоколов связи и механизмов шифрования.

3. Пользователи:
   - Угроза: Незашифрованная связь
   - Осуществляют связь без надлежащего шифрования или безопасных протоколов связи.
   - Могут неосознанно подключаться к взломанным сетям или стать жертвой MitM-атак.

Компоненты:
1. Канал связи:
   - Представляет собой среду, через которую осуществляется связь между сторонами, например сетевые соединения или беспроводные сети.
   - Поток данных: передача данных между взаимодействующими сторонами.

2. Протоколы безопасной связи:
   - Протоколы, обеспечивающие безопасные и аутентифицированные каналы связи, такие как HTTPS, SSL/TLS или VPN.
   - Поток данных: зашифрованная передача данных между сторонами.

Взаимодействие:
1. Злоумышленники:
   - Позиционируют себя как "человек посередине", перехватывая и манипулируя сетевым трафиком.
   - Используют уязвимости в канале связи или отсутствие шифрования для подслушивания, изменения или внедрения вредоносного содержимого.

2. Системный администратор:
   - Неправильно настраивает средства контроля сетевой безопасности, делая каналы связи уязвимыми для MitM-атак.
   - Не следит за использованием безопасных протоколов связи или механизмов шифрования.

3. Пользователи:
   - Вступают в коммуникацию без использования безопасных протоколов связи или шифрования.
   - Могут неосознанно подключаться к взломанным сетям или становиться жертвами MitM-атак.

4. Канал связи:
   - Представляет собой средство, с помощью которого стороны осуществляют связь.
   - Уязвим для перехвата и манипуляций со стороны злоумышленников, позиционирующих себя как "человек посередине".

5. Протоколы безопасной связи:
   - Обеспечивают безопасные и аутентифицированные каналы связи.
   - Шифрование и правильная настройка этих протоколов защищают от MitM-атак.
```


### Истощение ресурсов

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Исчерпание ресурсов". Она включает в себя такие субъекты, как "Злоумышленник" и "Сервис", и определяет поток данных между ними.

Модель угроз определяет угрозу "Исчерпание ресурсов" и включает путь атаки, представляющий способность злоумышленника потреблять чрезмерное количество ресурсов, что приводит к нарушению доступности сервиса.

Код генерирует диаграмму модели угрозы в формате PNG с именем "resource_exhaustion_threat_model.png".


```
from pytm import TM, Actor, Dataflow

# Создайте новую модель угрозы
tm = TM("Resource Exhaustion Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
service = Actor("Service")

# Определите потоки данных
dataflow = Dataflow(attacker, service, "Data Flow")

# Определите угрозу исчерпания ресурсов
tm.add_threat()
tm.threat.name("Resource Exhaustion")
tm.threat.description("Threat of an attacker consuming excessive resources and impacting service availability")

# Определите пути атаки
tm.attack_path(attacker, dataflow, "Excessive Resource Consumption")

# Создайте диаграмму модели угроз
tm.generate_diagram("resource_exhaustion_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угрозы для исчерпания ресурсов:

Концепции:
- Исчерпание ресурсов: Тип атаки, при которой злоумышленник потребляет чрезмерное количество ресурсов, таких как процессор, память, дисковое пространство или пропускная способность сети, что приводит к прерыванию обслуживания или отказу в обслуживании.
- Системные ресурсы: Относится к различным вычислительным ресурсам, доступным в системе, включая процессор, память, дисковое пространство и пропускную способность сети.
- Управление ресурсами: Процесс эффективного выделения и управления системными ресурсами.
- Поток данных: перемещение данных или запросов, требующих системных ресурсов.

Пользователи:
1. Злоумышленники:
   - Угроза: Потребление ресурсов
   - Попытка потреблять чрезмерное количество системных ресурсов, чтобы вызвать перебои в работе или отказ в обслуживании.
   - Использование уязвимостей или недостатков конструкции для исчерпания системных ресурсов.

2. Системные администраторы:
   - Угроза: неадекватное управление ресурсами
   - Не применяют надлежащие методы управления ресурсами, что позволяет злоумышленникам потреблять ресурсы сверх установленных пределов.
   - Отсутствие механизмов мониторинга и контроля для обнаружения и смягчения последствий атак на истощение ресурсов.

Компоненты:
1. Системные ресурсы:
   - Представляют собой различные вычислительные ресурсы в системе, включая процессор, память, дисковое пространство и пропускную способность сети.
   - Поток данных: Запросы или операции, для выполнения которых требуются системные ресурсы.

2. Управление ресурсами:
   - Техники и механизмы, используемые для эффективного распределения и управления системными ресурсами.
   - Поток данных: распределение и использование системных ресурсов.

Взаимодействие:
1. Злоумышленники:
   - Проводят атаки на исчерпание ресурсов, перегружая системные ресурсы.
   - Используют уязвимости или недостатки конструкции для максимального потребления ресурсов.

2. Системные администраторы:
   - Внедряют методы управления ресурсами для предотвращения атак на истощение ресурсов.
   - Отслеживайте использование ресурсов и выявляйте аномальные модели потребления ресурсов.

3. Системные ресурсы:
   - Доступные вычислительные ресурсы, необходимые для нормальной работы системы.
   - Могут быть перегружены и исчерпаны злоумышленниками, потребляющими чрезмерное количество ресурсов.

4. Управление ресурсами:
   - Контролирует и управляет распределением системных ресурсов.
   - Обеспечивает эффективное использование и предотвращает исчерпание ресурсов.
```


### Распределенные DoS-атаки (DDoS)

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Распределенные атаки типа "отказ в обслуживании" (DDoS)". Она включает в себя таких участников, как "Атакующий" и "Цель", и определяет поток данных между ними.

Модель угроз определяет угрозу "DDoS-атаки" и включает путь атаки, представляющий атакующего, который переполняет целевую систему большим количеством запросов, вызывая отказ в обслуживании.

Код генерирует диаграмму модели угрозы в формате PNG с именем "ddos_attacks_threat_model.png".

```
from pytm import TM, Actor, Dataflow

# Создайте новую модель угрозы
tm = TM("DDoS Attacks Threat Model")

# Create actors
attacker = Actor("Attacker")
target = Actor("Target")

# Define dataflows
dataflow = Dataflow(attacker, target, "Data Flow")

# Define DDoS Attacks threat
tm.add_threat()
tm.threat.name("DDoS Attacks")
tm.threat.description("Threat of an attacker overwhelming the target system with a high volume of requests, causing denial of service")

# Define attack paths
tm.attack_path(attacker, dataflow, "DDoS Attack")

# Generate the threat model diagram
tm.generate_diagram("ddos_attacks_threat_model.png")
```

#### **Microsoft Threat Model**

```
Threat Model Diagram for Distributed Denial of Service (DDoS) Attacks:

Concepts:
- Distributed Denial of Service (DDoS) Attack: A type of attack where multiple compromised systems, known as "botnets," flood a target system with a high volume of traffic or requests, overwhelming its resources and causing service disruption or denial of service.
- Botnet: A network of compromised computers or devices under the control of an attacker, used to launch DDoS attacks.
- Traffic Amplification: Techniques used by attackers to magnify the volume of traffic generated by each compromised system in the botnet.
- Resource Consumption: The depletion of system resources, such as network bandwidth, CPU, memory, or storage, due to the high volume of incoming traffic or requests.

Users:
1. Attackers:
   - Threat: DDoS Attack
   - Control a botnet comprising multiple compromised systems.
   - Coordinate the attack to flood the target system with a high volume of traffic or requests, causing service disruption or denial of service.
   - Use traffic amplification techniques to maximize the impact of the attack.

2. Target System:
   - Threat: Service Disruption or Denial of Service
   - Represents the system or service under attack.
   - Receives a massive influx of traffic or requests from the botnet, causing resource exhaustion and rendering the system inaccessible.

Components:
1. Botnet:
   - Collection of compromised systems under the control of the attacker.
   - Data Flow: Communication and coordination between the attacker and compromised systems for launching the DDoS attack.

2. Traffic Amplification Techniques:
   - Methods used by attackers to increase the volume of traffic generated by each compromised system.
   - Data Flow: Manipulation of traffic to amplify its volume before being directed to the target system.

3. Target System:
   - Represents the system or service being targeted by the DDoS attack.
   - Data Flow: Incoming traffic or requests that overwhelm the system's resources.

Interactions:
1. Attackers:
   - Control the botnet and orchestrate the DDoS attack.
   - Utilize traffic amplification techniques to maximize the impact of the attack.

2. Botnet:
   - Comprises compromised systems under the control of the attackers.
   - Executes instructions from the attackers to generate and direct a high volume of traffic or requests to the target system.

3. Traffic Amplification Techniques:
   - Used by attackers to increase the volume of traffic generated by each compromised system.
   - Amplify the traffic before it reaches the target system, magnifying the impact of the DDoS attack.

4. Target System:
   - Represents the system or service under attack.
   - Overwhelmed by the high volume of incoming traffic or requests, leading to resource exhaustion and service disruption or denial of service.
```


### Misconfigured security settings

#### **PyTM**

This code creates a threat model using PyTM and represents the "Misconfigured Security Settings" threat scenario. It includes actors such as "Administrator" and "Attacker" and defines a dataflow between them.

The threat model defines the "Misconfigured Security Settings" threat and describes the threat arising from misconfigured security settings, leading to vulnerabilities and potential unauthorized access.

The code generates a threat model diagram in PNG format, named "misconfigured_security_settings_threat_model.png."

```
from pytm import TM, Actor, Dataflow

# Создайте новую модель угрозы
tm = TM("Misconfigured Security Settings Threat Model")

# Создать действующий субъек
administrator = Actor("Administrator")
attacker = Actor("Attacker")

# Определите потоки данных
dataflow = Dataflow(administrator, attacker, "Data Flow")

# Определение угрозы неверно настроенных параметров безопасности
tm.add_threat()
tm.threat.name("Misconfigured Security Settings")
tm.threat.description("Threat arising from misconfigured security settings, leading to vulnerabilities and potential unauthorized access")

# Определите пути атаки
tm.attack_path(administrator, dataflow, "Misconfiguration Attack")

# Создайте диаграмму модели угроз
tm.generate_diagram("misconfigured_security_settings_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для неправильно настроенных параметров безопасности:

Концепции:
- Неправильно сконфигурированные параметры безопасности: Параметры конфигурации, которые не соответствуют рекомендуемым практикам безопасности, что делает системы или компоненты уязвимыми для атак или несанкционированного доступа.
- Конфигурация безопасности: Параметры и конфигурации, применяемые к системам, приложениям или сетевым компонентам для обеспечения контроля безопасности и защиты от угроз.
- Поверхность атаки: Совокупность точек входа или уязвимостей, которые могут быть использованы злоумышленниками для получения несанкционированного доступа или компрометации системы.
- Путь атаки: Путь или последовательность шагов, которые может предпринять злоумышленник, чтобы использовать неверно настроенные параметры безопасности и скомпрометировать систему.

Пользователи:
1. Системные администраторы:
   - Угроза: Неадекватная конфигурация
   - Отвечают за настройку и управление параметрами безопасности систем, приложений или сетевых компонентов.
   - Может случайно неправильно настроить параметры безопасности, оставив уязвимости или слабые места открытыми для эксплуатации.

2. Злоумышленники:
   - Угроза: Несанкционированный доступ или эксплуатация
   - Попытка использовать неправильно настроенные параметры безопасности для получения несанкционированного доступа, повышения привилегий или компрометации системы.
   - Использование слабых мест в конфигурациях безопасности для обхода средств контроля и проведения атак.

Компоненты:
1. Система или приложение:
   - Представляет собой систему или приложение с параметрами безопасности, которые должны быть правильно сконфигурированы.
   - Содержит различные конфигурации, связанные с безопасностью, которые влияют на общий уровень безопасности.

2. Параметры конфигурации безопасности:
   - Конкретные параметры или конфигурации, применяемые к системам, приложениям или сетевым компонентам для обеспечения контроля безопасности.
   - Включают настройки, связанные с аутентификацией, контролем доступа, шифрованием, регистрацией, аудитом и другими мерами безопасности.

Взаимодействие:
1. Системные администраторы:
   - Отвечают за настройку и управление параметрами безопасности.
   - Могут неправильно настроить параметры безопасности, оставляя уязвимости или слабые места открытыми для использования злоумышленниками.

2. Злоумышленники:
   - Пытаются использовать неправильно настроенные параметры безопасности для получения несанкционированного доступа или компрометации системы.
   - Используют слабые места в конфигурациях безопасности для обхода средств контроля и проведения атак.

3. Система или приложение:
   - Содержит конфигурации безопасности, которые необходимо правильно применять и управлять ими.
   - Уязвима для атак и несанкционированного доступа, если настройки безопасности неверно сконфигурированы.

4. Поверхность атаки:
   - Представляет собой совокупность точек входа или уязвимостей, которые могут использовать злоумышленники.
   - Неправильно настроенные параметры безопасности могут увеличить поверхность атаки и предоставить возможности для эксплуатации.

5. Путь атаки:
   - Представляет собой последовательность шагов, которые может предпринять злоумышленник для использования неверно настроенных параметров безопасности.
   - Идет по пути наименьшего сопротивления, чтобы скомпрометировать систему или получить несанкционированный доступ.
```


### Небезопасные конфигурации по умолчанию

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Небезопасные конфигурации по умолчанию". Она включает такие действующие лица, как "Администратор" и "Злоумышленник", и определяет поток данных между ними.

Модель угроз определяет угрозу "Небезопасные конфигурации по умолчанию" и описывает угрозу, возникающую из-за небезопасных конфигураций по умолчанию, приводящих к уязвимостям и потенциальному несанкционированному доступу.

Код генерирует диаграмму модели угроз в формате PNG с именем "insecure_default_configurations_threat_model.png".

```
from pytm import TM, Actor, Dataflow

# Создайте новую модель угрозы
tm = TM("Insecure Default Configurations Threat Model")

# Создать действующий субъек
administrator = Actor("Administrator")
attacker = Actor("Attacker")

# Определите потоки данных
dataflow = Dataflow(administrator, attacker, "Data Flow")

# Определение угрозы небезопасных конфигураций по умолчанию
tm.add_threat()
tm.threat.name("Insecure Default Configurations")
tm.threat.description("Threat arising from insecure default configurations, leading to vulnerabilities and potential unauthorized access")

# Определите пути атаки
tm.attack_path(administrator, dataflow, "Insecure Default Configurations Attack")

# Создайте диаграмму модели угроз
tm.generate_diagram("insecure_default_configurations_threat_model.png")
```


#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для небезопасных конфигураций по умолчанию:

Концепции:
- Небезопасные конфигурации по умолчанию: Конфигурации системы или приложения, которые небезопасны или слабы по умолчанию, часто устанавливаемые при установке или инициализации.
- Поверхность атаки: Совокупность точек входа или уязвимостей, которые могут быть использованы злоумышленниками для получения несанкционированного доступа или компрометации системы.
- Путь атаки: Путь или последовательность шагов, которые может предпринять злоумышленник, чтобы использовать небезопасные конфигурации по умолчанию и скомпрометировать систему.

Пользователи:
1. Системные администраторы:
   - Угроза: неадекватная конфигурация
   - Отвечают за установку и настройку систем или приложений.
   - Могут непреднамеренно оставлять небезопасные конфигурации по умолчанию, что создает потенциальные уязвимости для злоумышленников.

2. Злоумышленники:
   - Угроза: Несанкционированный доступ или эксплуатация
   - Попытка использовать небезопасные конфигурации по умолчанию для получения несанкционированного доступа, повышения привилегий или компрометации системы.
   - Использование слабых мест в стандартных конфигурациях для обхода средств контроля безопасности и проведения атак.

Компоненты:
1. Система или приложение:
   - Представляет собой систему или приложение с конфигурациями по умолчанию, которые необходимо изменить.
   - Содержит различные параметры и конфигурации, влияющие на безопасность.

2. Параметры конфигурации по умолчанию:
   - Начальные параметры или конфигурации, которые устанавливаются или инициализируются при установке системы или приложения.
   - Эти конфигурации могут не обеспечивать достаточную безопасность и должны быть изменены для уменьшения уязвимостей.

Взаимодействие:
1. Системные администраторы:
   - Отвечают за установку и настройку систем или приложений.
   - Могут не заметить или пренебречь изменением небезопасных конфигураций по умолчанию, оставляя потенциальные уязвимости для злоумышленников.

2. Злоумышленники:
   - Пытаются использовать небезопасные стандартные конфигурации для получения несанкционированного доступа или компрометации системы.
   - Используют слабые места в стандартных конфигурациях для обхода средств контроля безопасности и проведения атак.

3. Система или приложение:
   - Содержит конфигурации по умолчанию, которые необходимо изменить для уменьшения уязвимостей.
   - Уязвимы для атак и несанкционированного доступа, если не устранить небезопасные конфигурации по умолчанию.

4. Поверхность атаки:
   - Представляет собой совокупность точек входа или уязвимостей, которые могут использовать злоумышленники.
   - Небезопасные конфигурации по умолчанию могут увеличить поверхность атаки и предоставить возможности для эксплуатации.

5. Путь атаки:
   - Представляет собой последовательность шагов, которые может предпринять злоумышленник для использования небезопасных конфигураций по умолчанию.
   - Идет по пути наименьшего сопротивления, чтобы скомпрометировать систему или получить несанкционированный доступ.
```

### Несвоевременное обновление программного обеспечения

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Задержка обновления программного обеспечения". Она включает такие субъекты, как "Администратор" и "Злоумышленник", и определяет поток данных между ними.

Модель угроз определяет угрозу "Задержка исправления программного обеспечения" и описывает угрозу, возникающую из-за задержки или неадекватного исправления программного обеспечения, в результате чего системы становятся уязвимыми для известных эксплойтов.

Код генерирует диаграмму модели угрозы в формате PNG с именем "delayed_patching_threat_model.png".


```
from pytm import TM, Actor, Dataflow

# Создайте новую модель угрозы
tm = TM("Delayed Patching of Software Threat Model")

# Создать действующий субъек
administrator = Actor("Administrator")
attacker = Actor("Attacker")

# Определите потоки данных
dataflow = Dataflow(administrator, attacker, "Data Flow")

# Определение угрозы отложенного исправления программного обеспечения
tm.add_threat()
tm.threat.name("Delayed Patching of Software")
tm.threat.description("Threat arising from delayed or inadequate software patching, leaving systems vulnerable to known exploits")

# Определите пути атаки
tm.attack_path(administrator, dataflow, "Delayed Patching of Software Attack")

# Создайте диаграмму модели угроз
tm.generate_diagram("delayed_patching_threat_model.png")
```


#### **Модель угроз Microsoft**

```
Диаграмма модели угроз при задержке исправления программного обеспечения:

Концепции:
- Задержка исправления программного обеспечения: Практика несвоевременного применения исправлений и обновлений к программному обеспечению или системам, в результате чего они становятся уязвимыми к известным уязвимостям безопасности.
- Поверхность атаки: Совокупность точек входа или уязвимостей, которые могут быть использованы злоумышленниками для получения несанкционированного доступа или компрометации системы.
- Путь атаки: Путь или последовательность шагов, которые может предпринять злоумышленник, чтобы воспользоваться задержкой обновления программного обеспечения и скомпрометировать систему.

Пользователи:
1. Системные администраторы:
   - Угроза: неадекватное управление исправлениями
   - Отвечает за управление и применение патчей и обновлений для программного обеспечения или систем.
   - Может задерживать или игнорировать своевременное применение патчей, оставляя уязвимости открытыми для эксплуатации.

2. Злоумышленники:
   - Угроза: Эксплуатация известных уязвимостей
   - Попытка использовать известные уязвимости в программном обеспечении или системах, которые не были своевременно исправлены.
   - Использование слабых мест в непропатченном программном обеспечении для получения несанкционированного доступа, повышения привилегий или компрометации системы.

Компоненты:
1. Программное обеспечение или система:
   - Представляет собой программное обеспечение или систему, требующую регулярного исправления и обновления.
   - Содержит известные уязвимости, которые могут быть устранены с помощью исправлений.

2. Процесс управления исправлениями:
   - Процесс управления и применения исправлений и обновлений для программного обеспечения или систем.
   - Включает в себя такие задачи, как оценка, тестирование, развертывание и мониторинг патчей.

Взаимодействие:
1. Системные администраторы:
   - Отвечают за управление и применение исправлений и обновлений к программному обеспечению или системам.
   - Могут задерживать или игнорировать своевременное применение патчей из-за операционных ограничений или по другим причинам.

2. Злоумышленники:
   - Пытаются использовать известные уязвимости в непропатченном программном обеспечении или системах.
   - Используют слабые места в программном обеспечении, которое не было обновлено, для получения несанкционированного доступа или компрометации системы.

3. Программное обеспечение или система:
   - Требует регулярного исправления и обновления для устранения известных уязвимостей.
   - Уязвимы для атак и несанкционированного доступа, если исправления не применяются своевременно.

4. Поверхность атаки:
   - Представляет собой совокупность точек входа или уязвимостей, которые могут использовать злоумышленники.
   - Несвоевременное исправление программного обеспечения может увеличить поверхность атаки и предоставить возможности для эксплуатации.

5. Путь атаки:
   - Представляет собой последовательность шагов, которые может предпринять злоумышленник, чтобы использовать задержку исправления программного обеспечения.
   - Идет по пути наименьшего сопротивления для компрометации системы или получения несанкционированного доступа.

Примечание: Это упрощенное текстовое представление дает высокоуровневое представление о компонентах, потоках данных и взаимодействиях, связанных с угрозой "Задержка исправления программного обеспечения". В комплексную модель угрозы будут включены дополнительные специфические компоненты и взаимодействия, относящиеся к анализируемой системе.
```

### Отсутствие сканирования уязвимостей

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Отсутствие сканирования уязвимостей". Она включает таких участников, как "Администратор" и "Злоумышленник", и определяет поток данных между ними.

Модель угроз определяет угрозу "Отсутствие сканирования уязвимостей" и описывает угрозу, возникающую из-за отсутствия регулярного сканирования уязвимостей, что может привести к необнаруженным уязвимостям и потенциальной эксплуатации.

Код генерирует диаграмму модели угроз в формате PNG под названием "lack_of_vulnerability_scanning_threat_model.png".


```
from pytm import TM, Actor, Dataflow

# Создайте новую модель угрозы
tm = TM("Lack of Vulnerability Scanning Threat Model")

# Создать действующий субъек
administrator = Actor("Administrator")
attacker = Actor("Attacker")

# Определите потоки данных
dataflow = Dataflow(administrator, attacker, "Data Flow")

# Определите отсутствие угрозы сканирования уязвимостей
tm.add_threat()
tm.threat.name("Lack of Vulnerability Scanning")
tm.threat.description("Threat arising from the lack of regular vulnerability scanning, which can result in undetected vulnerabilities and potential exploitation")

# Определите пути атаки
tm.attack_path(administrator, dataflow, "Lack of Vulnerability Scanning Attack")

# Создайте диаграмму модели угроз
tm.generate_diagram("lack_of_vulnerability_scanning_threat_model.png")
```


#### **Модель угроз Microsoft**

```
Диаграмма модели угроз при отсутствии сканирования уязвимостей:

Концепции:
- Отсутствие сканирования уязвимостей: Невозможность регулярного сканирования систем или приложений на предмет известных уязвимостей и слабых мест.
- Оценка уязвимостей: Процесс выявления и оценки уязвимостей в системах или приложениях.
- Поверхность атаки: Совокупность точек входа или уязвимостей, которые могут быть использованы злоумышленниками для получения несанкционированного доступа или компрометации системы.
- Путь атаки: Путь или последовательность шагов, которые может предпринять злоумышленник, чтобы использовать существующие уязвимости и скомпрометировать систему.

Пользователи:
1. Системные администраторы:
   - Отвечают за управление и поддержку систем или приложений.
   - Могут пренебрегать или упускать из виду важность регулярного сканирования уязвимостей.

2. Злоумышленники:
   - Угроза: Эксплуатация непропатченных уязвимостей
   - Попытка выявить и использовать непропатченные уязвимости в системах или приложениях.
   - Эксплуатация слабых мест, которые не были обнаружены из-за отсутствия сканирования уязвимостей.

Компоненты:
1. Система или приложение:
   - Представляет собой систему или приложение, требующее регулярного сканирования уязвимостей.
   - Содержит потенциальные уязвимости, которые необходимо выявить и устранить.

2. Инструмент сканирования уязвимостей:
   - Инструмент или программное обеспечение, используемое для сканирования систем или приложений на предмет известных уязвимостей.
   - Обнаруживает и сообщает о потенциальных слабых местах, которые могут быть использованы злоумышленниками.

Взаимодействие:
1. Системные администраторы:
   - Отвечают за управление и поддержку систем или приложений.
   - Могут не уделять приоритетного внимания или не планировать регулярное сканирование уязвимостей, в результате чего системы могут быть подвержены непропатченным уязвимостям.

2. Злоумышленники:
   - Пытаются найти и использовать непропатченные уязвимости в системах или приложениях.
   - Используют слабые места, которые не были обнаружены из-за отсутствия сканирования уязвимостей.

3. Система или приложение:
   - Требуется регулярное сканирование уязвимостей для выявления и устранения потенциальных уязвимостей.
   - Уязвима для атак и несанкционированного доступа, если не обнаружены и не устранены непропатченные уязвимости.

4. Поверхность атаки:
   - Представляет собой совокупность точек входа или уязвимостей, которые могут использовать злоумышленники.
   - Отсутствие сканирования уязвимостей может увеличить поверхность атаки и предоставить возможности для эксплуатации.

5. Путь атаки:
   - Представляет собой последовательность шагов, которые может предпринять злоумышленник для использования непропатченных уязвимостей.
   - Идет по пути наименьшего сопротивления, чтобы скомпрометировать систему или получить несанкционированный доступ.
```


### Злонамеренные или небрежные инсайдеры

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Злонамеренные или халатные инсайдеры". Она включает в себя таких участников, как "Инсайдер" и "Злоумышленник", и определяет поток данных между ними.

Модель угроз определяет угрозу "Злонамеренные или халатные инсайдеры" и описывает угрозу, возникающую от инсайдеров со злым умыслом или халатным поведением, которые могут злоупотреблять своими привилегиями, красть конфиденциальные данные или наносить ущерб системе.

Код генерирует диаграмму модели угрозы в формате PNG под названием "malicious_or_negligent_insiders_threat_model.png".

```
from pytm import TM, Actor, Dataflow

# Создайте новую модель угрозы
tm = TM("Malicious or Negligent Insiders Threat Model")

# Создать действующий субъек
insider = Actor("Insider")
attacker = Actor("Attacker")

# Определите потоки данных
dataflow = Dataflow(insider, attacker, "Data Flow")

# Определение угрозы злонамеренных или халатных инсайдеров
tm.add_threat()
tm.threat.name("Malicious or Negligent Insiders")
tm.threat.description("Threat arising from insiders with malicious intent or negligent behavior who may abuse their privileges, steal sensitive data, or cause damage to the system")

# Определите пути атаки
tm.attack_path(insider, dataflow, "Malicious or Negligent Insiders Attack")

# Создайте диаграмму модели угроз
tm.generate_diagram("malicious_or_negligent_insiders_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для злонамеренных или небрежных инсайдеров:

Концепции:
- Инсайдеры: Лица, имеющие авторизованный доступ к системе или приложению.
- Вредоносный инсайдер: Инсайдер, который намеренно злоупотребляет своими привилегиями или действует со злым умыслом.
- Небрежный инсайдер: Инсайдер, который непреднамеренно причиняет вред или нарушает безопасность по неосторожности.
- Контроль доступа: Механизмы, используемые для обеспечения санкционированного доступа к ресурсам.
- Потеря или утечка данных: Несанкционированное раскрытие или потеря конфиденциальных данных.

Пользователи:
1. Вредоносный инсайдер:
   - Угроза: Несанкционированный доступ или кража данных
   - Использует свой авторизованный доступ для получения несанкционированного доступа, кражи данных или нанесения ущерба системе.

2. Небрежный инсайдер:
   - Угроза: Случайная утечка данных
   - Непреднамеренно раскрывает конфиденциальные данные или нарушает безопасность из-за неосторожности или недостаточной осведомленности.

Компоненты:
1. Система аутентификации:
   - Управляет аутентификацией пользователей и контролем доступа.
   - Поток данных: запросы на аутентификацию пользователей.

2. Хранилище данных:
   - Хранит конфиденциальные данные.
   - Поток данных: Чтение или изменение конфиденциальных данных.

3. Система протоколирования:
   - Собирает журналы и аудиторскую информацию.
   - Поток данных: хранение журналов действий пользователей.

Взаимодействия:
1. Вредоносный инсайдер:
   - Использует слабые средства контроля аутентификации или украденные учетные данные для получения несанкционированного доступа к системе.
   - Осуществляет несанкционированный доступ к данным или их кражу, обходя средства контроля доступа или злоупотребляя привилегиями.

2. Небрежный инсайдер:
   - Случайно раскрывает конфиденциальные данные, неправильно настраивая средства контроля доступа или небрежно обращаясь с данными.
   - Может неосознанно загружать или передавать конфиденциальные данные во внешние источники.

3. Система аутентификации:
   - Проверяет подлинность учетных данных пользователей и обеспечивает контроль доступа.
   - Регистрирует действия по аутентификации и обнаруживает подозрительные шаблоны входа в систему.

4. Хранилище данных:
   - Хранит конфиденциальные данные и обеспечивает контроль доступа.
   - Регистрирует действия по доступу к данным и их изменению.

5. Система протоколирования:
   - Собирает журналы действий пользователей, включая попытки аутентификации и события доступа к данным.
   - Поддерживает мониторинг и анализ для выявления подозрительных или несанкционированных действий.

```



### Несанкционированный доступ к данным или их кража

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Несанкционированный доступ к данным или кража". Она включает такие действующие лица, как "Злоумышленник" и "Пользователь", и определяет поток данных между пользователем и хранилищем конфиденциальных данных.

Модель угроз определяет угрозу "Несанкционированный доступ к данным или кража" и описывает угрозу несанкционированного доступа или кражи конфиденциальных данных злоумышленниками.

Код генерирует диаграмму модели угроз в формате PNG с именем "unauthorized_data_access_theft_threat_model.png".


```
from pytm import TM, Actor, Datastore, Boundary, Dataflow

# Создайте новую модель угрозы
tm = TM("Unauthorized Data Access or Theft Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
user = Actor("User")

# Создайте границу
boundary = Boundary("Internal Network")

# Создание хранилища данных
datastore = Datastore("Sensitive Data")

# Определите потоки данных
dataflow = Dataflow(user, datastore, "Data Access")

# Определение угрозы несанкционированного доступа к данным или их кражи
tm.add_threat()
tm.threat.name("Unauthorized Data Access or Theft")
tm.threat.description("Threat of unauthorized access or theft of sensitive data by attackers")

# Определите пути атаки
tm.attack_path(attacker, dataflow, "Unauthorized Data Access or Theft Attack")

# Создайте диаграмму модели угроз
tm.generate_diagram("unauthorized_data_access_theft_threat_model.png")
```


#### **Модель угроз Microsoft**

```
Диаграмма модели угроз несанкционированного доступа к данным или их кражи:

Концепции:
- Несанкционированный доступ к данным или их кража: Неавторизованный доступ, кража или раскрытие конфиденциальных или секретных данных.
- Классификация данных: Процесс категоризации данных на основе их чувствительности или критичности.
- Контроль доступа: Механизмы и политики, регулирующие доступ к данным и защищающие их от несанкционированного доступа.
- Поверхность атаки: Совокупность точек входа или уязвимостей, которые могут быть использованы злоумышленниками для получения несанкционированного доступа или компрометации системы.
- Путь атаки: Путь или последовательность шагов, которые может предпринять злоумышленник для использования уязвимостей и получения несанкционированного доступа к данным.

Пользователи:
1. Системные администраторы:
   - Отвечают за управление контролем доступа и разрешениями на доступ к конфиденциальным данным.
   - Могут неправильно настроить или пропустить параметры безопасности, что приведет к несанкционированному доступу или краже.

2. Злоумышленники:
   - Угроза: Несанкционированный доступ к данным или их кража
   - Попытка получить несанкционированный доступ к конфиденциальным данным или украсть их в злонамеренных целях.
   - Использование уязвимостей в средствах контроля доступа или других слабых мест для обхода мер безопасности.

Компоненты:
1. Чувствительные данные:
   - Представляют собой данные, которые необходимо защитить от несанкционированного доступа или кражи.
   - Включают персональную информацию (PII), финансовые данные, интеллектуальную собственность и другие конфиденциальные данные.

2. Механизмы контроля доступа:
   - Механизмы и политики, применяемые для контроля доступа к конфиденциальным данным.
   - Примеры: аутентификация пользователей, контроль доступа на основе ролей (RBAC) и шифрование.

Взаимодействие:
1. Системные администраторы:
   - Отвечают за управление контролем доступа и разрешениями на доступ к конфиденциальным данным.
   - Могут неправильно настроить или пропустить параметры безопасности, что приведет к несанкционированному доступу или краже.

2. Злоумышленники:
   - Пытаются получить несанкционированный доступ к конфиденциальным данным или украсть их в злонамеренных целях.
   - Используют уязвимости в средствах контроля доступа или другие слабые места, чтобы обойти меры безопасности.

3. Чувствительные данные:
   - Требуют соответствующего контроля доступа для предотвращения несанкционированного доступа или кражи.
   - Уязвимы для несанкционированного доступа или кражи, если средства контроля доступа не реализованы должным образом или неправильно сконфигурированы.

4. Поверхность атаки:
   - Представляет собой совокупность точек входа или уязвимостей, которые могут использовать злоумышленники.
   - Слабые или неправильно настроенные средства контроля доступа могут увеличить площадь атаки и предоставить возможности для несанкционированного доступа.

5. Путь атаки:
   - Представляет собой последовательность шагов, которые может предпринять злоумышленник для использования уязвимостей и получения несанкционированного доступа к конфиденциальным данным.
   - Идет по пути наименьшего сопротивления, чтобы скомпрометировать систему и украсть данные.
```



### Несанкционированный физический доступ

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Несанкционированный физический доступ". Она включает такие действующие лица, как "Злоумышленник", "Физический злоумышленник" и "Пользователь", и определяет поток данных между пользователем и хранилищем данных чувствительного оборудования.

Модель угроз определяет угрозу "Несанкционированный физический доступ" и описывает угрозу несанкционированного физического доступа злоумышленников к чувствительному оборудованию.

Код генерирует диаграмму модели угроз в формате PNG с именем "unauthorized_physical_access_threat_model.png".


```
from pytm import TM, Actor, Datastore, Boundary, Dataflow

# Создайте новую модель угрозы
tm = TM("Unauthorized Physical Access Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
physical_attacker = Actor("Physical Attacker")
user = Actor("User")

# Создайте границу
boundary = Boundary("Physical Location")

# Создание хранилища данных
datastore = Datastore("Sensitive Equipment")

# Определите потоки данных
dataflow = Dataflow(user, datastore, "Data Access")

# Определение угрозы несанкционированного физического доступа
tm.add_threat()
tm.threat.name("Unauthorized Physical Access")
tm.threat.description("Threat of unauthorized physical access to sensitive equipment by attackers")

# Определите пути атаки
tm.attack_path(physical_attacker, dataflow, "Unauthorized Physical Access Attack")

# Создайте диаграмму модели угроз
tm.generate_diagram("unauthorized_physical_access_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для несанкционированного физического доступа:

Концепции:
- Несанкционированный физический доступ: Несанкционированный вход или присутствие людей в физических зонах, где они не должны находиться.
- Физическая безопасность: Меры и средства контроля, применяемые для защиты физических активов, таких как здания, помещения и оборудование.
- Контроль доступа: Механизмы и политики, регулирующие вход и ограничивающие доступ в физические зоны.
- Поверхность атаки: Уязвимости и точки входа, которые могут быть использованы неавторизованными лицами для получения физического доступа.
- Путь атаки: Последовательность шагов, которые может предпринять злоумышленник, чтобы обойти меры физической безопасности и получить несанкционированный доступ.

Пользователи:
1. Администраторы объекта:
   - Отвечают за управление мерами физической безопасности и системами контроля доступа.
   - Могут неправильно настроить или пропустить параметры безопасности, что приведет к несанкционированному физическому доступу.

2. Несанкционированные лица:
   - Угроза: Несанкционированный физический доступ
   - Попытка получить физический доступ в зоны ограниченного доступа без соответствующего разрешения.
   - Использование уязвимостей в мерах физической безопасности или поиск способов их обхода.

Компоненты:
1. Физические зоны:
   - Представляют собой различные области в пределах объекта или помещения, такие как серверные комнаты, центры обработки данных или зоны ограниченного доступа.
   - Каждая зона имеет определенный уровень ограничения доступа и содержит ценные активы или конфиденциальную информацию.

2. Механизмы контроля доступа:
   - Механизмы и средства контроля, регулирующие вход и ограничивающие доступ в физические зоны.
   - Например, карты доступа, биометрические системы, замки, сигнализация и камеры наблюдения.

Взаимодействие:
1. Администраторы объекта:
   - Отвечают за управление мерами физической безопасности и системами контроля доступа.
   - Могут неправильно настроить или пропустить параметры безопасности, что приведет к несанкционированному физическому доступу.

2. Несанкционированные лица:
   - Пытаются получить физический доступ в зоны ограниченного доступа без соответствующего разрешения.
   - Используют уязвимые места в мерах физической безопасности или находят способы их обойти.

3. Физические зоны:
   - Требуют наличия надлежащих механизмов контроля доступа для предотвращения несанкционированного физического доступа.
   - Уязвимы для несанкционированного доступа, если меры физической безопасности не реализованы должным образом или неправильно сконфигурированы.

4. Поверхность атаки:
   - Представляет собой уязвимые места и точки входа, которые могут использовать неавторизованные лица.
   - Слабые или неправильно сконфигурированные меры физической безопасности могут увеличить поверхность атаки и предоставить возможности для несанкционированного физического доступа.

5. Путь атаки:
   - Представляет собой последовательность шагов, которые может предпринять злоумышленник, чтобы обойти меры физической безопасности и получить несанкционированный доступ.
   - Для того чтобы нарушить физическую безопасность объекта или помещения, следует идти по пути наименьшего сопротивления.
```



### Кража или уничтожение оборудования

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Кража или уничтожение аппаратного обеспечения". Она включает такие действующие лица, как "Злоумышленник", "Физический злоумышленник" и "Пользователь", и определяет поток данных между пользователем и аппаратным хранилищем данных.

Модель угроз определяет угрозу "Кража или уничтожение аппаратного обеспечения" и описывает угрозу кражи или уничтожения аппаратного обеспечения злоумышленниками.

Код генерирует диаграмму модели угроз в формате PNG с именем "theft_destruction_hardware_threat_model.png".


```
from pytm import TM, Actor, Datastore, Boundary, Dataflow

# Создайте новую модель угрозы
tm = TM("Theft or Destruction of Hardware Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
physical_attacker = Actor("Physical Attacker")
user = Actor("User")

# Создайте границу
boundary = Boundary("Physical Location")

# Создание хранилища данных
datastore = Datastore("Hardware")

# Определите потоки данных
dataflow = Dataflow(user, datastore, "Data Access")

# Определение угрозы кражи или уничтожения оборудования
tm.add_threat()
tm.threat.name("Theft or Destruction of Hardware")
tm.threat.description("Threat of theft or destruction of hardware by attackers")

# Определите пути атаки
tm.attack_path(physical_attacker, dataflow, "Theft or Destruction of Hardware Attack")

# Создайте диаграмму модели угроз
tm.generate_diagram("theft_destruction_hardware_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для кражи или уничтожения аппаратного обеспечения:

Концепции:
- Кража или уничтожение аппаратных средств: Неавторизованное удаление или повреждение физических аппаратных устройств.
- Физическая безопасность: Меры и средства контроля, применяемые для защиты физических активов, таких как аппаратные устройства.
- Инвентаризация активов: Запись всех аппаратных устройств, их местоположения и владельца.
- Поверхность атаки: Уязвимости и точки входа, которые могут быть использованы неавторизованными лицами для кражи или повреждения оборудования.
- Путь атаки: Последовательность шагов, которые может предпринять злоумышленник, чтобы обойти меры физической безопасности и украсть или уничтожить аппаратное обеспечение.

Пользователи:
1. Администраторы объекта:
   - Отвечают за управление мерами физической безопасности и ведение инвентаризации активов.
   - Могут неправильно настроить или пропустить параметры безопасности, что приводит к уязвимостям в защите оборудования.

2. Несанкционированные лица:
   - Угроза: Кража или уничтожение аппаратного обеспечения
   - Попытки украсть или повредить аппаратные устройства в целях личной выгоды, саботажа или других злонамеренных целей.
   - Использование уязвимостей в мерах физической безопасности или поиск способов их обхода.

Компоненты:
1. Аппаратные устройства:
   - Представляют собой физические устройства, такие как серверы, рабочие станции, ноутбуки или другое ценное оборудование.
   - Каждое устройство имеет уникальный идентификатор, местоположение и информацию о владельце, занесенную в инвентарную опись активов.

2. Меры физической безопасности:
   - Меры и средства контроля, применяемые для защиты аппаратных устройств от кражи или уничтожения.
   - Например, замки, сигнализация, камеры наблюдения, механизмы контроля доступа и безопасные места хранения.

3. Инвентаризация активов:
   - Запись или база данных, в которой отслеживаются все аппаратные устройства, их местоположение и информация о владельцах.
   - Помогает выявить пропавшее или скомпрометированное оборудование и помогает в процессах восстановления или замены.

Взаимодействие:
1. Администраторы объекта:
   - Отвечают за управление мерами физической безопасности и ведение инвентаризации активов.
   - Могут неправильно настроить или пропустить параметры безопасности, что приводит к уязвимостям в защите оборудования.

2. Несанкционированные лица:
   - Пытаются украсть или повредить аппаратные устройства в целях личной выгоды, саботажа или в других злонамеренных целях.
   - Используют уязвимые места в мерах физической безопасности или находят способы их обойти.

3. Аппаратные устройства:
   - Требуют надлежащих мер физической безопасности для предотвращения несанкционированного доступа, кражи или уничтожения.
   - Уязвимы для кражи или уничтожения, если меры физической безопасности не реализованы должным образом или неправильно сконфигурированы.

4. Инвентаризация активов:
   - Ведется администраторами объекта для отслеживания аппаратных устройств и информации о владельцах.
   - Помогает выявить пропавшее или скомпрометированное оборудование и помогает в процессах восстановления или замены.

5. Поверхность атаки:
   - Представляет собой уязвимые места и точки входа, которые могут использовать неавторизованные лица.
   - Слабые или неправильно сконфигурированные меры физической безопасности могут увеличить площадь атаки и предоставить возможности для кражи или уничтожения оборудования.

6. Путь атаки:
   - Представляет собой последовательность шагов, которые может предпринять злоумышленник, чтобы обойти меры физической безопасности, украсть или уничтожить оборудование.
   - Для того чтобы нарушить физическую безопасность аппаратных устройств, следует идти по пути наименьшего сопротивления.
```


### Уязвимости в компонентах сторонних производителей

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Уязвимости в компонентах сторонних производителей". Она включает такие действующие лица, как "Злоумышленник" и "Пользователь", и определяет поток данных между пользователем и хранилищем конфиденциальных данных.

Модель угроз определяет угрозу "Уязвимости в компонентах сторонних производителей" и описывает угрозу уязвимостей в компонентах сторонних производителей, используемых в системе.

Код генерирует диаграмму модели угроз в формате PNG с именем "third_party_component_vulnerabilities_threat_model.png".

```
from pytm import TM, Actor, Datastore, Dataflow, Boundary

# Создайте новую модель угрозы
tm = TM("Vulnerabilities in Third-Party Components Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
user = Actor("User")

# Создайте границу
boundary = Boundary("System Boundary")

# Создание хранилища данных
datastore = Datastore("Sensitive Data")

# Определите потоки данных
dataflow = Dataflow(user, datastore, "Data Access")

# Определение угрозы уязвимостей в компонентах сторонних производителей
tm.add_threat()
tm.threat.name("Vulnerabilities in Third-Party Components")
tm.threat.description("Threat of vulnerabilities in third-party components used in the system")

# Определите пути атаки
tm.attack_path(attacker, dataflow, "Exploitation of Third-Party Component Vulnerabilities")

# Создайте диаграмму модели угроз
tm.generate_diagram("third_party_component_vulnerabilities_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угроз для уязвимостей в компонентах сторонних производителей:

Концепции:
- Уязвимости в компонентах сторонних производителей: Слабости или недостатки, присутствующие в программных или аппаратных компонентах, разработанных внешними сторонними поставщиками.
- Компоненты сторонних производителей: Программные или аппаратные модули, библиотеки, фреймворки или сервисы, разработанные внешними поставщиками и интегрированные в систему.
- Жизненный цикл разработки программного обеспечения (SDLC): Процесс разработки, тестирования и развертывания программного обеспечения.
- Управление уязвимостями: Процесс выявления, оценки, устранения и мониторинга уязвимостей в компонентах программного обеспечения.
- Управление исправлениями: Процесс применения исправлений и обновлений безопасности к компонентам сторонних производителей.

Пользователи:
1. Разработчики системы:
   - Отвечают за интеграцию и использование сторонних компонентов в системе.
   - Могут неосознанно вносить уязвимости, не оценив должным образом безопасность компонентов или неправильно их внедрив.

2. Поставщики сторонних компонентов:
   - Разрабатывают и поддерживают компоненты сторонних производителей, используемые в системе.
   - Могут иметь уязвимости в своих компонентах из-за ошибок кодирования, недостатков проектирования или устаревших зависимостей.

Компоненты:
1. Компоненты сторонних производителей:
   - Представляют собой программные или аппаратные модули, библиотеки, фреймворки или сервисы, разработанные внешними поставщиками и интегрированные в систему.
   - Могут создавать уязвимости, если их не оценивать, не внедрять и не обновлять исправлениями безопасности.

2. Компоненты системы:
   - Представляют собой внутренние компоненты системы, включая программное обеспечение, разработанное на заказ, и другие элементы инфраструктуры.

3. Жизненный цикл разработки программного обеспечения (SDLC):
   - Процесс, которому следуют разработчики системы для разработки, тестирования и развертывания системы.
   - Включает в себя такие действия, как сбор требований, проектирование, кодирование, тестирование и развертывание.

Взаимодействие:
1. Разработчики системы:
   - Отвечают за интеграцию и использование в системе компонентов сторонних производителей.
   - Должны оценить безопасность сторонних компонентов перед интеграцией и обеспечить их правильную реализацию.

2. Поставщики сторонних компонентов:
   - Разрабатывают и поддерживают компоненты сторонних производителей, используемые в системе.
   - Должны следовать практикам безопасного кодирования, проводить регулярные оценки безопасности и предоставлять исправления и обновления безопасности для своих компонентов.

3. Компоненты сторонних производителей:
   - Интегрируются в систему разработчиками системы.
   - Могут создавать уязвимости, если их не оценить или не внедрить должным образом.

4. Жизненный цикл разработки программного обеспечения (SDLC):
   - Предоставляет разработчикам системы рамки, которым они должны следовать в процессе разработки.
   - Должен включать меры безопасности и оценки для выявления и устранения уязвимостей в компонентах сторонних разработчиков.

5. Управление уязвимостями:
   - Включает в себя выявление, оценку, устранение и мониторинг уязвимостей в программных компонентах.
   - Должно быть частью общего процесса разработки и обслуживания системы.

6. Управление исправлениями:
   - Применение исправлений и обновлений безопасности к компонентам сторонних разработчиков для устранения известных уязвимостей.
   - Должно выполняться регулярно, чтобы система была защищена от известных уязвимостей.
```



### Отсутствие надзора за деятельностью третьих лиц

#### **PyTM**

Этот код создает модель угрозы с помощью PyTM и представляет сценарий угрозы "Отсутствие надзора за деятельностью третьих сторон". Она включает таких участников, как "Злоумышленник", "Пользователь" и "Третья сторона", и определяет потоки данных между пользователем, сторонним процессом и хранилищем конфиденциальных данных.

Модель угроз определяет угрозу "Отсутствие надзора за деятельностью третьих лиц" и описывает угрозу недостаточного надзора за деятельностью третьих лиц в системе.

Код генерирует диаграмму модели угроз в формате PNG под названием "lack_of_oversight_third_party_activities_threat_model.png".



```
from pytm import TM, Actor, Process, Datastore, Dataflow, Boundary

# Создайте новую модель угрозы
tm = TM("Lack of Oversight on Third-Party Activities Threat Model")

# Создать действующий субъек
attacker = Actor("Attacker")
user = Actor("User")
third_party = Actor("Third-Party")

# Создайте границу
boundary = Boundary("System Boundary")

# Создайте процесс
process = Process("Third-Party Process")

# Создание хранилища данных
datastore = Datastore("Sensitive Data")

# Определите потоки данных
dataflow1 = Dataflow(user, process, "Data Sharing")
dataflow2 = Dataflow(process, datastore, "Data Storage")

# Определить угрозу отсутствия надзора за деятельностью третьих лиц
tm.add_threat()
tm.threat.name("Lack of Oversight on Third-Party Activities")
tm.threat.description("Threat of lack of oversight on third-party activities in the system")

# Определите пути атаки
tm.attack_path(attacker, dataflow1, "Unauthorized Data Sharing")
tm.attack_path(attacker, dataflow2, "Unauthorized Data Storage")

# Создайте диаграмму модели угроз
tm.generate_diagram("lack_of_oversight_third_party_activities_threat_model.png")
```

#### **Модель угроз Microsoft**

```
Диаграмма модели угрозы отсутствия надзора за деятельностью третьих лиц:

Концепции:
- Отсутствие надзора: недостаточный мониторинг, надзор или контроль за деятельностью, осуществляемой сторонними поставщиками.
- Деятельность третьих лиц: Деятельность, осуществляемая внешними поставщиками, например разработка программного обеспечения, обработка данных или обслуживание системы.
- Границы доверия: Точки, в которых система взаимодействует с внешними субъектами, включая сторонних поставщиков.
- Конфиденциальность данных: Защита конфиденциальных данных от несанкционированного доступа, использования или раскрытия.
- Соответствие нормативным требованиям: Соблюдение соответствующих законов, правил и отраслевых стандартов.

Пользователи:
1. Владельцы системы:
   - Отвечают за надзор за работой системы, ее безопасностью и соответствием требованиям.
   - Могут делегировать определенные задачи или обязанности сторонним поставщикам.

2. Сторонние поставщики:
   - Внешние организации, привлекаемые для выполнения определенных действий или предоставления услуг, связанных с системой.
   - Могут иметь доступ к компонентам системы, данным или инфраструктуре.

Компоненты:
1. Компоненты системы:
   - Представляют собой внутренние компоненты системы, включая программное обеспечение, аппаратные средства и сетевую инфраструктуру.

2. Деятельность третьих лиц:
   - Деятельность, осуществляемая внешними поставщиками от имени владельца системы.
   - Примеры включают разработку программного обеспечения, обработку данных, обслуживание системы или облачный хостинг.

Потоки данных:
1. Владелец системы - сторонние поставщики:
   - Предполагает общение, координацию и делегирование задач или обязанностей сторонним поставщикам.
   - Может включать обмен системной документацией, привилегиями доступа или конкретными требованиями проекта.

2. Сторонние поставщики - компоненты системы:
   - Предполагает выполнение действий сторонними поставщиками в отношении компонентов системы.
   - Может включать разработку, обслуживание или хостинг компонентов системы.

3. Компоненты системы - сторонним поставщикам:
   - Предполагает обмен данными, учетными данными или компонентами системы между системой и сторонними поставщиками.
   - Может включать обработку данных, хранение данных или системную интеграцию.

Взаимодействия:
1. Владельцы системы:
   - Отвечают за надзор за работой системы, ее безопасностью и соответствием требованиям.
   - Должны установить четкие ожидания, требования и соглашения со сторонними поставщиками в отношении надзора и мониторинга.

2. Сторонние поставщики:
   - Привлекаются для выполнения определенной деятельности или предоставления услуг, связанных с системой.
   - Должны придерживаться согласованных требований по надзору и мониторингу и предоставлять необходимую информацию или отчеты по запросу.

3. Границы доверия:
   - Точки, в которых система взаимодействует с внешними субъектами, включая сторонних поставщиков.
   - Должны быть идентифицированы и определены, чтобы четко разграничить обязанности и привилегии доступа сторонних поставщиков.

4. Конфиденциальность данных:
   - Защита конфиденциальных данных от несанкционированного доступа, использования или раскрытия.
   - Владельцы систем должны убедиться, что сторонние поставщики работают с конфиденциальными данными в соответствии с нормами конфиденциальности данных и отраслевыми стандартами.

5. Соответствие нормативным требованиям:
   - Подразумевает соблюдение соответствующих законов, правил и отраслевых стандартов.
   - Владельцы систем должны убедиться, что сторонние поставщики соблюдают в своей деятельности применимые правила и стандарты.
```





## Обнаружение угроз 


![stride](../../../assets/images/threats.png)


| Ненормальный сетевой трафик | Потенциальные угрозы | 
|:---------------|:---------------------|
| `Сканирование порта/хоста` | Поведение сканирования порта или хоста означает, что один из хостов, возможно, заражен вредоносной программой, и вредоносная программа ищет уязвимости, другие службы или хосты в сети.	 | 
|` Большое количество исходящих DNS-запросов от одного и того же узла` | Это симптом вредоносного ПО Command and Control (C&C), устанавливающего связь между зараженным узлом и C&C-сервером с помощью протокола DNS. 	 | 
| `Большое количество исходящих HTTP-запросов с одного и того же хоста` | Это симптом C&C, устанавливающего связь между зараженным хостом и C&C-сервером по протоколу HTTP.	 | 
| `Периодический исходящий трафик с одинаковыми запросами или в один и тот же период времени каждый день` | Это симптом C&C вредоносного ПО, устанавливающего связь между зараженным хостом и C&C сервером.	 | 
| `Исходящий трафик на внешний веб-сайт или DNS, включенный в список известных угроз по данным анализа угроз` | Пользователь может быть обманут с помощью социальной инженерии, чтобы подключиться к внешнему веб-сайту с известной угрозой, или C&C-соединение успешно установлено. 	 | 

Для визуализации состояния сетевых угроз рекомендуются два инструмента с открытым исходным кодом: Malcom и Maltrail (система обнаружения вредоносного трафика). Malcom может представить диаграмму взаимосвязей между хостами. Она помогает понять, есть ли внутренние узлы, подключенные к внешнему подозрительному C&C-серверу или известным "плохим" сайтам. https://github.com/tomchop/malcom#what-is-malcom





## Индикаторы компрометации 

Анализ хостов на предмет подозрительного поведения также представляет собой серьезную проблему, связанную с доступностью журналов. Например, динамическая информация о времени выполнения может не регистрироваться в файлах, а исходный процесс, используемый для сброса подозрительного файла, может быть не записан. Поэтому в качестве первой линии защиты от вредоносного ПО всегда рекомендуется устанавливать IDS/IPS хоста, например OSSEC (Open Source HIDS SEcurity), или антивирусное ПО хоста. После установки IDS/IPS или антивирусного ПО на хост-компьютер анализ угроз и анализ больших данных дополняют друг друга, помогая нам понять общий уровень безопасности хоста и все известные индикаторы компрометации (IoCs) в существующих средах хоста.

В зависимости от степени серьезности, ниже перечислены основные типы поведения, которые могут указывать на наличие взломанного узла:


 
### Внешний IP-адрес клиента
Анализ IP-адреса источника может помочь выявить следующее: 
Известный плохой IP или узел выхода TOR 
Аномальные изменения геолокации 
Одновременные соединения из разных геолокаций. 
Для перевода IP-адреса в геолокацию можно использовать базу данных MaxMind GeoIP2: 
https://dev.maxmind.com/geoip/geoip2/geolite2/#Downloads

### Отпечаток клиента (ОС, браузер, пользовательский агент, устройства и так далее)
Отпечаток клиента можно использовать для определения необычных клиентских или небраузерных подключений. ClientJS с открытым исходным кодом - это чистый JavaScript, который можно использовать для сбора информации об отпечатке клиента. JA3, предоставляемый Salesforce, использует профилирование соединений SSL/TLS для выявления вредоносных клиентов.
ClientJS: https://clientjs.org/
JA3: https://github.com/salesforce/ja3

### Репутация веб-сайта
При наличии исходящего соединения с внешним веб-сайтом мы можем проверить репутацию целевого веб-сайта на предмет угроз. Это можно сделать с помощью брандмауэра веб-приложений или решений по обеспечению безопасности веб-шлюзов
https://www.virustotal.com/

### Случайное доменное имя с помощью алгоритмов генерации доменов (DGA)
Доменное имя C&C-сервера может быть сгенерировано с помощью DGA. Ключевыми характеристиками домена DGA являются высокая энтропия, большое количество согласных и большая длина доменного имени. Основываясь на этих показателях, мы можем проанализировать, генерируется ли доменное имя DGA и может ли оно быть потенциальным C&C-сервером. 
Детектор DGA: https://github.com/exp0se/dga_detector/
Кроме того, чтобы уменьшить количество ложных срабатываний, мы можем использовать миллион лучших сайтов Alexa в качестве "белого списка" сайтов. См. https://s3.amazonaws.com/alexa-static/top-1m.csv.zip. 

### Загрузка подозрительных файлов
Анализ подозрительных файлов в песочнице Cuckoo: 
`https://cuckoosandbox.org/`

### DNS-запросы 
В случае анализа DNS-запросов ключевыми индикаторами компрометации являются следующие:
DNS-запросы к неавторизованным DNS-серверам. 
Несоответствующие ответы DNS могут быть индикатором подмены DNS.
Клиенты подключаются к нескольким DNS-серверам. 
Длинный DNS-запрос, например, более 150 символов, что является признаком DNS-туннелирования. 
Доменное имя с высокой энтропией. Это индикатор DNS-туннелирования или C&C-сервера.




