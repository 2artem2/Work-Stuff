---
layout: default
title: Django
parent: Rules
---

# Django
{: .no_toc }


## Оглавление
{: .no_toc .text-delta }

1. TOC
{:toc}

---




### XSS

<span class="d-inline-block p-2 mr-1 v-align-middle bg-red-000"></span>Несоответствующий код:


```java
# Noncompliant code
from django.shortcuts import render

def post_comment(request):
    name = request.POST.get('name')
    message = request.POST.get('message')

    return render(request, 'comment.html', {'name': name, 'message': message})
```

В этом несоответствующем коде функция представления post_comment получает пользовательский ввод из запроса и напрямую передает его в шаблон без какой-либо санитарной обработки или валидации. Это делает приложение уязвимым к атакам межсайтового скриптинга (XSS), так как злоумышленник может отправить вредоносные теги сценария или код, который будет отображен как есть при отображении шаблона.






<span class="d-inline-block p-2 mr-1 v-align-middle bg-green-000"></span>Соответствующий код:


```java
# Compliant code
from django.shortcuts import render
from django.utils.html import escape

def post_comment(request):
    name = request.POST.get('name')
    message = request.POST.get('message')
    
    sanitized_message = escape(message)

    return render(request, 'comment.html', {'name': name, 'message': sanitized_message})
```


В соответствующем коде функция escape из django.utils.html используется для санации пользовательского ввода путем экранирования специальных символов, которые имеют особое значение в HTML. Это гарантирует, что пользовательский ввод будет рассматриваться как обычный текст при отображении в шаблоне, предотвращая его выполнение как кода.

Важно отметить, что хотя функция escape обеспечивает базовую защиту от XSS-атак, она зависит от контекста. В зависимости от конкретного контекста вывода (например, HTML-атрибуты, JavaScript, CSS) может потребоваться дополнительная дезинфекция или кодирование. Django предоставляет другие утилиты, такие как mark_safe и шаблонные фильтры (safe, escapejs и т.д.), которые могут быть использованы для работы с различными контекстами вывода.

Помимо санации ввода, другие меры безопасности, которые вы можете реализовать в Django для уменьшения уязвимостей XSS, включают:

* Использование встроенного шаблонизатора Django и его функций автоматического экранирования HTML для обеспечения правильного экранирования пользовательского контента.
* Применение правильной кодировки при выводе динамических данных в HTML-атрибутах или других контекстах, требующих других правил экранирования.
* Внедрение политик безопасности содержимого (CSP) для контроля типов содержимого, разрешенных для загрузки и выполнения на веб-страницах.

Правильно санируя пользовательский ввод и применяя меры безопасности во всем Django-приложении, вы сможете эффективно бороться с XSS-уязвимостями и повысить общую безопасность вашего веб-приложения.

