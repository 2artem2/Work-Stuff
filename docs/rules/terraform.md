---
layout: default
title: Terraform
parent: Rules
---

# Terraform
{: .no_toc }



## Оглавление
{: .no_toc .text-delta }

1. TOC
{:toc}

---




## Учетная запись с жестким кодом

<span class="d-inline-block p-2 mr-1 v-align-middle bg-red-000"></span>Несоответствующий код:


```php
# Несоответствующий код
resource "aws_instance" "my_instance" {
  ami           = "ami-0123456789abcdef0"
  instance_type = "t2.micro"
  key_name      = "my_key_pair"
  security_groups = ["${var.security_group_id}"]
}
```

В этом несоответствующем коде ресурс aws_instance создает экземпляр EC2 в AWS, используя жестко заданный идентификатор AMI, тип экземпляра, пару ключей и идентификатор группы безопасности. Такой подход создает риски для безопасности, поскольку конфиденциальная информация и детали конфигурации жестко закодированы в коде Terraform, что делает его менее гибким, удобным для сопровождения и подверженным ошибкам.





<span class="d-inline-block p-2 mr-1 v-align-middle bg-green-000"></span>Соответствующий код:


```php
# Соответствующий код
variable "ami_id" {
  type    = string
  default = "ami-0123456789abcdef0"
}

variable "instance_type" {
  type    = string
  default = "t2.micro"
}

variable "key_name" {
  type    = string
  default = "my_key_pair"
}

variable "security_group_id" {
  type    = string
  default = ""
}

resource "aws_instance" "my_instance" {
  ami           = var.ami_id
  instance_type = var.instance_type
  key_name      = var.key_name
  security_groups = [var.security_group_id]
}
```


В совместимом коде определены переменные, чтобы сделать код более гибким и настраиваемым. Идентификаторы ami_id, instance_type, key_name и security_group_id объявлены как переменные, что позволяет легко параметризовать и задавать их во время развертывания Terraform. Это позволяет повысить удобство повторного использования, динамическую конфигурацию и отделить конфиденциальную информацию от кода Terraform.

Использование переменных позволяет хранить конфиденциальную информацию и сведения о конфигурации вне кода Terraform. Такой подход повышает безопасность, обеспечивая лучший контроль над конфиденциальными данными и позволяя легче управлять и настраивать инфраструктурные ресурсы.

Кроме того, убедитесь, что конфиденциальные данные, хранящиеся в переменных, должным образом защищены, например, используйте проверку входных переменных в Terraform, храните переменные в безопасных и зашифрованных местах или используйте системы управления секретами.

При работе с Terraform не забывайте следовать практикам безопасного кодирования, например, использовать доступ с наименьшими привилегиями, регулярно обновлять версии Terraform, чтобы использовать исправления безопасности, и использовать безопасные каналы связи для хранения состояния Terraform.

Применяя более гибкий и параметризованный подход с использованием переменных, вы сможете повысить безопасность, ремонтопригодность и масштабируемость развертывания инфраструктуры Terraform.


