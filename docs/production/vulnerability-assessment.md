---
layout: default
title: Vulnerability Assessment
parent: Production
---

{: .no_toc }

## Оглавление
{: .no_toc .text-delta }

1. TOC
{:toc}

---

# Оценка уязвимостей
{: .no_toc }


Оценка уязвимостей - это процесс выявления и количественной оценки уязвимостей в ИТ-системах, приложениях и инфраструктуре организации. Целью оценки уязвимостей является предоставление организациям комплексного представления о состоянии их безопасности, что позволяет им выявлять и определять приоритеты рисков безопасности и предпринимать шаги по их устранению.

В контексте DevSecOps оценка уязвимостей является важнейшим компонентом комплексной стратегии безопасности. Регулярно проверяя уязвимости и выявляя потенциальные риски безопасности, организации могут предпринять упреждающие шаги для защиты своих приложений и инфраструктуры.

К числу ключевых преимуществ оценки уязвимостей в DevSecOps относятся:

1. Раннее обнаружение уязвимостей: Регулярное сканирование на наличие уязвимостей позволяет организациям обнаруживать потенциальные риски безопасности на ранних стадиях, что дает им возможность оперативно принимать меры по их устранению.

2. Улучшенное управление рисками: Оценка уязвимостей дает организациям полное представление о состоянии их безопасности, позволяя им выявлять и определять приоритеты рисков безопасности и принимать меры по их снижению.

3. Соответствие требованиям: Многие нормативные требования, такие как PCI DSS и HIPAA, требуют регулярного проведения оценки уязвимостей в рамках своих стандартов соответствия.

4. Интеграция с другими практиками DevSecOps: Оценка уязвимостей может быть интегрирована с другими практиками DevSecOps, такими как непрерывная интеграция и непрерывное развертывание, для обеспечения безопасности в жизненном цикле разработки приложений.

Существует множество инструментов и технологий для оценки уязвимостей, которые можно использовать в DevSecOps, включая коммерческие решения и решения с открытым исходным кодом. Среди популярных инструментов оценки уязвимостей - Nessus, Qualys и OpenVAS.


Лучшие практики оценки уязвимости:

1. Регулярно проводите оценку уязвимостей, чтобы выявить потенциальные слабые места и неправильные конфигурации в вашей сети и инфраструктуре.

2. Используйте сочетание автоматизированных и ручных методов сканирования уязвимостей для обеспечения всестороннего охвата.

3. Определяйте приоритеты и устраняйте уязвимости с учетом их серьезности и потенциального влияния на вашу организацию.

4. Регулярно обновляйте и исправляйте программное обеспечение и системы для устранения известных уязвимостей.

5. Используйте сегментацию и изоляцию, чтобы ограничить распространение атак в случае успешного взлома.



## Nessus

Сканер уязвимостей, позволяющий выявлять уязвимости и неправильные конфигурации в сети и инфраструктуре.	


```
nessuscli scan new -n "My Scan" -t "192.168.1.0/24" -T "Basic Network Scan"
```

## OpenVAS

Сканер уязвимостей с открытым исходным кодом, позволяющий выявлять уязвимости и неправильные конфигурации в вашей сети и инфраструктуре.	

```
omp -u admin -w password -h localhost -p 9390 -G
```

## Nmap

Сканер для исследования сети и поиска уязвимостей, позволяющий выявлять открытые порты и потенциальные уязвимости в сети.	


```
nmap -sS -A -p1-65535 target.com
```

## Qualys

Облачная платформа управления уязвимостями, позволяющая выявлять уязвимости и неправильные конфигурации в сети и инфраструктуре.	

```
curl -H 'X-Requested-With: Curl Sample' -u "USERNAME:PASSWORD" -H 'Accept: application/json' -H 'Content-Type: application/json' 'https://qualysapi.qualys.com/api/2.0/fo/scan/?action=launch&scan_title=NewScan&target=TARGET_IP&option_profile=PROFILE_ID'
```

## Trivy


- [ ] Сканирование образов контейнеров с помощью Trivy

Trivy - это легкий сканер уязвимостей, который может быть интегрирован в ваш CI/CD пайплайн для сканирования образов контейнеров перед развертыванием. Вот пример использования Trivy для сканирования образа контейнера:


```
trivy image <image-name>:<tag>
```




- [ ] Сканирование диаграмм Helm с помощью Trivy

Trivy также может сканировать диаграммы Helm на наличие уязвимостей перед их развертыванием. Вот пример использования Trivy для сканирования диаграммы Helm:

```
trivy chart <chart-path>
```


## Syft


- [ ] Анализ образов контейнеров с помощью Syft

Syft предоставляет подробную информацию о зависимостях и уязвимостях, присутствующих в образе контейнера. Вот пример использования Syft для анализа образа контейнера:


```
syft <имя образа>:<tag>
```


## Gruype

- [ ] Анализ образов контейнеров с помощью Gruype

Gruype - это сканер уязвимостей, разработанный специально для анализа образов контейнеров. Вот пример использования Gruype для анализа образа контейнера:

```
grype <имя образа>:<tag>
```






## Lynis

- [ ] **Провести сканирование системы**

```
lynis audit system: Выполнить аудит безопасности системы.
```

- [ ] **Указать профиль**

```
lynis audit system --profile <profile-name>: Выполнение аудита безопасности с использованием определенного профиля.
```

- [ ] **Генерировать отчет**

```
lynis report --report-file <report-file.txt>: Генерирует отчет о результатах аудита.
```

- [ ] **Запустить неинтерактивный режим**

```
lynis audit system --quiet: Запуск Lynis в неинтерактивном режиме с отображением только предупреждений и предложений.
```

- [ ] **Обновить базу данных Lynis**

```
lynis update info: Обновление базы данных Lynis последними проверками уязвимостей и информацией.
```

- [ ] **Включить режим отладки**

```
lynis audit system --debug: Запускает Lynis в режиме отладки, предоставляя подробную отладочную информацию.
```

- [ ] **Игнорировать специфические тесты**

```
lynis audit system --tests <test1,test2>: Пропустить определенные тесты во время аудита.
```

- [ ] **Просмотреть доступные плагины**

```
lynis show plugins: Просмотр доступных плагинов, которые можно использовать с Lynis.
```


## Checkov



- [ ] **Проверить определенный каталог или файл на наличие проблем с безопасностью**	

```
checkov -d <каталог> или checkov -f <файл>
```

- [ ] **Проверка определенной конфигурации облачного провайдера**	

```
checkov -t <провайдер>
```

- [ ] **Сканировать файл конфигурации определенного облачного провайдера**	

```
checkov -t <провайдер> -f <файл>
```

- [ ] **Выполнить рекурсивное сканирование каталога**	

```
checkov -d <каталог> --recursive
```

- [ ] **Игнорировать определенные идентификаторы проверок во время сканирования**	

```
checkov -d <directory> --skip-check <check_id>
```

- [ ] **Укажите каталог или файл пользовательской политики для использования**	

```
checkov -d <директория> --external-checks-dir <директория>
```

- [ ] **Вывод результатов в формате JSON**	

```
checkov -d <директория> -o json
```

- [ ] **Вывод результатов в формате SARIF**	

```
checkov -d <каталог> -o sarif
```

- [ ] **Вывод результатов в формате JUnit XML**	

```
checkov -d <каталог> -o junitxml
```

- [ ] **Вывод результатов в формате GitHub Actions**	

```
checkov -d <каталог> -o github_failed_only
```

- [ ] **Включите режим verbose для более детального вывода**	

```
checkov -d <каталог> --verbose
```

- [ ] **Отображение только неудачных проверок**	

```
checkov -d <каталог> --quiet
```

- [ ] **Игнорировать проверки информационного уровня во время сканирования**	

```
checkov -d <каталог> --quiet --skip-check I
```

- [ ] **Обновить Checkov до последней версии**	

```
pip install --upgrade checkov
```



## kubescape



- [ ] **Сканирование кластера Kubernetes на наличие бенчмарков CIS**	

```
kubescape scan framework cis-1.5 cluster
```



- [ ] **Сканировать определенное пространство имен на наличие уязвимостей**	

```
kubescape scan framework nsa cluster --namespace <имя_пространства_имен>
```


- [ ] **Проведите пробное сканирование для проверки файлов манифеста Kubernetes**	

```
kubescape scan framework mitre attack --dry-run --output kubescape-results.json
```


- [ ] **Сканирование графика Helm на наличие проблем безопасности**	

```
kubescape scan framework kube-hunter chart --chart <путь_к_чарту>
```


- [ ] **Сканирование YAML-файла на соответствие пользовательским политикам**	

```
kubescape scan policy --file <path_to_yaml_file> --policies <path_to_custom_policies>
```



## PurplePanda


- [ ] **Укажите целевой IP-адрес или имя хоста**	

```
python3 purplepanda.py -t <target>
```

- [ ] **Укажите целевой порт**	

```
python3 purplepanda.py -t <target> -p <port>
```


- [ ] **Укажите конкретный NSE-скрипт**	

```
python3 purplepanda.py -t <target> -p <port> -s <nse_script>
```

- [ ] **Укажите количество одновременных потоков**	

```
python3 purplepanda.py -t <target> -p <port> -n <num_threads>
```


- [ ] **Укажите выходной каталог для результатов**	

```
python3 purplepanda.py -t <target> -p <port> -o <output_dir>
```

- [ ] **Включить трассировку скриптов для отладки**

```
python3 purplepanda.py -t <target> -p <port> --trace
```



## CDK


- [ ] **Инициализация нового проекта CDK**	

```
cdk init <имя_проекта>
```

- [ ] **Синтезируем приложение CDK в шаблон CloudFormation**	

```
cdk synth
```

- [ ] **Разверните приложение CDK в среду по умолчанию**	

```
cdk deploy
```

- [ ] **Бутстрап среды AWS для развертывания CDK**	

```
cdk bootstrap
```

- [ ] **Вызов определенной функции AWS Lambda в приложении CDK**	

```
cdk invoke <имя_функции>
```

- [ ] **Добавить зависимость в приложение CDK**	

```
cdk add <имя_зависимости>
```

- [ ] **Создайте IAM-роль с наименьшими привилегиями доступа**	

```
cdk deploy IAMRoleStack
```


- [ ] **Разверните экземпляр EC2 с безопасной конфигурацией**	

```
cdk deploy EC2Stack
```

- [ ] **Внедрение AWS CloudTrail для ведения журналов аудита**	

```
cdk deploy CloudTrailStack
```

- [ ] **Включите AWS Config для постоянного мониторинга соответствия**	

```
cdk deploy ConfigStack
```


- [ ] **Внедрите AWS Security Hub для централизованной проверки безопасности**	

```
cdk deploy SecurityHubStack
```



- [ ] **Настройте AWS GuardDuty для обнаружения угроз**	

```
cdk deploy GuardDutyStack
```


- [ ] **Включите VPC Flow Logs для анализа сетевого трафика**	

```
cdk deploy FlowLogsStack
```



- [ ] **Настройте AWS WAF для защиты веб-приложений**	

```
cdk deploy WAFStack
```



- [ ] **Разверните AWS Secrets Manager для безопасного хранения секретов**	

```
cdk deploy SecretsManagerStack
```



- [ ] **Внедрите службу управления ключами AWS (KMS) для шифрования**.	

```
cdk deploy KMSStack
```


- [ ] **Включите AWS Shield для защиты от DDoS-атак**	

```
cdk deploy ShieldStack
```

- [ ] **Создайте VPC с лучшими практиками безопасности**	

```
cdk deploy VPCStack
```


- [ ] **Создание групп безопасности для различных служб**	

```
cdk deploy SecurityGroupStack
```


- [ ] **Настройте строгие входящие и исходящие правила для групп безопасности**	

```
cdk deploy SecurityGroupRulesStack
```


## cs-suite


- [ ] **Запуск проверки уязвимостей на целевом URL**	

```
python3 cs-suite.py vulnscan --url <target_url>
```


- [ ] **Выполнить перечисление поддоменов**	

```
python3 cs-suite.py subdomain --url <target_domain>
```


- [ ] **Сканировать цель на наличие открытых портов**	

```
python3 cs-suite.py portscan --ip <целевой_ip>
```


- [ ] **Перечисление наборов шифров SSL/TLS, поддерживаемых целью**	

```
python3 cs-suite.py tlscipher --host <целевой_хост>
```


- [ ] **Запуск проверки на уязвимости по целевому URL**	

```
python3 cs-suite.py vulnscan --url <target_url>
```


- [ ] **Проведение теста на SQL-инъекции на целевом URL**	

```
python3 cs-suite.py sqlinject --url <target_url>
```


- [ ] **Проведите тест на межсайтовый скриптинг (XSS) на целевом URL**	

```
python3 cs-suite.py xss --url <target_url>
```


- [ ] **Проверка цели на наличие конфиденциальной информации с помощью шаблонов regex**	

```
python3 cs-suite.py sensitivescan --url <target_url>
```

- [ ] **Проведение теста на обход каталога по целевому URL**	

```
python3 cs-suite.py dirtraversal --url <target_url>
```

- [ ] **Выполнить атаку грубой силы на страницу входа в систему цели**	

```
python3 cs-suite.py brute --url <target_url> --username <username> --passwords <password_list>
```

- [ ] **Проверить цель на наличие небезопасных заголовков**	

```
python3 cs-suite.py insecureheaders --url <target_url>
```

- [ ] **Провести тест передачи зоны DNS на целевом домене**	

```
python3 cs-suite.py dnszone --domain <целевой_домен>
```


- [ ] **Проверка цели на наличие уязвимых HTTP-методов**	

```
python3 cs-suite.py httpmethods --url <target_url>
```


- [ ] **Выполните тест на неправильную конфигурацию CORS для целевого URL**	

```
python3 cs-suite.py cors --url <target_url>
```

- [ ] **Сканировать цель на наличие открытых ведер S3**	

```
python3 cs-suite.py s3scan --url <target_url>
```



## pacu


- [ ] **AWS разведка и перечисление**	

```
./pacu.py recon_enum
```




- [ ] **Повышение привилегий через метаданные экземпляров EC2**	

```
./pacu.py exploit_ec2_metadata
```




- [ ] **Перечисление ресурсов AWS и утечка данных**	

```
./pacu.py enumeration
```




- [ ] **Перечисление групп безопасности и открытых портов**	

```
./pacu.py enum_security_groups
```




- [ ] **Перечисление пользователей, групп и ролей IAM**	

```
./pacu.py enum_iam_users_roles_groups
```




- [ ] **Перечисление ведер S3 и их содержимого**	

```
./pacu.py enum_s3_buckets
```


- [ ] **Перечисление инстансов EC2 и их метаданных**	

```
./pacu.py enum_ec2_instances
```

- [ ] **Перечисление экземпляров RDS и их метаданных**	

```
./pacu.py enum_rds_instances
```

- [ ] **Перечисление репозиториев ECR и их образов**	

```
./pacu.py enum_ecr_repositories
```

- [ ] **Повышение привилегий через прикрепление IAM-роли к экземпляру EC2**	

```
./pacu.py escalate_iam_roles_to_ec2
```


- [ ] **Повышение привилегий через изменение IAM-профилей экземпляров EC2**	

```
./pacu.py escalate_iam_roles_to_iam_profiles
```


- [ ] **Повышение привилегий через изменение политик ведер S3**	

```
./pacu.py escalate_s3_bucket_policy
```


- [ ] **Повышение привилегий через изменение членства в группах IAM**	

```
./pacu.py escalate_iam_group_membership
```


- [ ] **Повышение привилегий через изменение разрешений пользователей IAM**	

```
./pacu.py escalate_iam_user_permissions
```


- [ ] **Повышение привилегий через изменение разрешений экземпляра RDS**	

```
./pacu.py escalate_rds_instance_permissions
```



- [ ] **Повышение привилегий через изменение прав доступа к репозиторию ECR**.	

```
./pacu.py escalate_ecr_repository_permissions
```


- [ ] **Повышение привилегий через изменение прав доступа к Лямбда-функциям**	

```
./pacu.py escalate_lambda_function_permissions
```


- [ ] **Повышение привилегий через изменение политик ключей KMS**	

```
./pacu.py escalate_kms_key_policy
```

