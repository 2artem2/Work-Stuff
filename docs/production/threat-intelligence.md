---
layout: default
title: Threat Intelligence
parent: Production
---

{: .no_toc }

## Оглавление
{: .no_toc .text-delta }

1. TOC
{:toc}

---


# Разведка угроз
{: .no_toc }

Анализ угроз - это процесс сбора и анализа информации о потенциальных и существующих угрозах кибербезопасности, таких как вредоносное ПО, фишинговые атаки и утечки данных. Цель анализа угроз - предоставить организациям действенные сведения, которые помогут им выявить и смягчить потенциальные риски безопасности до того, как они смогут причинить вред.

В контексте DevSecOps анализ угроз является важным компонентом комплексной стратегии безопасности. Собирая и анализируя информацию о потенциальных угрозах безопасности, организации могут лучше понять риски безопасности, с которыми они сталкиваются, и предпринять шаги по их снижению. Это может включать в себя внедрение средств контроля безопасности и контрмер, таких как брандмауэры, системы обнаружения вторжений и системы управления информацией и событиями безопасности (SIEM), для защиты от известных угроз.

Информация об угрозах также может быть использована для совершенствования других практик DevSecOps, таких как управление уязвимостями и реагирование на инциденты. Выявляя потенциальные уязвимости и угрозы в режиме реального времени, команды безопасности могут оперативно принимать меры по устранению проблем и предотвращению инцидентов безопасности.

К числу ключевых преимуществ анализа угроз в DevSecOps относятся:

1. Улучшенное обнаружение угроз: Анализ угроз предоставляет организациям информацию, необходимую для обнаружения потенциальных угроз безопасности до того, как они смогут причинить вред.

2. Более эффективное принятие решений: Предоставляя действенные сведения, анализ угроз помогает организациям принимать обоснованные решения о состоянии безопасности и реагировании на потенциальные угрозы.

3. Проактивное устранение угроз: Анализ угроз позволяет организациям применять упреждающий подход к снижению угроз, что позволяет им опережать возникающие угрозы и снижать риск быть скомпрометированными.

4. Улучшенное реагирование на инциденты: Анализ угроз может быть использован для повышения эффективности реагирования на инциденты, что позволяет организациям быстро и эффективно реагировать на инциденты безопасности и минимизировать их последствия.



## PCR


* **Приоритет:** Приоритет запроса на сбор информации (PCR) должен определяться с учетом множества факторов и информации. Рекомендуется устанавливать приоритет на основе сочетания нескольких критериев. Одним из важных факторов, который следует учитывать, является клиент, запрашивающий разведданные. Например, если запрос поступил от директора по информационной безопасности (CISO), он будет считаться более значимым по сравнению с запросом от старшего сетевого инженера. Кроме того, на приоритет может влиять конкретная отраслевая вертикаль, на которую ориентирован запрос. Например, если запрос поступает от CTI-аналитика, работающего в банке, менеджер по сбору данных, скорее всего, определит приоритеты сбора информации, исходя из общих угроз, с которыми сталкивается банковская отрасль. Приняв во внимание эти различные факторы, можно присвоить ПКР соответствующий уровень приоритета.



При определении приоритета сбора разведданных необходимо учитывать несколько ключевых факторов. К ним относятся требования заказчика, желаемый результат или итог сбора, временной интервал запроса и возможность выполнения запроса с помощью имеющихся систем сбора. Хотя универсального подхода к определению приоритетов не существует, эти соображения играют решающую роль в определении порядка выполнения запросов. В последующих главах тема приоритетов будет рассмотрена более подробно, особенно в связи с изучением конкретных потребностей организации и ее операций по сбору.






* ** Ключ:** Ключ служит отдельным идентификатором, который может использоваться в сочетании с другими системами для целей ссылки и отслеживания. Он может генерироваться автоматически, как первичный ключ, или сочетаться с уникальными идентификаторами для получения дополнительной информации о типе или приоритете коллекции. Изучив расширенный ключ, например PCR-001-P-BIN-FIN-P1, организация может легко определить характер и значимость коллекции.




![Operationalizing Threat Intelligence A guide to developing and operationalizing cyber threat intelligence programs](../../../assets/images/pcr.png)


## Жизненный цикл операций по сбору информации

Эффективный сбор разведданных требует тщательного планирования с учетом установленных приоритетов сбора, специальных запросов на информацию (RFI) и регулярного управления операциями по сбору. Правильное планирование обеспечивает сбор данных таким образом, чтобы они соответствовали потребностям организации в сборе разведданных.



![Operationalizing Threat Intelligence A guide to developing and operationalizing cyber threat intelligence programs](../../../assets/images/collection.png)


### Pперсонал

Чтобы удовлетворить потребности организации, важно определить приоритетные требования к сбору (PCR) и оценить, есть ли у организации подходящий персонал для их выполнения. Оценка персонала в данном контексте может быть разделена на три категории: технические навыки, владение языком и предметная область знаний (SME). Эти категории помогают менеджеру по сбору информации определить, обладает ли персонал необходимой квалификацией для эффективного сбора информации.




* Техническая дисциплина: Во многих случаях операции по сбору информации могут быть эффективно проведены при наличии соответствующих технических навыков, особенно в случае пассивных и гибридных операций по сбору информации. В этих типах операций для сбора информации в основном используются технические знания, а не активное взаимодействие с сообществами, имеющими проверенный доступ, или разработка источников путем прямого взаимодействия. Главная задача менеджера по сбору - убедиться, что персонал, назначенный на сбор, обладает необходимыми техническими навыками для получения нужных данных.


* Требования к языку: Знание языка может играть важную роль в операциях по сбору информации по нескольким причинам. Во-первых, если собираемая информация написана на определенном языке, наличие человека, способного читать и интерпретировать этот язык, необходимо для извлечения нужных деталей. Кроме того, знание языка становится необходимым при проведении сбора информации в сообществах с проверенным доступом, которые в основном общаются на определенном языке. Кроме того, эти навыки крайне важны при активном взаимодействии с источниками или попытках вербовки людей. Если сбор разведданных требует региональной направленности, то для эффективного проведения операций сотрудникам по сбору информации могут потребоваться носители языка с пониманием культурных и региональных особенностей.






* Область деятельности МСП: В дополнение к техническим и языковым навыкам руководитель сбора информации должен оценить, требуется ли коллекционеру обладать экспертными знаниями (SME) в конкретной области угроз. Обычно люди в индустрии CTI специализируются на таких областях, как программы-вымогатели, банковские трояны, угрозы со стороны национальных государств или современные постоянные угрозы (APT). Если сборщик обладает специальными знаниями в определенной области угроз, рекомендуется назначить его на операцию сбора, а не человека, имеющего лишь общие знания о данном типе угроз. Это гарантирует, что усилия по сбору принесут пользу благодаря глубокому пониманию и знаниям, предоставленным специалистом.





### Процесс

После того как менеджер по сбору информации определил подходящий персонал для операции по сбору, он должен совместно с группой по сбору информации разработать оперативный план. При этом необходимо учитывать несколько ключевых факторов, которые имеют решающее значение для успешного сбора разведданных. Эти факторы будут рассмотрены в следующих разделах.




* OPSEC: мы уже говорили о
Процесс обеспечения безопасности операций (OPSEC) имеет огромное значение и должен быть укоренен в культуре группы. Во время планирования операций менеджер по сбору должен обсудить процессы и процедуры OPSEC с группой по сбору. Это гарантирует, что команда понимает важность OPSEC и не позволит ей успокоиться или почувствовать себя слишком защищенной во время выполнения операции. Включение OPSEC в фазу планирования позволяет группе сохранять бдительность и уделять пристальное внимание защите конфиденциальной информации и поддержанию оперативной безопасности.



* Проанализируйте все текущие разведданные: Во время разработки плана операции руководителю и группе по сбору важно тщательно изучить все разведывательные данные, относящиеся к желаемой информации и ее источнику. Этот обзор дает ценную информацию о процессе сбора, конкретной обстановке, в которой будет проводиться сбор, а также подробности об источнике информации. Проведя этот обзор, команда по сбору данных получает более глубокое понимание требований к сбору и может эффективно адаптировать свой подход для обеспечения успешного сбора данных.



* Учитывайте разветвления или продолжения операций: При планировании операций по сбору очень важно учитывать историю предыдущих сборов данных из конкретного источника. Эта история может дать ценные сведения об операциях группы сбора и истории, которую она рассказывает. Например, она может выявить такие закономерности, как неоднократное использование определенных диапазонов IP-адресов или VPN, что может свидетельствовать об отслеживании пользовательской информации. В более сложных сценариях, таких как сбор информации на темных рынках или хакерских форумах, группа сбора должна тщательно оценить свою историю в этих местах. Они должны учитывать такие факторы, как существующие персоны, любые инциденты, которые могли скомпрометировать их личности, и возможность организации нескольких операций по сбору. Понимание истории сбора информации из источника очень важно для эффективного планирования операций.






### Инструменты и технологии

Обеспечив наличие подходящего персонала и проведя тщательное планирование, менеджер по сбору должен сосредоточиться на технологиях и инфраструктуре, необходимых для реализации операционного плана. Это включает в себя оценку необходимых инструментов и систем сбора. Под инструментами сбора понимается конкретное программное или аппаратное обеспечение, используемое для сбора разведданных, в то время как системы сбора включают в себя более широкую инфраструктуру, необходимую для обеспечения оперативной безопасности (OPSEC) и требований к сбору. Руководителю сбора необходимо оценить, имеет ли группа доступ к соответствующим технологиям и инфраструктуре для эффективного осуществления деятельности по сбору.








## Lockheed's Martin Cyber Kill Chain

![Lockheed's Martin Cyber Kill Chain](../../../assets/images/lock_kill.png)

### Разведка:

* Пример: Атакующий собирает информацию о целевой организации, используя общедоступные источники, социальные сети или другие методы разведки.

* Шпаргалка по командам и инструментам:
	* WHOIS lookup: `whois <target>`
	* DNS enumeration: `nslookup <target>`
	* Google dorking: `site:<target>`

### Оружие:

* Пример: Атакующий создает или получает вредоносную полезную нагрузку, например вредоносную программу или эксплойт, для доставки цели.

* Шпаргалка по командам и инструментам:
	* Metasploit Framework: `msfvenom -p <payload> -f <format> -o <output>`.
	* Veil-Evasion: `veil-evasion`.

### Доставка:

* Пример: Злоумышленник доставляет полезную нагрузку с помощью различных методов, таких как вложения в электронную почту, взломанные веб-сайты или социальная инженерия.

* Команды и инструменты "Шпаргалки":
	* Генерация фишинговых писем: GoPhish, SET
	* Хостинг вредоносных веб-сайтов: Apache, Nginx
	* Наборы эксплойтов: Blackhole, Angler

### Эксплуатация:

* Пример: Злоумышленник использует уязвимости в системе или приложениях объекта для получения несанкционированного доступа.

* Шпаргалки по командам и инструментам:
	* Фреймворки для эксплойтов: Metasploit, ExploitDB
	* Разработка эксплойтов: Python, Ruby, C/C++
	* Сканеры веб-приложений: Nessus, Nikto

### Установка:

* Пример: Злоумышленник устанавливает бэкдоры, средства удаленного доступа или другое вредоносное ПО для обеспечения устойчивости и сохранения контроля над взломанной системой.

* Команды и инструменты из шпаргалки:
	* Средства удаленного администрирования: Netcat, TeamViewer
	* Трояны удаленного доступа (RAT): DarkComet, Poison Ivy
	* Вредоносные программы без файлов: PowerShell, WMI

### Управление и контроль (C2):

* Пример: Злоумышленник устанавливает каналы связи со взломанной системой для удаленного контроля и управления атакой.

* Шпаргалка по командам и инструментам:
	* C2-фреймворки: Cobalt Strike, Metasploit.
	* Зашифрованная связь: TOR, SSL/TLS
	* Связь на основе DNS: Dnsmasq, Dnscat2

### Действия по целям:

* Пример: Атакующий достигает намеченных целей, которые могут включать кражу данных, повышение привилегий, дальнейшую компрометацию сети или нарушение работы служб.

* Команды и инструменты из шпаргалки:
	* Эксфильтрация данных: FTP, SCP, стеганография
	* Повышение привилегий: sudo, PowerSploit
	* Сетевое распространение: EternalBlue, WannaCry

### Боковое перемещение:

* Пример: Атакующий перемещается по сети в поисках дополнительных целей или систем для компрометации.

* Команды и инструменты из шпаргалки:
	* Сканирование сети: Nmap, Masscan
	* Кража учетных данных: Mimikatz, Responder
	* Pass-the-Hash: Psexec, PsExecWrapper




## Матрица угроз DevOps

![Microsoft DevOps Threat](../../../assets/images/microsoft_devops_threat.png)

Матрица угроз DevOps - это комплексная структура или ресурс, который определяет и классифицирует потенциальные угрозы безопасности и риски, связанные с внедрением практики DevOps. Ее цель - дать организациям представление о проблемах безопасности, с которыми они могут столкнуться при внедрении подхода DevOps, и предложить рекомендации по снижению этих рисков.

Упомянутый вами блог Microsoft Security Blog, вероятно, содержит подробную информацию об их матрице угроз DevOps. Она может охватывать различные категории угроз, такие как:

* Инсайдерские угрозы: Сюда входят потенциальные риски, возникающие из-за сотрудников или лиц с авторизованным доступом к системам, данным или инфраструктуре.

* Внешние атаки: Это угрозы, исходящие от внешних субъектов, таких как хакеры, которые пытаются использовать уязвимости в среде DevOps.

* Потеря и утечка данных: В эту категорию входят риски, связанные с несанкционированным раскрытием или потерей конфиденциальной информации в процессе работы DevOps.

* Атаки на цепочки поставок: Эти угрозы связаны с компрометацией цепочки поставок программного обеспечения, направленной на сторонние библиотеки, зависимости или процессы сборки.

* Уязвимости инфраструктуры: В данном случае речь идет о слабых местах в инфраструктурных компонентах среды DevOps, таких как неправильная конфигурация или небезопасные облачные сервисы.

* Соответствие нормативным требованиям и нормативные риски: Практика DevOps должна соответствовать отраслевым стандартам и нормативным требованиям. Несоблюдение этих требований может привести к юридическим и финансовым последствиям.

Матрица угроз DevOps, вероятно, предоставит организациям действенные рекомендации, лучшие практики и средства контроля безопасности, которые можно внедрить на различных этапах жизненного цикла DevOps. Сюда могут входить методы безопасного кодирования, непрерывный мониторинг, сканирование уязвимостей, контроль доступа и процедуры реагирования на инциденты.


### Первоначальный доступ

В контексте матрицы угроз DevOps "Первоначальный доступ" относится к категории угроз, которые сосредоточены на несанкционированных точках входа или механизмах, с помощью которых злоумышленник получает первоначальный доступ к системе или сети. Она предполагает использование уязвимостей или слабых мест в инфраструктуре, приложениях или процессах DevOps для создания плацдарма для дальнейшей вредоносной деятельности.


#### Аутентификация в SCM

![](../../../assets/images/scm.png)

Аутентификация SCM - это процесс проверки подлинности и доступа к системе управления исходным кодом (SCM) организации. Обычно для этого используются такие методы аутентификации, как персональные маркеры доступа (PAT), ключи SSH или другие разрешенные учетные данные. Однако злоумышленники могут попытаться использовать этот процесс аутентификации, получая несанкционированный доступ к SCM с помощью таких методов, как фишинговые атаки. Это может представлять значительную угрозу для исходного кода и конфиденциальной информации организации. Чтобы снизить этот риск, очень важно знать о возможных атаках и применять надежные меры безопасности.




#### Аутентификация сервисов CI/CD

![](../../../assets/images/cicd-initial.drawio.png)


Аутентификация сервисов CI/CD - это процесс аутентификации и доступа к сервису непрерывной интеграции/непрерывного развертывания (CI/CD), используемому организацией для автоматизации конвейеров доставки программного обеспечения. Злоумышленники могут попытаться использовать уязвимости в процессе аутентификации для получения несанкционированного доступа к сервису CI/CD, что может привести к потенциальному компромиссу в среде DevOps организации. Чтобы снизить этот риск, важно использовать надежные методы аутентификации и применять меры безопасности для защиты CI/CD-сервиса от несанкционированного доступа.





#### Публичные репозитории организации

![](../../../assets/images/github.drawio.png)


Доступ к публичным репозиториям организации с возможностями CI/CD может представлять угрозу безопасности, если он не защищен должным образом. Злоумышленники могут попытаться получить несанкционированный доступ к этим репозиториям и использовать их возможности CI/CD для выполнения вредоносного кода или нарушения работы конвейеров организации. Чтобы снизить этот риск, организациям следует внедрить строгий контроль доступа, отслеживать активность в репозиториях и обеспечивать безопасные конфигурации CI/CD.




#### Компрометация конечных точек


![](../../../assets/images/endpoint.drawio.png)


Компрометация конечной точки - это сценарий, при котором злоумышленник получает доступ к ресурсам организации, компрометируя рабочую станцию или конечное устройство разработчика. Если конечная точка скомпрометирована, злоумышленник может использовать скомпрометированную рабочую станцию для получения несанкционированного доступа к управлению исходным кодом (SCM), реестру или другим критическим ресурсам организации. Чтобы снизить этот риск, организациям следует внедрить надежные меры безопасности конечных точек и следовать лучшим практикам защиты рабочих станций разработчиков.





#### Настроенные вебхуки

![](../../../assets/images/webhook.drawio.png)


Настроенные веб-хуки могут стать потенциальным риском безопасности, если их не защитить должным образом. Злоумышленники могут использовать эти веб-хуки для получения первоначального доступа к сети организации. Запуская запросы через систему управления исходным кодом (SCM), злоумышленники могут получить несанкционированный доступ к службам, которые не должны быть открыты для публичного доступа или могут работать с устаревшими и уязвимыми версиями программного обеспечения в частной сети организации. Чтобы снизить этот риск, организациям следует внедрить безопасные конфигурации веб-хуков, отслеживать активность веб-хуков и применять необходимые средства контроля доступа.






### Исполнение


Тактика исполнения в матрице угроз DevOps относится к методам, используемым злоумышленниками для получения доступа к ресурсам пайплайна, включая сам пайплайн или ресурсы развертывания. Злоумышленники могут использовать уязвимости или применять различные техники для получения несанкционированного контроля над этими ресурсами. Понимание этих методов и применение соответствующих мер безопасности имеет решающее значение для снижения риска несанкционированного выполнения и сохранения целостности пайплайна DevOps.



#### Выполнение зараженного пайплайна (PPE)

![](../../../assets/images/ppe.png)


Заражённый пайплайн (Poisoned pipeline execution, PPE) - это техника, используемая злоумышленниками для внедрения вредоносного кода в репозиторий организации, что позволяет им выполнять несанкционированные действия в системе CI/CD репозитория. Эта техника представляет собой серьезную угрозу, поскольку может привести к выполнению вредоносного кода в процессе CI/CD, нарушая целостность пайплайна и потенциально позволяя получить дальнейший несанкционированный доступ. Понимание и снижение рисков, связанных с выполнением зараженных пайплайнов, очень важно для поддержания безопасности системы CI/CD.





##### Прямое выполнение загрязненного пайплайна (d-PPE)


Прямое выполнение отравленного пайплайна (d-PPE) - это техника, используемая злоумышленниками для прямого изменения конфигурационного файла в хранилище. Внедрив вредоносные команды в файл конфигурации, злоумышленник может выполнить их во время работы пайплайна, что может привести к нарушению целостности пайплайна и связанных с ним ресурсов. Снижение риска d-PPE требует внедрения безопасных методов, обеспечения строгого контроля доступа и тщательной проверки конфигурационных файлов.





##### Косвенное выполнение конвейера (i-PPE)


Косвенное выполнение зараженного пайплайна (i-PPE) - это техника, используемая злоумышленниками, когда они не могут напрямую изменять конфигурационные файлы или когда эти изменения не учитываются при выполнении пайплайна. В таких случаях злоумышленники нацеливаются на скрипты, используемые пайплайном, такие как make-файлы, тестовые скрипты, скрипты сборки или другие подобные файлы, чтобы внедрить в них вредоносный код. Заразив эти скрипты, злоумышленник может выполнить несанкционированный код во время работы пайплайна, что может привести к компрометации пайплайна и связанных с ним ресурсов. Чтобы снизить риск i-PPE, важно внедрять безопасные методы, проводить тщательный анализ кода и обеспечивать целостность сценариев пайплайнов.




##### Публичный PPE


Публичное выполнение зараженного пайплайна (Public PPE) относится к сценариям, в которых пайплайн запускается проектом с открытым исходным кодом. В таких случаях злоумышленники могут эксплуатировать пайплайн, применяя такие техники, как прямое выполнение зараженного пайплайна (d-PPE) или косвенное выполнение зараженного пайплайна (i-PPE) в публичном репозитории. Заразив пайплайн в проекте с открытым исходным кодом, злоумышленник может выполнить несанкционированный код во время работы пайплайна, что может нарушить целостность пайплайна и ресурсов, с которыми он взаимодействует. Чтобы снизить риск публичного PPE, необходимо внедрять безопасные методы, проводить тщательный анализ кода и контролировать выполнение пайплайна.





#### Вскрытие зависимостей

![](../../../assets/images/dependency.drawio.png)


Подделка зависимостей - это техника, используемая злоумышленниками для выполнения вредоносного кода в DevOps или производственной среде путем внедрения вредоносного кода в зависимости репозитория. Когда эти зависимости загружаются и интегрируются в систему, вредоносный код начинает выполняться, что может привести к несанкционированному доступу или нарушению целостности среды. Для предотвращения и снижения риска подделки зависимостей необходимо применять безопасные методы, регулярно проводить аудит зависимостей и обеспечивать их целостность.






##### Публичная путаница зависимостей

Публичная путаница зависимостей - это техника, используемая злоумышленниками, когда они публикуют в публичных реестрах вредоносные пакеты с теми же именами, что и частные пакеты. Когда механизмы контроля пакетов ищут пакеты, они часто отдают приоритет публичным реестрам, что позволяет загрузить вредоносный пакет вместо предполагаемого частного пакета. Эта техника может привести к выполнению вредоносного кода в среде DevOps или в производственной среде. Для предотвращения и снижения риска путаницы публичных зависимостей необходимо применять безопасные методы, проверять источники пакетов и отдавать предпочтение доверенным реестрам.




##### Перехват публичных пакетов ("repo-jacking").

Перехват публичного пакета, также известный как "repo-jacking", подразумевает получение злоумышленниками контроля над публичным пакетом путем компрометации учетной записи сопровождающего. Эта техника может применяться, когда злоумышленники используют уязвимости или слабые места в учетных записях сопровождающих пакетов, например, при использовании функции переименования пользователей на GitHub. Получив контроль над пакетом, злоумышленники могут изменить его код, внедрить вредоносный код или перенаправить пользователей на вредоносные ресурсы. Для снижения риска захвата публичных пакетов необходимо применять меры безопасности, регулярно контролировать репозитории пакетов и обеспечивать целостность учетных записей сопровождающих.




##### Typosquatting

Typosquatting - это техника, используемая злоумышленниками, когда они публикуют вредоносные пакеты с именами, похожими на известные публичные пакеты. Создавая такие обманчивые имена пакетов, злоумышленники стремятся ввести пользователей в заблуждение, чтобы они случайно загрузили вредоносные пакеты вместо тех, которые были предназначены для них. Эта техника может привести к выполнению несанкционированного или вредоносного кода в среде DevOps или производственной среде. Для предотвращения и снижения риска опечаток необходимо применять безопасные методы, проверять источники пакетов и информировать пользователей о потенциальных рисках.





#### Компрометация ресурсов DevOps

![](../../../assets/images/resources.drawio.png)



Компрометация ресурсов DevOps относится к сценариям, в которых злоумышленники атакуют вычислительные ресурсы, используемые для выполнения CI/CD-агентов и другого программного обеспечения в рамках пайплайна. Используя уязвимости в операционной системе, коде агентов или другом программном обеспечении, установленном на виртуальных машинах (ВМ) или сетевых устройствах, злоумышленники могут получить несанкционированный доступ к пайплайну. Такая компрометация может привести к выполнению несанкционированного кода, краже данных или нарушению процесса CI/CD. Чтобы снизить риск компрометации ресурсов DevOps, крайне важно применять меры безопасности, регулярно обновлять и исправлять программное обеспечение, а также отслеживать инфраструктуру на предмет подозрительной активности.





#### Управление общим реестром

![](../../../assets/images/registry.drawio.png)



Под контролем общего реестра понимается ситуация, когда злоумышленник получает контроль над реестром, используемым организацией, что позволяет ему внедрять и исполнять вредоносные образы или пакеты в CI/CD пайплайне или производственной среде. Такая компрометация может привести к выполнению несанкционированного или вредоносного кода, утечке данных или нарушению процесса CI/CD. Защита от контроля над общим реестром требует применения надежных мер безопасности, контроля доступа к реестру и мониторинга любых подозрительных или несанкционированных действий.







### Настойчивость

Тактика стойкости в контексте матрицы угроз DevOps относится к методам, используемым злоумышленниками для сохранения доступа к среде жертвы даже после первоначальной компрометации. Эти методы позволяют злоумышленникам сохранять контроль и доступ к взломанным системам, что потенциально может привести к дальнейшим несанкционированным действиям, утечке данных или нарушению работы системы. Для снижения риска постоянных атак необходимо внедрять надежные методы обеспечения безопасности, проводить регулярный аудит систем и оперативно устранять любые выявленные уязвимости или несанкционированный доступ.




#### Изменения в хранилище

![](../../../assets/images/per-reg.drawio.png)


Изменения в репозитории - это техника, при которой злоумышленники используют автоматические токены в пайплайне CI/CD для доступа и отправки изменений кода в репозиторий. Используя эти токены, которые часто обладают достаточными правами, злоумышленники могут добиться постоянства в среде. Такое постоянство может привести к несанкционированным изменениям кода, утечке данных или дальнейшей эксплуатации систем организации. Предотвращение и снижение риска изменений в хранилище требует внедрения безопасных методов, контроля доступа к токенам и мониторинга деятельности хранилища на предмет любых подозрительных или несанкционированных изменений.

* Изменение/добавление скриптов в код - мы можем изменить некоторые скрипты инициализации/добавить новые скрипты, чтобы они загружали бэкдор/стартер для злоумышленника, и каждый раз, когда пайплайн будет выполнять эти скрипты, будет выполняться и код злоумышленника.

* Изменение конфигурации пайплайна - мы можем добавить новые шаги в пайплайн, чтобы загрузить контролируемый злоумышленником скрипт в пайплайн перед продолжением процесса сборки.

* Изменить конфигурацию расположения зависимостей - использовать контролируемые злоумышленником пакеты.


##### Inject в артефактах

![](../../../assets/images/per-arti.drawio.png)


Внедрение кода в артефакты предполагает использование функциональности сред непрерывной интеграции (CI), которые позволяют создавать и обмениваться артефактами между выполнениями пайплайнов. Злоумышленники могут манипулировать этими артефактами для внедрения вредоносного кода или файлов, что может привести к несанкционированному выполнению кода или компрометации пайплайна CI/CD. Для предотвращения и снижения риска внедрения артефактов необходимо применять меры безопасности, проверять артефакты и отслеживать любые подозрительные или несанкционированные изменения.






##### Изменение изображений в реестре

![](../../../assets/images/per-img.drawio.png)



Под модификацией изображений в реестре понимается техника, при которой злоумышленник получает доступ к реестру изображений, используемому пайплайнами CI/CD, и манипулирует изображениями, хранящимися в реестре. Изменяя или подбрасывая вредоносные образы, злоумышленник может обеспечить их выполнение пользовательскими контейнерами, что приведет к выполнению несанкционированного или вредоносного кода в производственной среде. Для предотвращения и снижения риска модификации образов в реестре необходимо применять строгие меры безопасности, контролировать доступ к реестру и отслеживать любые несанкционированные изменения.





##### Создание учетных данных службы

![](../../../assets/images/per-service.drawio.png)


Создание учетных данных служб в контексте DevOps означает процесс создания и управления учетными данными аутентификации для служб или приложений, используемых в рамках пайплайна или инфраструктуры CI/CD. Учетные данные служб обеспечивают безопасный доступ к различным ресурсам, таким как облачные платформы, базы данных или внешние API, и помогают установить доверие и авторизацию между различными компонентами среды DevOps. Правильное управление учетными данными служб имеет решающее значение для поддержания безопасности и целостности пайплайна DevOps и обеспечения авторизованного доступа к важным ресурсам.






### Эскалация привилегий

Методы повышения привилегий в контексте DevOps относятся к методам, используемым злоумышленником для повышения своих привилегий в среде жертвы. Получив более высокие привилегии, злоумышленник может получить доступ к более важным ресурсам, манипулировать конфигурациями и потенциально скомпрометировать всю инфраструктуру DevOps. Понимание и снижение рисков, связанных с повышением привилегий, очень важно для обеспечения безопасности и целостности среды DevOps.




#### Секреты в частных репозиториях

![](../../../assets/images/priv-pro.drawio.png)


Наличие секретов в частных репозиториях представляет собой значительный риск безопасности в среде DevOps. Злоумышленники, получившие первоначальный доступ, могут использовать его для сканирования частных репозиториев в поисках скрытых секретов. Частные репозитории обычно считаются более безопасными, так как они недоступны извне организации. Однако если конфиденциальная информация, такая как API-ключи, пароли или криптографические ключи, по ошибке будет зафиксирована или сохранена в этих хранилищах, она может стать доступной для неавторизованных лиц. Обнаружение и устранение последствий наличия секретов в частных хранилищах очень важно для сохранения конфиденциальности и целостности активов организации.





##### Зафиксировать/переместить в защищенные ветки

![](../../../assets/images/priv-key.drawio.png)

Коммит или проталкивание кода в защищенные ветки репозитория может представлять собой значительный риск безопасности в среде DevOps. Если у пайплайна есть доступ к репозиторию, а контроль доступа к нему является разрешительным, это может позволить злоумышленнику обойти обычные процессы проверки и утверждения кода и внедрить вредоносный код непосредственно в важные ветки без вмешательства команды разработчиков. Это может привести к несанкционированному выполнению кода, нарушив целостность и безопасность приложения или системы. Для снижения риска несанкционированного изменения кода в защищенных ветках очень важно внедрить надлежащие средства контроля доступа и процессы проверки.






##### Сертификаты и идентификаторы из служб метаданных

![](../../../assets/images/priv-cert.drawio.png)



В облачных пайплайнах злоумышленники могут использовать уже имеющийся у них доступ к среде для получения несанкционированного доступа к сертификатам и идентификаторам, хранящимся в службах метаданных. Эти сервисы, часто предоставляемые облачными платформами, хранят конфиденциальную информацию, такую как сертификаты, маркеры аутентификации и данные, связанные с идентификацией. Извлечение такой информации позволяет злоумышленнику воспользоваться привилегиями, связанными с этими сертификатами или идентификаторами, что может поставить под угрозу безопасность и конфиденциальность среды DevOps. Защита и обеспечение безопасности сертификатов и идентификационных данных из служб метаданных имеет решающее значение для предотвращения несанкционированного доступа и поддержания целостности системы.






### Доступ к учетным данным



Под методами доступа к учетным данным понимаются способы, используемые злоумышленниками для кражи учетных данных в среде DevOps. Получив действительные учетные данные, злоумышленники могут получить несанкционированный доступ к критическим системам, сервисам или ресурсам. Очень важно защищать учетные данные и применять меры по предотвращению их несанкционированного доступа или кражи. Понимание и снижение рисков доступа к учетным данным необходимо для поддержания безопасности и целостности среды DevOps.




#### Учетные данные пользователя

![](../../../assets/images/cred-key.drawio.png)


Учетные данные пользователя часто требуются в пайплайнах CI для доступа к внешним сервисам, таким как базы данных, API или другие ресурсы. Однако, если эти учетные данные не защищены должным образом, они могут стать мишенью для злоумышленников. Они могут попытаться получить доступ к пайплайну и извлечь учетные данные, чтобы получить несанкционированный доступ к внешним службам. Защита учетных данных пользователей имеет решающее значение для предотвращения несанкционированного доступа и поддержания безопасности среды DevOps.





##### Учетные данные служб

![](../../../assets/images/cred-serv.drawio.png)

Учетные данные служб, такие как имена руководителей служб (SPN) и маркеры подписи общего доступа (SAS), широко используются в средах DevOps для аутентификации и авторизации доступа к различным службам и ресурсам. Однако если эти учетные данные скомпрометированы, злоумышленник может получить несанкционированный доступ к другим службам непосредственно из пайплайна. Защита учетных данных служб необходима для предотвращения несанкционированного доступа и поддержания безопасности среды DevOps.








### Боковое перемещение


Тактика латерального перемещения в средах CI/CD относится к методам, используемым злоумышленниками для перемещения через различные ресурсы в рамках пайплайна DevOps. Злоумышленники стремятся получить доступ к ресурсам развертывания, артефактам сборки, реестрам и другим целям, чтобы расширить сферу своего влияния и осуществить вредоносные действия. Обнаружение и предотвращение боковых перемещений имеет решающее значение для поддержания безопасности и целостности среды CI/CD.




#### Артефакты компромиссной сборки

![](../../../assets/images/arti.drawio.png)

Компрометация артефактов сборки - это атака на цепочку поставок, в ходе которой злоумышленник получает контроль над пайплайнами CI и манипулирует артефактами сборки. Внедрив вредоносный код в строительные материалы до завершения процесса сборки, злоумышленник может внедрить вредоносную функциональность в конечные артефакты сборки. Защита артефактов сборки необходима для предотвращения развертывания скомпрометированного или вредоносного программного обеспечения.





##### Инъекция в реестр

![](../../../assets/images/regi.drawio.png)

Инъекция в реестр - это техника, при которой злоумышленник заражает реестр, используемый для хранения артефактов сборки в CI/CD пайплайне. Внедряя вредоносные образы в реестр, злоумышленник добивается того, что эти образы загружаются и выполняются контейнерами, которые полагаются на зараженный реестр. Предотвращение инъекций в реестр очень важно для обеспечения целостности и безопасности артефактов сборки, используемых в процессе CI/CD.






##### Распространение на ресурсы развертывания

![](../../../assets/images/depi.drawio.png)

Распространение на ресурсы развертывания относится к сценарию, в котором злоумышленник получает доступ к ресурсам развертывания в рамках CI/CD-пайплайна. Используя предоставленный доступ к пайплайну, злоумышленник может распространить свое присутствие на среду развертывания, что может привести к выполнению кода, утечке данных и другим вредоносным действиям. Предотвращение распространения атак на ресурсы развертывания имеет решающее значение для поддержания безопасности и целостности среды развертывания.






### Уклонение от защиты

Методы уклонения от защиты используются злоумышленниками для обхода или уклонения от мер безопасности и защиты, реализованных в среде DevOps. Обходя механизмы обнаружения и смягчения последствий, злоумышленники могут продолжать свои атаки незамеченными и сохранять устойчивость в среде. Понимание и смягчение последствий этих методов уклонения крайне важно для обеспечения безопасности и устойчивости среды DevOps.




#### Манипуляции с журналами служб

![](../../../assets/images/monitoring.drawio.png)

Манипулирование журналами служб - это техника, при которой злоумышленник, получивший доступ к среде, изменяет журналы, генерируемые различными службами. Внося изменения в журналы, злоумышленник стремится скрыть свою деятельность и помешать защитникам обнаружить его присутствие или идентифицировать выполненные им атаки. Обнаружение и предотвращение манипуляций с журналами служб имеет решающее значение для сохранения целостности и надежности данных журналов для анализа безопасности.





##### Манипуляции с компиляцией

![](../../../assets/images/change.drawio.png)

Манипулирование компиляцией - это техника, используемая злоумышленниками для внедрения вредоносного кода в процесс компиляции, что может привести к включению бэкдоров или уязвимостей в конечную сборку программного обеспечения. Вмешиваясь в процесс компиляции, злоумышленник стремится избежать обнаружения и внедрить вредоносную функциональность в программное обеспечение, не оставляя очевидных следов в исходном коде или системе контроля версий.







##### Перенастройка защиты ветвей

![](../../../assets/images/unprotected.drawio.png)


Переконфигурирование защиты ветвей - это техника, при которой злоумышленник с административными правами изменяет параметры конфигурации инструментов защиты ветвей. Изменяя эти настройки, злоумышленник может обойти контроль и внедрить код в ветку без вмешательства или одобрения пользователя. Это может позволить злоумышленнику внедрить вредоносный код в кодовую базу и потенциально нарушить целостность репозитория.






### Воздействие

Тактика воздействия относится к методам, используемым злоумышленниками для использования доступа к ресурсам CI/CD в злонамеренных целях. В отличие от других тактик, эти методы не предназначены для скрытного использования, а скорее для нанесения немедленного и заметного ущерба или нарушения работы CI/CD пайплайнов и ресурсов организации. Эти методы могут оказать значительное влияние на доступность, целостность и конфиденциальность процессов разработки и развертывания программного обеспечения.




#### DDoS

![](../../../assets/images/dos.drawio.png)

DDoS (Distributed Denial of Service) - это тип атаки, при которой противник переполняет целевую систему или сеть потоком трафика из нескольких источников, вызывая перебои в работе сервисов или отказы в обслуживании. В среде CI/CD злоумышленник, имеющий доступ к вычислительным ресурсам, может использовать их для проведения DDoS-атак на внешние цели.




##### Майнинг криптовалюты

![](../../../assets/images/crypto.drawio.png)


Майнинг криптовалюты - это процесс использования вычислительных ресурсов для решения сложных математических задач и получения криптовалютных вознаграждений. Во взломанной среде CI/CD злоумышленник может использовать вычислительные ресурсы для несанкционированного майнинга криптовалюты, потребляя системные ресурсы и потенциально вызывая снижение производительности.


##### Локальный DoS

![](../../../assets/images/localdos.drawio.png)


Локальные атаки типа "отказ в обслуживании" (DoS) осуществляются злоумышленником, получившим доступ к пайплайнам CI. Злоумышленник использует пайплайны для проведения DoS-атак на собственную инфраструктуру или сервисы организации, вызывая сбои в работе или перегружая виртуальные машины (ВМ), используемые в среде CI/CD.




##### Удаление ресурсов

![](../../../assets/images/res-del.drawio.png)


Удаление ресурсов - это техника, используемая злоумышленниками, получившими доступ к CI/CD-ресурсам, чтобы вызвать отказ в обслуживании путем безвозвратного удаления критически важных ресурсов, таких как облачные ресурсы или репозитории. Удаляя эти ресурсы, злоумышленник нарушает работу организации и препятствует нормальному функционированию среды CI/CD.










### Эксфильтрация

Тактика эксфильтрации включает в себя различные приемы, используемые злоумышленниками для извлечения конфиденциальных данных из среды жертвы в контексте CI/CD. Эти методы направлены на обход средств контроля безопасности и передачу данных за пределы сети или инфраструктуры организации.




#### Клонирование частных репозиториев

![](../../../assets/images/ex-pro.drawio.png)


В этом сценарии злоумышленник использует свой доступ к пайплайнам CI для клонирования частных репозиториев, что дает ему доступ к конфиденциальному коду и потенциально ценной интеллектуальной собственности. Они используют разрешения и токены, доступные в среде CI, например GITHUB_TOKEN в GitHub, для клонирования частных репозиториев.




##### Журналы пайплайна

![](../../../assets/images/ex-pip.drawio.png)



В этом сценарии злоумышленник использует свой доступ к CI/CD-конвейерам, чтобы получить доступ и просмотреть журналы выполнения пайплайнов. Эти журналы часто содержат ценную информацию о процессе сборки, детали развертывания и потенциально конфиденциальные данные, такие как учетные данные служб и учетных записей пользователей.




##### Утечка данных с производственных ресурсов.

![](../../../assets/images/ex-res.drawio.png)


В этом сценарии злоумышленник использует свой доступ к пайплайнам CI/CD, которые также имеют доступ к производственным ресурсам. Это позволяет злоумышленнику вынести конфиденциальные данные из производственной среды, используя пайплайн в качестве средства транспортировки.



## Матрица угроз Kubernetes

![Microsoft Kubernetes Threat Threat](../../../assets/images/k8s-matrix.png)


Матрица угроз описывает различные методы атак, включая как известные, так и гипотетические сценарии, которые могут быть использованы противниками в средах Kubernetes. Эти методы подразделяются на различные стадии жизненного цикла атаки, такие как первоначальный доступ, повышение привилегий, латеральное перемещение, сохранение и эксфильтрация.





### Первоначальный доступ

По мере того как организации внедряют контейнерные среды, такие как Kubernetes, становится важно понимать потенциальные уязвимости и векторы атак, которые могут использовать противники. Тактика первоначального доступа представляет собой значительную угрозу, являясь точкой входа неавторизованных субъектов в кластеры Kubernetes. В этой статье мы рассмотрим некоторые распространенные техники, используемые для получения первоначального доступа, и обсудим проактивные меры по защите среды Kubernetes.



#### Использование облачных учетных данных


В облачных развертываниях Kubernetes компрометация облачных учетных данных может привести к катастрофе. Злоумышленники, получившие доступ к учетным данным облака, могут проникнуть на уровень управления кластером, что может привести к полному захвату кластера. Для защиты от несанкционированного доступа к учетным данным облака крайне важно применять надежные методы обеспечения безопасности, такие как строгий контроль доступа и многофакторная аутентификация.



#### Скомпрометированные образы в реестре



Запуск скомпрометированных образов контейнеров в кластере может привести к значительным рискам. Злоумышленники, имеющие доступ к частному реестру, могут внедрить свои собственные скомпрометированные образы, которые затем могут быть непреднамеренно извлечены пользователями. Кроме того, использование ненадежных образов из общедоступных реестров без надлежащей проверки может подвергнуть кластер опасности заражения вредоносным содержимым. Использование сканирования образов и проверка достоверности образов контейнеров помогут снизить этот риск.




#### Файл Kubeconfig



Файл kubeconfig, содержащий сведения о кластере и учетные данные, используется клиентами Kubernetes, такими как kubectl. Если злоумышленник получит доступ к этому файлу, он может использовать его для получения несанкционированного доступа к кластерам Kubernetes. Защита файла kubeconfig через безопасные каналы распространения, обеспечение контроля доступа и использование безопасных клиентских сред - вот основные шаги по снижению этого риска.




#### Уязвимое приложение



Запуск уязвимого приложения в кластере может открыть дверь для первоначального доступа. Эксплуатация уязвимостей удаленного выполнения кода в контейнерах может позволить злоумышленникам выполнить произвольный код. Если к скомпрометированному контейнеру подключена учетная запись службы, злоумышленник может использовать ее учетные данные для отправки запросов к серверу Kubernetes API. Регулярное исправление и обновление образов контейнеров, а также сильная сегментация сети являются решающими факторами для снижения этого риска.





#### Открытая приборная панель



Приборная панель Kubernetes, открытая извне без надлежащей аутентификации и контроля доступа, становится потенциальной точкой входа для несанкционированного доступа. Злоумышленники могут использовать открытую приборную панель для получения возможности удаленного управления кластером. Необходимо ограничить доступ к приборной панели, включить аутентификацию и обеспечить доступ к ней только через безопасные соединения.




### Выполнение

После того как злоумышленники получают первоначальный доступ к кластеру Kubernetes, их следующим приоритетом становится тактика выполнения. Используя различные техники, злоумышленники пытаются запустить свой вредоносный код в кластере, что может привести к масштабным разрушениям. В этой статье мы рассмотрим распространенные техники выполнения в Kubernetes и обсудим ключевые стратегии по снижению связанных с ними рисков.




#### Exec в контейнере:



Злоумышленники с достаточными правами могут использовать команду "exec" ("kubectl exec") для запуска вредоносных команд внутри контейнеров в кластере. Используя легитимные образы, например образы популярных ОС, в качестве контейнера с бэкдором, злоумышленники могут удаленно выполнять свой вредоносный код через "kubectl exec". Ограничение разрешений и строгий контроль доступа помогут предотвратить несанкционированное выполнение внутри контейнеров.



#### Новый контейнер:




Злоумышленники с правами на развертывание стручков или контроллеров, таких как DaemonSets, ReplicaSets или Deployments, могут попытаться создать новые ресурсы в кластере для выполнения своего кода. Очень важно регулярно проводить аудит и проверку контроля доступа, чтобы убедиться, что только уполномоченные лица могут создавать и развертывать контейнеры. Мониторинг создания новых ресурсов и реализация принципов наименьших привилегий ограничат несанкционированное выполнение кода.





#### Эксплойт приложений:




Эксплуатация уязвимостей в приложениях, развернутых в кластере, дает злоумышленникам возможность выполнить свой код. Могут быть использованы уязвимости, позволяющие удаленно выполнять код или предоставляющие несанкционированный доступ к ресурсам. Прикрепление учетных записей служб к контейнерам, которое используется по умолчанию в Kubernetes, может дать злоумышленникам возможность отправлять запросы на сервер API, используя скомпрометированные учетные данные учетных записей служб. Регулярное исправление и управление уязвимостями играют решающую роль в снижении этого риска.





#### SSH-сервер, запущенный внутри контейнера:




В некоторых случаях злоумышленники могут обнаружить контейнеры, в которых запущены SSH-серверы. Если злоумышленники получат действительные учетные данные путем перебора или фишинга, они смогут использовать эти SSH-серверы для получения удаленного доступа к контейнеру. Чтобы снизить этот риск, необходимо использовать надежные механизмы аутентификации, применять безопасные методы управления учетными данными и регулярно проверять контейнеры на наличие неавторизованных SSH-серверов.





### Стойкость

В контексте безопасности Kubernetes под стойкостью понимаются методы, используемые злоумышленниками для сохранения доступа к кластеру даже после того, как их первоначальная точка входа была скомпрометирована. Понимая и устраняя тактику сохранения, используемую противниками, организации могут укрепить свою безопасность и защитить свои среды Kubernetes. В этой статье мы рассмотрим распространенные техники персистентности в Kubernetes и обсудим стратегии по снижению этих рисков.





#### Контейнер с бэкдором:




Один из методов, используемых злоумышленниками для обеспечения постоянства, - запуск вредоносного кода внутри контейнера в кластере. Используя такие контроллеры Kubernetes, как DaemonSets или Deployments, злоумышленники могут обеспечить постоянный запуск определенного количества контейнеров на одном или нескольких узлах кластера. Чтобы противостоять этому, регулярный мониторинг конфигураций контроллеров и тщательный аудит образов контейнеров помогут обнаружить и удалить несанкционированные контейнеры-бэкдоры.





#### Монтирование тома hostPath с возможностью записи:





Том hostPath позволяет монтировать каталог или файл с хоста в контейнер. Злоумышленники с правами на создание контейнеров в кластере могут использовать эту возможность, создавая контейнер с томом hostPath, доступным для записи. Таким образом, они получают постоянную информацию о базовом хосте и потенциальные возможности для несанкционированного доступа. Выявить и снизить этот риск поможет внедрение строгих средств контроля доступа и регулярный аудит конфигураций контейнеров.






#### Kubernetes CronJob:





Kubernetes CronJob - это механизм планирования, используемый для запуска заданий через определенные промежутки времени. Злоумышленники могут использовать функциональность Kubernetes CronJob для планирования выполнения вредоносного кода в качестве контейнера в кластере. Это позволяет им поддерживать постоянство, регулярно запуская свой код. Мониторинг и проверка конфигураций CronJob, а также периодическое сканирование уязвимостей играют важную роль в выявлении и устранении любых неавторизованных или подозрительных CronJob.





### Повышение привилегий


Повышение привилегий - это критическая тактика, используемая злоумышленниками для получения более высоких привилегий в среде Kubernetes. Получив повышенный доступ, злоумышленники могут скомпрометировать весь кластер, нарушить работу облачных ресурсов и прервать критически важные операции. Понимание распространенных методов повышения привилегий очень важно для реализации эффективных мер безопасности. В этой статье мы рассмотрим распространенные методы повышения привилегий в Kubernetes и обсудим стратегии по снижению этих рисков.






#### Привилегированный контейнер


Привилегированный контейнер обладает всеми возможностями хост-машины, позволяя выполнять неограниченные действия в кластере. Злоумышленники, получившие доступ к привилегированному контейнеру или имеющие права на его создание, могут использовать ресурсы хоста. Необходимо применять строгие политики безопасности контейнеров, ограничивать создание привилегированных контейнеров и регулярно отслеживать несанкционированный доступ или изменения конфигурации.






#### Привязка кластерного администратора


Контроль доступа на основе ролей (RBAC) - это фундаментальная функция безопасности в Kubernetes, контролирующая действия различных идентификаторов в кластере. Cluster-admin - это встроенная высокопривилегированная роль в Kubernetes. Злоумышленники с правами на создание привязок и кластерных привязок могут создать привязку к кластерной роли Cluster-admin или другим высокопривилегированным ролям. Реализация принципов наименьших привилегий, регулярный пересмотр конфигураций RBAC и частые аудиты крайне важны для предотвращения несанкционированной эскалации привилегий.




#### hostPath mount


Злоумышленники могут использовать монтирование тома hostPath для получения доступа к базовому хосту, выходя из изолированной среды контейнера. Это позволяет им повысить привилегии от контейнера к хосту. Для снижения этого риска необходимо внедрить строгий контроль доступа, регулярно проводить сканирование уязвимостей и отслеживать подозрительные конфигурации монтирования hostPath.





#### Доступ к облачным ресурсам:



В облачных развертываниях Kubernetes злоумышленники могут использовать свой доступ к одному контейнеру для получения несанкционированного доступа к другим облачным ресурсам вне кластера. Например, в Azure Kubernetes Service (AKS) каждый узел содержит учетную запись service principal, используемую для управления ресурсами Azure. Злоумышленники, получившие доступ к этому файлу учетных данных, могут использовать его для доступа к облачным ресурсам или их изменения. Строгое управление доступом к учетным данным принципала службы, шифрование конфиденциальных файлов и регулярная ротация учетных данных - важнейшие меры по снижению риска.







### Уклонение от защиты


Методы уклонения от защиты используются злоумышленниками для обхода обнаружения и сокрытия своих действий в среде Kubernetes. Активно обходя меры безопасности, злоумышленники могут продлить свое присутствие, повысить вероятность успешных атак и обойти традиционные средства контроля безопасности. Понимание распространенных методов уклонения от защиты очень важно для организаций, чтобы расширить возможности обнаружения угроз и укрепить общую безопасность Kubernetes. В этой статье мы рассмотрим распространенные тактики уклонения от защиты и обсудим стратегии эффективного снижения этих рисков.




#### Очистка журналов контейнера:


Злоумышленники могут попытаться удалить журналы приложений или операционных систем во взломанных контейнерах, чтобы скрыть свою вредоносную деятельность. Организациям следует внедрить надежные методы управления журналами, включая централизацию журналов и создание безопасных механизмов резервного копирования. Регулярный мониторинг журналов на предмет подозрительной активности и внедрение средств контроля доступа для предотвращения несанкционированного изменения журналов жизненно важны для поддержания видимости деятельности контейнеров.




#### Удаление событий Kubernetes:


События Kubernetes играют важную роль в регистрации изменений состояния и сбоев в кластере. Злоумышленники могут попытаться удалить события Kubernetes, чтобы избежать обнаружения своих действий. Организациям следует обеспечить надлежащую регистрацию событий и внедрить проверку целостности журналов, чтобы обнаружить любую фальсификацию или удаление событий. Сохранение журналов в безопасном и неизменяемом виде может помочь в выявлении аномального поведения.





#### Сходство имен поддонов/контейнеров:

Злоумышленники могут пытаться скрыть свою вредоносную деятельность, называя свои бэкдор-подсистемы так, чтобы они походили на легитимные подсистемы, созданные контроллерами, такими как Deployments или DaemonSets. Смешиваясь с существующими соглашениями об именовании стручков, злоумышленники пытаются избежать подозрений. Организациям следует внедрять строгие соглашения об именовании и проводить регулярный аудит для выявления любых несоответствий или подозрительных имен стручков/контейнеров.





#### Подключение с прокси-сервера


Чтобы скрыть свои IP-адреса, злоумышленники могут использовать прокси-серверы, в том числе анонимные сети типа TOR, для связи с приложениями или сервером API Kubernetes. Организациям следует рассмотреть возможность применения мер сетевой безопасности для мониторинга и ограничения доступа из подозрительных диапазонов IP-адресов или анонимных сетей. Внедрение систем обнаружения и предотвращения вторжений (IDPS) и регулярное проведение анализа угроз может помочь выявить использование прокси-серверов злоумышленниками.








### Доступ к учетным данным


Безопасность учетных данных имеет первостепенное значение в средах Kubernetes. Злоумышленники используют различные методы для кражи учетных данных, включая учетные данные приложений, учетные данные служб, секреты и облачные учетные данные. Защита доступа к учетным данным имеет решающее значение для предотвращения несанкционированного доступа, утечки данных и потенциальной компрометации конфиденциальной информации. В этой статье мы рассмотрим распространенные тактики доступа к учетным данным и обсудим стратегии для усиления защиты личности и снижения рисков, связанных с кражей учетных данных в Kubernetes.





#### Список секретов Kubernetes:


Секреты Kubernetes используются для хранения конфиденциальной информации, такой как пароли и строки подключения, в кластере. Злоумышленники с соответствующими правами могут получить эти секреты с сервера API, что может привести к получению доступа к важным учетным данным. Для защиты секретов организациям следует применять подход "защита в глубину", включающий строгий контроль доступа, шифрование и регулярный аудит конфигураций секретов. Реализация тонких политик RBAC и ограничение доступа к секретам на основе принципа наименьших привилегий помогут снизить риск несанкционированного доступа.





#### Mount service principal:


В облачных развертываниях злоумышленники могут использовать свой доступ к контейнеру в кластере для получения несанкционированного доступа к учетным данным облака. Например, в Azure Kubernetes Service (AKS) каждый узел содержит учетную запись service principal. Для предотвращения несанкционированного доступа к облачным ресурсам организациям следует применять надежные меры безопасности, такие как безопасная конфигурация кластера, строгий контроль доступа и регулярная ротация учетных данных принципалов служб.






#### Учетная запись службы доступа к контейнеру:


Учетные записи сервисов (SA) используются для представления идентификационных данных приложений в Kubernetes. По умолчанию SA устанавливаются на каждую капсулу в кластере, что позволяет контейнерам взаимодействовать с сервером Kubernetes API. Злоумышленники, получившие доступ к стручку, могут извлечь токен SA и потенциально выполнять действия в кластере на основе разрешений SA. Для снижения риска несанкционированного доступа к SA очень важно внедрить RBAC и применить надежные механизмы аутентификации. Регулярные аудиты и мониторинг разрешений SA помогут выявить и устранить любые потенциальные пробелы в безопасности.




#### Учетные данные приложений в файлах конфигурации:


Разработчики часто хранят секреты, такие как учетные данные приложений, в конфигурационных файлах Kubernetes, включая переменные окружения в конфигурации стручков. Злоумышленники могут попытаться получить доступ к этим конфигурационным файлам, чтобы украсть конфиденциальную информацию. Организациям следует поощрять практику безопасного кодирования, например, передавать секреты в безопасное решение для управления секретами, и избегать хранения учетных данных непосредственно в конфигурационных файлах. Внедрение рекомендаций по безопасному кодированию, регулярное обучение разработчиков правилам безопасности и автоматическое сканирование уязвимостей помогут снизить риск несанкционированного доступа к учетным данным приложений.







### Обнаружение

Атаки на обнаружение представляют собой серьезную угрозу для безопасности сред Kubernetes. Злоумышленники используют различные техники для изучения среды, получения информации о ресурсах кластера и бокового перемещения для получения доступа к дополнительным целям. Понимание и смягчение последствий этих тактик обнаружения очень важно для укрепления общей безопасности развертываний Kubernetes. В этой статье мы рассмотрим распространенные методы обнаружения и обсудим стратегии, позволяющие усилить защиту и предотвратить несанкционированное проникновение в Kubernetes.






#### Доступ к серверу Kubernetes API:


Сервер API Kubernetes выступает в качестве шлюза для кластера, обеспечивая взаимодействие и управление ресурсами. Злоумышленники могут попытаться получить доступ к API-серверу, чтобы собрать информацию о контейнерах, секретах и других ресурсах. Защита сервера API имеет первостепенное значение, и организациям следует внедрить надежные механизмы аутентификации, строгие средства контроля доступа и защищенные каналы связи (TLS) для предотвращения несанкционированного доступа и несанкционированного получения конфиденциальных данных.






#### Доступ к API Kubelet:


Kubelet, запущенный на каждом узле, управляет выполнением подсистем и предоставляет API-сервис, доступный только для чтения. Злоумышленники, имеющие сетевой доступ к узлу, могут получить доступ к API Kubelet, чтобы собрать информацию о запущенных подсистемах и самом узле. Чтобы снизить этот риск, организациям следует внедрить сегментацию сети и ограничить сетевой доступ к API Kubelet, используя брандмауэры или сетевые политики для разрешения связи только из доверенных источников.







#### Картирование сети:


Злоумышленники могут попытаться составить карту сети кластера, чтобы получить сведения о работающих приложениях и выявить потенциальные уязвимости. Внедрение сегментации сети, сетевых политик и использование решений для обеспечения сетевой безопасности может помочь ограничить несанкционированное исследование сети в кластере, сократить площадь атаки и минимизировать последствия попыток картирования сети.





#### Доступ к приборной панели Kubernetes:


Приборная панель Kubernetes представляет собой веб-интерфейс для управления и мониторинга кластера. Злоумышленники, получившие доступ к контейнеру в кластере, могут попытаться использовать сетевой доступ контейнера для получения доступа к панели управления. Организациям следует защитить панель управления Kubernetes, внедрив строгую аутентификацию, контроль доступа на основе ролей (RBAC) и политики безопасного сетевого доступа, чтобы предотвратить несанкционированный доступ и утечку информации.




#### API метаданных экземпляра:


Облачные провайдеры предлагают сервисы метаданных экземпляра, которые предоставляют информацию о конфигурации виртуальных машин и сетевых данных. Злоумышленники, скомпрометировавшие контейнер, могут попытаться запросить API метаданных экземпляра, чтобы получить информацию о базовом узле. Защита API метаданных очень важна, и организациям следует внедрить средства контроля безопасности на сетевом уровне, например ограничить доступ к службе метаданных только изнутри виртуальной машины, чтобы предотвратить несанкционированный доступ и ограничить раскрытие конфиденциальной информации.









### Боковое перемещение


Атаки с боковым перемещением представляют собой значительную угрозу в контейнерных средах, позволяя злоумышленникам перемещаться по среде жертвы, получать несанкционированный доступ к различным ресурсам и потенциально повышать привилегии. Понимание и смягчение последствий тактики бокового перемещения очень важно для повышения безопасности развертываний Kubernetes. В этой статье мы рассмотрим распространенные техники, используемые злоумышленниками для бокового перемещения, и обсудим стратегии, позволяющие усилить защиту и минимизировать последствия этих атак в Kubernetes.







#### Доступ к серверу Kubernetes API:


Сервер API Kubernetes выступает в качестве шлюза в кластер, обеспечивая взаимодействие и управление ресурсами. Злоумышленники могут попытаться получить доступ к API-серверу, чтобы собрать информацию о контейнерах, секретах и других ресурсах. Защита сервера API имеет первостепенное значение, поэтому организациям следует внедрить надежные механизмы аутентификации, строгие средства контроля доступа и защищенные каналы связи (TLS) для предотвращения несанкционированного доступа и несанкционированного получения конфиденциальных данных.






#### Доступ к облачным ресурсам:


Злоумышленники, скомпрометировавшие контейнер в кластере, могут попытаться проникнуть в саму облачную среду. Организации должны внедрить строгие средства контроля доступа, использовать принципы наименьших привилегий и регулярно контролировать облачные ресурсы для обнаружения и предотвращения попыток несанкционированного доступа.








#### Учетная запись службы контейнеров:


Злоумышленники, получившие доступ к взломанному контейнеру, могут использовать установленный токен учетной записи сервиса для отправки запросов на сервер Kubernetes API и получения доступа к дополнительным ресурсам в кластере. Защита учетных записей служб контейнеров с помощью RBAC и регулярная ротация учетных данных помогут снизить риск бокового перемещения через скомпрометированные контейнеры.






#### Внутренняя сеть кластера:


По умолчанию Kubernetes обеспечивает связь между стручками внутри кластера. Злоумышленники, получившие доступ к одному контейнеру, могут использовать это сетевое поведение для перемещения по кластеру и захвата дополнительных ресурсов. Внедрение сегментации сети, сетевых политик и регулярного мониторинга сети может ограничить несанкционированное боковое перемещение внутри кластера.





#### Учетные данные приложений в файлах конфигурации:


Разработчики часто хранят конфиденциальные учетные данные в конфигурационных файлах Kubernetes, например, переменные окружения в конфигурациях подов. Злоумышленники, получившие доступ к этим учетным данным, могут использовать их для бокового перемещения и получения доступа к дополнительным ресурсам как внутри, так и вне кластера. Использование безопасных методов управления секретами, таких как шифрование конфигурационных файлов и ограничение доступа к конфиденциальной информации, может снизить риск бокового перемещения на основе учетных данных.






#### Монтирование записываемых томов на хосте:


Злоумышленники могут попытаться использовать монтирование томов с возможностью записи во взломанном контейнере, чтобы получить доступ к базовому хосту. Обеспечение контроля доступа на уровне хоста, надежная изоляция контейнеров, регулярное исправление и укрепление базового хоста помогут снизить риск бокового перемещения из контейнеров на хост.






#### Доступ к панели Kubernetes Dashboard:


Злоумышленники, имеющие доступ к приборной панели Kubernetes, могут манипулировать ресурсами кластера и выполнять код в контейнерах с помощью встроенной функции "exec". Защита приборной панели Kubernetes с помощью строгой аутентификации, контроля доступа и мониторинга подозрительных действий может минимизировать риск несанкционированного бокового перемещения через приборную панель.








#### Доступ к конечной точке Tiller:


Tiller, серверный компонент Helm, может открывать внутренние конечные точки gRPC, не требующие аутентификации. Злоумышленники, получившие доступ к контейнеру, подключенному к службе Tiller, могут использовать эту уязвимость для выполнения несанкционированных действий в кластере. Организациям следует рассмотреть возможность перехода на Helm версии 3, в которой удален компонент Tiller и устранен этот специфический риск.








### Impact


Тактика Impact в Kubernetes относится к методам, используемым злоумышленниками для нарушения, злоупотребления или разрушения нормального поведения среды. Эти атаки могут привести к потере данных, злоупотреблению ресурсами и отказу в обслуживании, что влечет за собой серьезные последствия для организаций. Защита развертываний Kubernetes от таких атак крайне важна для обеспечения доступности, целостности и конфиденциальности ресурсов. В этой статье мы рассмотрим распространенные методы воздействия, используемые злоумышленниками, и обсудим стратегии по смягчению их последствий в средах Kubernetes.








#### Уничтожение данных:



Злоумышленники могут атаковать развертывания Kubernetes, чтобы уничтожить критически важные данные и ресурсы. Это может включать удаление развертываний, конфигураций, томов хранения или вычислительных ресурсов. Чтобы снизить риск уничтожения данных, необходимо внедрить надежные механизмы резервного копирования и аварийного восстановления. Регулярное резервное копирование критически важных данных, проверка целостности резервных копий и использование надлежащих средств контроля доступа помогут свести к минимуму последствия атак на уничтожение данных.







#### Перехват ресурсов:



Скомпрометированные ресурсы в кластере Kubernetes могут быть использованы злоумышленниками для вредоносной деятельности, например для добычи цифровой валюты. Злоумышленники, получившие доступ к контейнерам или имеющие права на создание новых контейнеров, могут использовать эти ресурсы для выполнения несанкционированных задач. Применение строгих политик безопасности, мониторинг использования ресурсов и регулярный аудит контейнеров на предмет несанкционированных действий помогут обнаружить и предотвратить попытки захвата ресурсов.









#### Отказ в обслуживании (DoS):



Злоумышленники могут проводить DoS-атаки, чтобы нарушить доступность сервисов Kubernetes. Это может касаться контейнеров, узлов или сервера API. Чтобы уменьшить последствия DoS-атак, важно применять меры безопасности на уровне сети, такие как фильтрация входящего и исходящего трафика, ограничение скорости и мониторинг трафика. Кроме того, внедрение квот на ресурсы, настройка горизонтального автомасштабирования подсистем и мониторинг использования ресурсов могут помочь в поддержании доступности сервисов и смягчении последствий DoS-атак.





## Матрица облачных угроз

![MITRE ATT&CK Cloud Threat Matrix](../../../assets/images/cloud-matrix.png)

Система MITRE ATT&CK предоставляет обширную базу знаний о тактике и технике противника, используемых в кибератаках. 

### Первоначальный доступ:

#### Фишинг облачного аккаунта

Злоумышленник пытается получить несанкционированный доступ к облачному аккаунту с помощью фишинговых методов.

#### Эксплуатация облачных сервисов 

Злоумышленники используют уязвимости в облачных сервисах для получения первоначального доступа.

### Execution

#### Удаленное выполнение

Злоумышленники удаленно выполняют код или команды на облачной системе.

#### Выполнение пользователем

Злоумышленники обманом заставляют пользователя выполнить вредоносный код или команды на облачной системе.


### Стойкость

#### Постоянство через облачный ресурс 

Доступ: Злоумышленники устанавливают постоянство, сохраняя доступ к облачным ресурсам или учетным записям.

#### Устойчивость через облачный сервис.

Злоумышленники используют облачные сервисы или функции для установления постоянства в среде.


### Повышение привилегий

#### Доступ к разрешениям облачных сервисов

Злоумышленники повышают свои привилегии, манипулируя разрешениями облачных сервисов.

#### Побег из контейнера

Злоумышленники избегают контейнеризации, чтобы получить более высокие привилегии в облачной среде.


### Уклонение от защиты

#### Очистка облачных журналов

Злоумышленники пытаются удалить или манипулировать журналами в облачной среде, чтобы избежать обнаружения.

#### Модифицировать облачный след

Злоумышленники изменяют или подделывают журналы облачных следов, чтобы скрыть свою деятельность.


### Доступ к учетным данным

#### Кража учетных данных облачного сервиса 

Злоумышленники крадут учетные данные облачных сервисов, чтобы получить несанкционированный доступ.

#### Перехват учетных данных облачных сервисов

Злоумышленники получают учетные данные облачных сервисов различными способами.


### Обнаружение

#### Обнаружение облачных сервисов

Злоумышленники обнаруживают облачные сервисы и ресурсы, чтобы собрать информацию о среде.

#### Обнаружение контейнеров 

Злоумышленники обнаруживают и исследуют контейнеры в облачной среде.


### Латеральное перемещение

#### Латеральное перемещение в облачной инфраструктуре

Злоумышленники перемещаются между облачными ресурсами и учетными записями.

#### Латеральное перемещение между контейнерами

Злоумышленники перемещаются между контейнерами в облачной среде.

### Коллекция

#### Данные из облачного хранилища

Злоумышленники собирают и передают данные из облачных хранилищ.

#### Данные из контейнера

Злоумышленники собирают и распространяют данные из контейнеров в облачной среде.

### Эксфильтрация:

#### Эксфильтрация через облачный канал.

Злоумышленники осуществляют эксфильтрацию данных через облачные каналы связи.

#### Эксфильтрация через другие сетевые среды

Злоумышленники осуществляют эксфильтрацию данных с помощью других сетевых сред в облачной среде.




## Охота на угрозу


## Shodan

Поисковая система для подключенных к Интернету устройств, позволяющая выявлять потенциальные поверхности атак и уязвимости в вашей сети.	


```
shodan scan submit --filename scan.json "port:22"
```

## VirusTotal

Платформа для анализа угроз, позволяющая анализировать файлы и URL-адреса на предмет потенциальных угроз и вредоносного ПО.	

```
curl --request POST --url 'https://www.virustotal.com/api/v3/urls' --header 'x-apikey: YOUR_API_KEY' --header 'content-type: application/json' --data '{"url": "https://example.com"}''
```

## ThreatConnect

Платформа для анализа угроз, которая позволяет собирать, анализировать и делиться информацией об угрозах с вашей командой и сообществом.	

```
curl -H "Content-Type: application/json" -X POST -d '{"name": "Example Threat Intel", "description": "Это пример отчета о разведке угроз".}' https://api.threatconnect.com/api/v2/intelligence
```

## MISP

Платформа для анализа угроз с открытым исходным кодом, позволяющая собирать, хранить и делиться данными об угрозах со своей командой и сообществом.	

```
curl -X POST 'http://misp.local/events/restSearch' -H 'Авторизация: YOUR_API_KEY' -H 'Content-Type: application/json' -d '{"returnFormat": "json", "eventid": [1,2,3], "enforceWarninglist":0 }''
```


## ChatGPT

### Generate Yara Rule

- [ ] Укажите цель правила YARA. Для этого примера создадим правило для обнаружения определенного типа вредоносного ПО на основе его поведения.

Запрос: "Пожалуйста, дайте краткое описание поведения вредоносного ПО, которое вы хотите обнаружить".


- [ ] Определите индикаторы вредоносного ПО, например имена файлов, строки или шаблоны, характерные для него. Эта информация будет использована в правиле YARA.



Вопрос: "Какие специфические индикаторы или шаблоны связаны с вредоносным ПО?"



- [ ] Запустите правило YARA, определив метаданные, такие как имя правила, описание и автор. Добавьте эту информацию в файл rule.yar.



Спросите: "Укажите имя правила, описание и автора для правила YARA".



- [ ] Определите условие или логику, которая будет запускать правило при обнаружении совпадения. Используйте индикаторы, определенные на шаге 2, и синтаксис YARA для задания условия.



Подсказка: "Пожалуйста, укажите условие для правила YARA, используя индикаторы и синтаксис YARA".



- [ ] По желанию добавьте к правилу YARA теги, чтобы предоставить дополнительную информацию или классификацию. Теги можно использовать для группировки связанных правил.

Подсказка: "Если применимо, добавьте к правилу YARA любые соответствующие теги".




- [ ] Проверьте правило YARA на примере файлов или известных вредоносных программ, чтобы убедиться, что оно обнаруживает нужное поведение.

Подсказка: "Пожалуйста, протестируйте правило YARA на образцах файлов или известных вредоносных программах, чтобы убедиться в его эффективности".



- [ ] Доработайте правило YARA, основываясь на результатах тестирования, и повторите шаги, необходимые для повышения точности и охвата.



Подсказка: "Основываясь на результатах тестирования, нужно ли вам доработать или итерировать правило YARA?"





### Анализ кода


- [ ] Получите образец вредоносного ПО, который вы хотите проанализировать. Это может быть файл, сценарий или любая другая форма вредоносного кода.

Спросите: "Пожалуйста, укажите образец вредоносного ПО, который вы хотите проанализировать".



- [ ] Создайте безопасную и изолированную среду для анализа образца вредоносного ПО. Это может быть виртуальная машина, "песочница" или контейнер.



Спросите: "Как вы хотите настроить безопасную среду? (например, виртуальная машина, песочница)".




- [ ] Установите необходимые инструменты для анализа вредоносного ПО. Обычно это дизассемблеры, отладчики и средства анализа кода.



Задание: "Пожалуйста, перечислите инструменты, которые вы хотели бы установить для анализа кода вредоносного ПО".




- [ ] Извлечение вредоносной программы из ее контейнера или упаковки и проверка ее компонентов, таких как исполняемые файлы, сценарии или файлы конфигурации.



Спросите: "Пожалуйста, извлеките образец вредоносной программы и дайте краткий обзор ее компонентов".




- [ ] Используйте дизассемблер или декомпилятор для анализа кода вредоносной программы и преобразования его в более удобный для анализа формат.



Задание: "Какой дизассемблер или декомпилятор вы хотите использовать для анализа?"




- [ ] Изучите код вредоносной программы, чтобы определить ее поведение, функции и потенциальные уязвимости. Найдите любые методы обфускации или меры защиты от анализа, используемые вредоносным ПО.



Задание: "Какие именно аспекты кода вредоносной программы вы хотели бы проанализировать? (например, поведение, уязвимости)".





- [ ] При необходимости настройте отладчик, чтобы отследить выполнение вредоносной программы и понять ее поведение во время выполнения. Этот шаг может потребовать углубленных знаний и специализированных инструментов.





Спросите: "Хотите ли вы отладить и отследить выполнение вредоносной программы? Если да, укажите инструмент отладчика".






- [ ] Задокументируйте результаты анализа кода вредоносного ПО, включая выявленные модели поведения, потенциальные риски и любую другую важную информацию. Сформируйте отчет с кратким изложением результатов анализа.





Подсказка: "Пожалуйста, задокументируйте свои выводы и создайте отчет с кратким описанием анализа кода вредоносного ПО".





- [ ] На основе анализа разработайте и примените меры по снижению уровня безопасности для защиты от векторов атак вредоносного ПО. Это может включать исправление уязвимостей, обновление мер безопасности или внедрение специальных элементов управления.

Задание: "Какие меры по снижению уровня безопасности вы бы порекомендовали на основе проведенного анализа?"








### Generate Script




- [ ] Получите образец вредоносного кода, который вы хотите проанализировать. Это может быть файл, сценарий или любая другая форма вредоносного кода.

Спросите: "Пожалуйста, укажите образец вредоносного ПО, который вы хотите проанализировать".





- [ ] Извлеките вредоносную программу из контейнера или упаковки и проверьте ее компоненты, такие как исполняемые файлы, сценарии или файлы конфигурации.



Спросите: "Пожалуйста, извлеките образец вредоносного ПО и дайте краткий обзор его компонентов".




- [ ] Изучите код вредоносной программы, чтобы определить ее поведение, функции и потенциальные уязвимости. Найдите любые методы обфускации или меры защиты от анализа, используемые вредоносным ПО.

Задание: "Какие именно аспекты кода вредоносной программы вы хотели бы проанализировать? (например, поведение, уязвимости)".



- [ ] При необходимости настройте отладчик, чтобы отследить выполнение вредоносной программы и понять ее поведение во время выполнения. Этот шаг может потребовать углубленных знаний и специализированных инструментов.

Спросите: "Хотите ли вы отладить и отследить выполнение вредоносной программы? Если да, укажите инструмент отладчика".




- [ ] Задокументируйте результаты анализа кода вредоносного ПО, включая выявленные модели поведения, потенциальные риски и любую другую важную информацию. Сформируйте отчет с кратким изложением результатов анализа.

Подсказка: "Пожалуйста, задокументируйте свои выводы и создайте отчет с кратким описанием анализа кода вредоносного ПО".



- [ ] На основе анализа разработайте и примените меры по снижению уровня безопасности для защиты от векторов атак вредоносного ПО. Это может включать исправление уязвимостей, обновление мер безопасности или внедрение специальных элементов управления.

Задание: "Какие меры по снижению безопасности вы бы рекомендовали на основе проведенного анализа?"






### Анализ журналов


- [ ] Предварительно обработайте файлы журналов, чтобы извлечь из них необходимую информацию и сделать их более читабельными. Используйте такие инструменты, как awk, sed или grep, чтобы отфильтровать и отформатировать данные журнала. Например:


```
$ awk '{print $4, $7}' access.log > formatted_logs.txt
```


- [ ] Начните с изучения данных журнала, чтобы понять его структуру и содержание. Используйте такие команды, как head, tail или cat, чтобы просмотреть файлы журнала. Например:


```
$ head formatted_logs.txt
```

Спросите: "Пожалуйста, дайте краткий обзор структуры и формата данных журнала".




- [ ] Проведите статистический анализ данных журнала, чтобы получить информацию. Используйте такие инструменты, как grep, sort или uniq, чтобы извлечь полезную информацию. Например:


```
$ grep '404' formatted_logs.txt | wc -l
```

Подсказка: "Можете ли вы предоставить количество ошибок HTTP 404 в журнале?"



- [ ] Применяйте методы сопоставления шаблонов для выявления определенных событий или аномалий. Используйте такие команды, как grep или регулярные выражения для поиска шаблонов. Например:


```
$ grep -E '(\b\d{3}\b){4}' formatted_logs.txt
```

Подсказка: "Пожалуйста, определите IP-адреса в данных журнала".



- [ ] Выполните анализ на основе времени, чтобы выявить тенденции или подозрительные действия. Используйте такие команды, как awk или date, для работы с временными метками. Например:


```
$ awk '{print $4, $7}' access.log > formatted_logs.txt
```

Спросите: "Можете ли вы предоставить распределение событий журнала в зависимости от времени суток?"





- [ ] Участвуйте в интерактивном расследовании, задавая вопросы или запрашивая конкретную информацию. Используйте такие подсказки, как:


* "Можете ли вы выявить в журнале неудачные попытки входа в систему?"
* "Укажите 10 наиболее часто используемых URL-адресов в журнале".
* "Есть ли пользователи-агенты, связанные с подозрительными действиями?"



- [ ] Создайте визуализацию для представления результатов. Используйте такие инструменты, как matplotlib, gnuplot, или онлайн-платформы для визуализации. Например:


```
import matplotlib.pyplot as plt

# Код для создания гистограммы или линейного графика на основе результатов лог-анализа
```

Подсказка: "Можете ли вы создать гистограмму, показывающую распределение событий журнала по времени?"





## Databases

* https://otx.alienvault.com/
* https://exchange.xforce.ibmcloud.com/
* https://github.com/certtools/intelmq-feeds-documentation
* https://sca.analysiscenter.veracode.com/vulnerability-database/search#
* https://vulmon.com
* https://github.com/advisories


## Playbook

* https://gitlab.com/syntax-ir/playbooks


## Log

* https://github.com/logpai/loghub/tree/master


## References

* https://socradar.io






